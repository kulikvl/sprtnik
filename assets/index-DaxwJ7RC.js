(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();class se{static downloadBlob(e,t){const n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=t,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}static stringToColor(e){let t=0;for(let o=0;o<e.length;o++)t=e.charCodeAt(o)+((t<<5)-t);const n=(t&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-n.length)+n}static getSnippet(e,t=20){if(!e?.blocks?.length)return"No content";for(const n of e.blocks)if(n.type==="paragraph"&&n.data?.text){const o=n.data.text.replace(/<[^>]+>/g,"");return o.slice(0,t)+(o.length>t?"…":"")}return"No paragraph found"}static findElementByIdOrFail(e){const t=document.getElementById(e);if(!t)throw new Error(`Element with ID "${e}" not found`);return t}}class bt{container;props;constructor(e,t){this.container=e,this.props=t}}(function(){try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode(".ce-hint--align-start{text-align:left}.ce-hint--align-center{text-align:center}.ce-hint__description{opacity:.6;margin-top:3px}")),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();var It=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function sa(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var o=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return r[n]}})}),t}function An(){}Object.assign(An,{default:An,register:An,revert:function(){},__esModule:!0});Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(r){const e=(this.document||this.ownerDocument).querySelectorAll(r);let t=e.length;for(;--t>=0&&e.item(t)!==this;);return t>-1});Element.prototype.closest||(Element.prototype.closest=function(r){let e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(r))return e;e=e.parentElement||e.parentNode}while(e!==null);return null});Element.prototype.prepend||(Element.prototype.prepend=function(r){const e=document.createDocumentFragment();Array.isArray(r)||(r=[r]),r.forEach(t=>{const n=t instanceof Node;e.appendChild(n?t:document.createTextNode(t))}),this.insertBefore(e,this.firstChild)});Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(r){r=arguments.length===0?!0:!!r;const e=this.parentNode,t=window.getComputedStyle(e,null),n=parseInt(t.getPropertyValue("border-top-width")),o=parseInt(t.getPropertyValue("border-left-width")),i=this.offsetTop-e.offsetTop<e.scrollTop,s=this.offsetTop-e.offsetTop+this.clientHeight-n>e.scrollTop+e.clientHeight,a=this.offsetLeft-e.offsetLeft<e.scrollLeft,l=this.offsetLeft-e.offsetLeft+this.clientWidth-o>e.scrollLeft+e.clientWidth,c=i&&!s;(i||s)&&r&&(e.scrollTop=this.offsetTop-e.offsetTop-e.clientHeight/2-n+this.clientHeight/2),(a||l)&&r&&(e.scrollLeft=this.offsetLeft-e.offsetLeft-e.clientWidth/2-o+this.clientWidth/2),(i||s||a||l)&&!r&&this.scrollIntoView(c)});window.requestIdleCallback=window.requestIdleCallback||function(r){const e=Date.now();return setTimeout(function(){r({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback||function(r){clearTimeout(r)};let aa=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var di=(r=>(r.VERBOSE="VERBOSE",r.INFO="INFO",r.WARN="WARN",r.ERROR="ERROR",r))(di||{});const re={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46},la={LEFT:0};function Lt(r,e,t="log",n,o="color: inherit"){if(!("console"in window)||!window.console[t])return;const i=["info","log","warn","error"].includes(t),s=[];switch(Lt.logLevel){case"ERROR":if(t!=="error")return;break;case"WARN":if(!["error","warn"].includes(t))return;break;case"INFO":if(!i||r)return;break}n&&s.push(n);const a="Editor.js 2.31.0-rc.7";r&&(i?(s.unshift(`line-height: 1em;
            color: #006FEA;
            display: inline-block;
            font-size: 11px;
            line-height: 1em;
            background-color: #fff;
            padding: 4px 9px;
            border-radius: 30px;
            border: 1px solid rgba(56, 138, 229, 0.16);
            margin: 4px 5px 4px 0;`,o),e=`%c${a}%c ${e}`):e=`( ${a} )${e}`);try{i?n?console[t](`${e} %o`,...s):console[t](e,...s):console[t](e)}catch{}}Lt.logLevel="VERBOSE";function ca(r){Lt.logLevel=r}const ce=Lt.bind(window,!1),Ie=Lt.bind(window,!0);function nt(r){return Object.prototype.toString.call(r).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function pe(r){return nt(r)==="function"||nt(r)==="asyncfunction"}function we(r){return nt(r)==="object"}function Ze(r){return nt(r)==="string"}function da(r){return nt(r)==="boolean"}function Uo(r){return nt(r)==="number"}function Wo(r){return nt(r)==="undefined"}function Ae(r){return r?Object.keys(r).length===0&&r.constructor===Object:!0}function ui(r){return r>47&&r<58||r===32||r===13||r===229||r>64&&r<91||r>95&&r<112||r>185&&r<193||r>218&&r<223}async function ua(r,e=()=>{},t=()=>{}){async function n(o,i,s){try{await o.function(o.data),await i(Wo(o.data)?{}:o.data)}catch{s(Wo(o.data)?{}:o.data)}}return r.reduce(async(o,i)=>(await o,n(i,e,t)),Promise.resolve())}function hi(r){return Array.prototype.slice.call(r)}function Qt(r,e){return function(){const t=this,n=arguments;window.setTimeout(()=>r.apply(t,n),e)}}function ha(r){return r.name.split(".").pop()}function pa(r){return/^[-\w]+\/([-+\w]+|\*)$/.test(r)}function qo(r,e,t){let n;return(...o)=>{const i=this,s=()=>{n=null,r.apply(i,o)};window.clearTimeout(n),n=window.setTimeout(s,e)}}function Wn(r,e,t=void 0){let n,o,i,s=null,a=0;t||(t={});const l=function(){a=t.leading===!1?0:Date.now(),s=null,i=r.apply(n,o),s||(n=o=null)};return function(){const c=Date.now();!a&&t.leading===!1&&(a=c);const f=e-(c-a);return n=this,o=arguments,f<=0||f>e?(s&&(clearTimeout(s),s=null),a=c,i=r.apply(n,o),s||(n=o=null)):!s&&t.trailing!==!1&&(s=setTimeout(l,f)),i}}function fa(){const r={win:!1,mac:!1,x11:!1,linux:!1},e=Object.keys(r).find(t=>window.navigator.appVersion.toLowerCase().indexOf(t)!==-1);return e&&(r[e]=!0),r}function en(r){return r[0].toUpperCase()+r.slice(1)}function qn(r,...e){if(!e.length)return r;const t=e.shift();if(we(r)&&we(t))for(const n in t)we(t[n])?(r[n]||Object.assign(r,{[n]:{}}),qn(r[n],t[n])):Object.assign(r,{[n]:t[n]});return qn(r,...e)}function tr(r){const e=fa();return r=r.replace(/shift/gi,"⇧").replace(/backspace/gi,"⌫").replace(/enter/gi,"⏎").replace(/up/gi,"↑").replace(/left/gi,"→").replace(/down/gi,"↓").replace(/right/gi,"←").replace(/escape/gi,"⎋").replace(/insert/gi,"Ins").replace(/delete/gi,"␡").replace(/\+/gi," + "),e.mac?r=r.replace(/ctrl|cmd/gi,"⌘").replace(/alt/gi,"⌥"):r=r.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN"),r}function ga(r){try{return new URL(r).href}catch{}return r.substring(0,2)==="//"?window.location.protocol+r:window.location.origin+r}function ma(){return aa(10)}function ba(r){window.open(r,"_blank")}function va(r=""){return`${r}${Math.floor(Math.random()*1e8).toString(16)}`}function Zn(r,e,t){const n=`«${e}» is deprecated and will be removed in the next major release. Please use the «${t}» instead.`;r&&Ie(n,"warn")}function vt(r,e,t){const n=t.value?"value":"get",o=t[n],i=`#${e}Cache`;if(t[n]=function(...s){return this[i]===void 0&&(this[i]=o.apply(this,...s)),this[i]},n==="get"&&t.set){const s=t.set;t.set=function(a){delete r[i],s.apply(this,a)}}return t}const pi=650;function yt(){return window.matchMedia(`(max-width: ${pi}px)`).matches}const Kn=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);function ya(r,e){const t=Array.isArray(r)||we(r),n=Array.isArray(e)||we(e);return t||n?JSON.stringify(r)===JSON.stringify(e):r===e}class F{static isSingleTag(e){return e.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(e.tagName)}static isLineBreakTag(e){return e&&e.tagName&&["BR","WBR"].includes(e.tagName)}static make(e,t=null,n={}){const o=document.createElement(e);if(Array.isArray(t)){const i=t.filter(s=>s!==void 0);o.classList.add(...i)}else t&&o.classList.add(t);for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i]);return o}static text(e){return document.createTextNode(e)}static append(e,t){Array.isArray(t)?t.forEach(n=>e.appendChild(n)):e.appendChild(t)}static prepend(e,t){Array.isArray(t)?(t=t.reverse(),t.forEach(n=>e.prepend(n))):e.prepend(t)}static swap(e,t){const n=document.createElement("div"),o=e.parentNode;o.insertBefore(n,e),o.insertBefore(e,t),o.insertBefore(t,n),o.removeChild(n)}static find(e=document,t){return e.querySelector(t)}static get(e){return document.getElementById(e)}static findAll(e=document,t){return e.querySelectorAll(t)}static get allInputsSelector(){return"[contenteditable=true], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map(e=>`input[type="${e}"]`).join(", ")}static findAllInputs(e){return hi(e.querySelectorAll(F.allInputsSelector)).reduce((t,n)=>F.isNativeInput(n)||F.containsOnlyInlineElements(n)?[...t,n]:[...t,...F.getDeepestBlockElements(n)],[])}static getDeepestNode(e,t=!1){const n=t?"lastChild":"firstChild",o=t?"previousSibling":"nextSibling";if(e&&e.nodeType===Node.ELEMENT_NODE&&e[n]){let i=e[n];if(F.isSingleTag(i)&&!F.isNativeInput(i)&&!F.isLineBreakTag(i))if(i[o])i=i[o];else if(i.parentNode[o])i=i.parentNode[o];else return i.parentNode;return this.getDeepestNode(i,t)}return e}static isElement(e){return Uo(e)?!1:e&&e.nodeType&&e.nodeType===Node.ELEMENT_NODE}static isFragment(e){return Uo(e)?!1:e&&e.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}static isContentEditable(e){return e.contentEditable==="true"}static isNativeInput(e){const t=["INPUT","TEXTAREA"];return e&&e.tagName?t.includes(e.tagName):!1}static canSetCaret(e){let t=!0;if(F.isNativeInput(e))switch(e.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":t=!1;break}else t=F.isContentEditable(e);return t}static isNodeEmpty(e,t){let n;return this.isSingleTag(e)&&!this.isLineBreakTag(e)?!1:(this.isElement(e)&&this.isNativeInput(e)?n=e.value:n=e.textContent.replace("​",""),t&&(n=n.replace(new RegExp(t,"g"),"")),n.length===0)}static isLeaf(e){return e?e.childNodes.length===0:!1}static isEmpty(e,t){const n=[e];for(;n.length>0;)if(e=n.shift(),!!e){if(this.isLeaf(e)&&!this.isNodeEmpty(e,t))return!1;e.childNodes&&n.push(...Array.from(e.childNodes))}return!0}static isHTMLString(e){const t=F.make("div");return t.innerHTML=e,t.childElementCount>0}static getContentLength(e){return F.isNativeInput(e)?e.value.length:e.nodeType===Node.TEXT_NODE?e.length:e.textContent.length}static get blockElements(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tbody","thead","tr","tfoot","ul","video"]}static containsOnlyInlineElements(e){let t;Ze(e)?(t=document.createElement("div"),t.innerHTML=e):t=e;const n=o=>!F.blockElements.includes(o.tagName.toLowerCase())&&Array.from(o.children).every(n);return Array.from(t.children).every(n)}static getDeepestBlockElements(e){return F.containsOnlyInlineElements(e)?[e]:Array.from(e.children).reduce((t,n)=>[...t,...F.getDeepestBlockElements(n)],[])}static getHolder(e){return Ze(e)?document.getElementById(e):e}static isAnchor(e){return e.tagName.toLowerCase()==="a"}static offset(e){const t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop,i=t.top+o,s=t.left+n;return{top:i,left:s,bottom:i+t.height,right:s+t.width}}}function ka(r){return!/[^\t\n\r ]/.test(r)}function wa(r){const e=window.getComputedStyle(r),t=parseFloat(e.fontSize),n=parseFloat(e.lineHeight)||t*1.2,o=parseFloat(e.paddingTop),i=parseFloat(e.borderTopWidth),s=parseFloat(e.marginTop),a=t*.8,l=(n-t)/2;return s+i+o+l+a}function fi(r){r.dataset.empty=F.isEmpty(r)?"true":"false"}const xa={blockTunes:{toggler:{"Click to tune":"","or drag to move":""}},inlineToolbar:{converter:{"Convert to":""}},toolbar:{toolbox:{Add:""}},popover:{Filter:"","Nothing found":"","Convert to":""}},Ea={Text:"",Link:"",Bold:"",Italic:""},_a={link:{"Add a link":""},stub:{"The block can not be displayed correctly.":""}},Ca={delete:{Delete:"","Click to delete":""},moveUp:{"Move up":""},moveDown:{"Move down":""}},gi={ui:xa,toolNames:Ea,tools:_a,blockTunes:Ca},mi=class ut{static ui(e,t){return ut._t(e,t)}static t(e,t){return ut._t(e,t)}static setDictionary(e){ut.currentDictionary=e}static _t(e,t){const n=ut.getNamespace(e);return!n||!n[t]?t:n[t]}static getNamespace(e){return e.split(".").reduce((t,n)=>!t||!Object.keys(t).length?{}:t[n],ut.currentDictionary)}};mi.currentDictionary=gi;let Ce=mi;class bi extends Error{}let Pt=class{constructor(){this.subscribers={}}on(e,t){e in this.subscribers||(this.subscribers[e]=[]),this.subscribers[e].push(t)}once(e,t){e in this.subscribers||(this.subscribers[e]=[]);const n=o=>{const i=t(o),s=this.subscribers[e].indexOf(n);return s!==-1&&this.subscribers[e].splice(s,1),i};this.subscribers[e].push(n)}emit(e,t){Ae(this.subscribers)||!this.subscribers[e]||this.subscribers[e].reduce((n,o)=>{const i=o(n);return i!==void 0?i:n},t)}off(e,t){if(this.subscribers[e]===void 0){console.warn(`EventDispatcher .off(): there is no subscribers for event "${e.toString()}". Probably, .off() called before .on()`);return}for(let n=0;n<this.subscribers[e].length;n++)if(this.subscribers[e][n]===t){delete this.subscribers[e][n];break}}destroy(){this.subscribers={}}};function Ue(r){Object.setPrototypeOf(this,{get id(){return r.id},get name(){return r.name},get config(){return r.config},get holder(){return r.holder},get isEmpty(){return r.isEmpty},get selected(){return r.selected},set stretched(e){r.stretched=e},get stretched(){return r.stretched},get focusable(){return r.focusable},call(e,t){return r.call(e,t)},save(){return r.save()},validate(e){return r.validate(e)},dispatchChange(){r.dispatchChange()},getActiveToolboxEntry(){return r.getActiveToolboxEntry()}})}let Nt=class{constructor(){this.allListeners=[]}on(e,t,n,o=!1){const i=va("l"),s={id:i,element:e,eventType:t,handler:n,options:o};if(!this.findOne(e,t,n))return this.allListeners.push(s),e.addEventListener(t,n,o),i}off(e,t,n,o){const i=this.findAll(e,t,n);i.forEach((s,a)=>{const l=this.allListeners.indexOf(i[a]);l>-1&&(this.allListeners.splice(l,1),s.element.removeEventListener(s.eventType,s.handler,s.options))})}offById(e){const t=this.findById(e);t&&t.element.removeEventListener(t.eventType,t.handler,t.options)}findOne(e,t,n){const o=this.findAll(e,t,n);return o.length>0?o[0]:null}findAll(e,t,n){let o;const i=e?this.findByEventTarget(e):[];return e&&t&&n?o=i.filter(s=>s.eventType===t&&s.handler===n):e&&t?o=i.filter(s=>s.eventType===t):o=i,o}removeAll(){this.allListeners.map(e=>{e.element.removeEventListener(e.eventType,e.handler,e.options)}),this.allListeners=[]}destroy(){this.removeAll()}findByEventTarget(e){return this.allListeners.filter(t=>{if(t.element===e)return t})}findByType(e){return this.allListeners.filter(t=>{if(t.eventType===e)return t})}findByHandler(e){return this.allListeners.filter(t=>{if(t.handler===e)return t})}findById(e){return this.allListeners.find(t=>t.id===e)}},ae=class vi{constructor({config:e,eventsDispatcher:t}){if(this.nodes={},this.listeners=new Nt,this.readOnlyMutableListeners={on:(n,o,i,s=!1)=>{this.mutableListenerIds.push(this.listeners.on(n,o,i,s))},clearAll:()=>{for(const n of this.mutableListenerIds)this.listeners.offById(n);this.mutableListenerIds=[]}},this.mutableListenerIds=[],new.target===vi)throw new TypeError("Constructors for abstract class Module are not allowed.");this.config=e,this.eventsDispatcher=t}set state(e){this.Editor=e}removeAllNodes(){for(const e in this.nodes){const t=this.nodes[e];t instanceof HTMLElement&&t.remove()}}get isRtl(){return this.config.i18n.direction==="rtl"}},te=class Ke{constructor(){this.instance=null,this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}static get CSS(){return{editorWrapper:"codex-editor",editorZone:"codex-editor__redactor"}}static get anchorNode(){const e=window.getSelection();return e?e.anchorNode:null}static get anchorElement(){const e=window.getSelection();if(!e)return null;const t=e.anchorNode;return t?F.isElement(t)?t:t.parentElement:null}static get anchorOffset(){const e=window.getSelection();return e?e.anchorOffset:null}static get isCollapsed(){const e=window.getSelection();return e?e.isCollapsed:null}static get isAtEditor(){return this.isSelectionAtEditor(Ke.get())}static isSelectionAtEditor(e){if(!e)return!1;let t=e.anchorNode||e.focusNode;t&&t.nodeType===Node.TEXT_NODE&&(t=t.parentNode);let n=null;return t&&t instanceof Element&&(n=t.closest(`.${Ke.CSS.editorZone}`)),n?n.nodeType===Node.ELEMENT_NODE:!1}static isRangeAtEditor(e){if(!e)return;let t=e.startContainer;t&&t.nodeType===Node.TEXT_NODE&&(t=t.parentNode);let n=null;return t&&t instanceof Element&&(n=t.closest(`.${Ke.CSS.editorZone}`)),n?n.nodeType===Node.ELEMENT_NODE:!1}static get isSelectionExists(){return!!Ke.get().anchorNode}static get range(){return this.getRangeFromSelection(this.get())}static getRangeFromSelection(e){return e&&e.rangeCount?e.getRangeAt(0):null}static get rect(){let e=document.selection,t,n={x:0,y:0,width:0,height:0};if(e&&e.type!=="Control")return e=e,t=e.createRange(),n.x=t.boundingLeft,n.y=t.boundingTop,n.width=t.boundingWidth,n.height=t.boundingHeight,n;if(!window.getSelection)return ce("Method window.getSelection is not supported","warn"),n;if(e=window.getSelection(),e.rangeCount===null||isNaN(e.rangeCount))return ce("Method SelectionUtils.rangeCount is not supported","warn"),n;if(e.rangeCount===0)return n;if(t=e.getRangeAt(0).cloneRange(),t.getBoundingClientRect&&(n=t.getBoundingClientRect()),n.x===0&&n.y===0){const o=document.createElement("span");if(o.getBoundingClientRect){o.appendChild(document.createTextNode("​")),t.insertNode(o),n=o.getBoundingClientRect();const i=o.parentNode;i.removeChild(o),i.normalize()}}return n}static get text(){return window.getSelection?window.getSelection().toString():""}static get(){return window.getSelection()}static setCursor(e,t=0){const n=document.createRange(),o=window.getSelection();return F.isNativeInput(e)?F.canSetCaret(e)?(e.focus(),e.selectionStart=e.selectionEnd=t,e.getBoundingClientRect()):void 0:(n.setStart(e,t),n.setEnd(e,t),o.removeAllRanges(),o.addRange(n),n.getBoundingClientRect())}static isRangeInsideContainer(e){const t=Ke.range;return t===null?!1:e.contains(t.startContainer)}static addFakeCursor(){const e=Ke.range;if(e===null)return;const t=F.make("span","codex-editor__fake-cursor");t.dataset.mutationFree="true",e.collapse(),e.insertNode(t)}static isFakeCursorInsideContainer(e){return F.find(e,".codex-editor__fake-cursor")!==null}static removeFakeCursor(e=document.body){const t=F.find(e,".codex-editor__fake-cursor");t&&t.remove()}removeFakeBackground(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}setFakeBackground(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}save(){this.savedSelectionRange=Ke.range}restore(){if(!this.savedSelectionRange)return;const e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedSelectionRange)}clearSaved(){this.savedSelectionRange=null}collapseToEnd(){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(e.focusNode),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}findParentTag(e,t,n=10){const o=window.getSelection();let i=null;return!o||!o.anchorNode||!o.focusNode?null:([o.anchorNode,o.focusNode].forEach(s=>{let a=n;for(;a>0&&s.parentNode&&!(s.tagName===e&&(i=s,t&&s.classList&&!s.classList.contains(t)&&(i=null),i));)s=s.parentNode,a--}),i)}expandToTag(e){const t=window.getSelection();t.removeAllRanges();const n=document.createRange();n.selectNodeContents(e),t.addRange(n)}};function Sa(r,e){const{type:t,target:n,addedNodes:o,removedNodes:i}=r;return r.type==="attributes"&&r.attributeName==="data-empty"?!1:!!(e.contains(n)||t==="childList"&&(Array.from(o).some(s=>s===e)||Array.from(i).some(s=>s===e)))}const Yn="redactor dom changed",yi="block changed",ki="fake cursor is about to be toggled",wi="fake cursor have been set",At="editor mobile layout toggled";function Vn(r,e){if(!r.conversionConfig)return!1;const t=r.conversionConfig[e];return pe(t)||Ze(t)}function tn(r,e){return Vn(r.tool,e)}function xi(r,e){return Object.entries(r).some(([t,n])=>e[t]&&ya(e[t],n))}async function Ei(r,e){const t=(await r.save()).data,n=e.find(o=>o.name===r.name);return n!==void 0&&!Vn(n,"export")?[]:e.reduce((o,i)=>{if(!Vn(i,"import")||i.toolbox===void 0)return o;const s=i.toolbox.filter(a=>{if(Ae(a)||a.icon===void 0)return!1;if(a.data!==void 0){if(xi(a.data,t))return!1}else if(i.name===r.name)return!1;return!0});return o.push({...i,toolbox:s}),o},[])}function Zo(r,e){return r.mergeable?r.name===e.name?!0:tn(e,"export")&&tn(r,"import"):!1}function Ta(r,e){const t=e?.export;return pe(t)?t(r):Ze(t)?r[t]:(t!==void 0&&ce("Conversion «export» property must be a string or function. String means key of saved data object to export. Function should export processed string to export."),"")}function Ko(r,e,t){const n=e?.import;return pe(n)?n(r,t):Ze(n)?{[n]:r}:(n!==void 0&&ce("Conversion «import» property must be a string or function. String means key of tool data to import. Function accepts a imported string and return composed tool data."),{})}var he=(r=>(r.Default="default",r.Separator="separator",r.Html="html",r))(he||{}),We=(r=>(r.APPEND_CALLBACK="appendCallback",r.RENDERED="rendered",r.MOVED="moved",r.UPDATED="updated",r.REMOVED="removed",r.ON_PASTE="onPaste",r))(We||{});let qe=class Ye extends Pt{constructor({id:e=ma(),data:t,tool:n,readOnly:o,tunesData:i},s){super(),this.cachedInputs=[],this.toolRenderedElement=null,this.tunesInstances=new Map,this.defaultTunesInstances=new Map,this.unavailableTunesData={},this.inputIndex=0,this.editorEventBus=null,this.handleFocus=()=>{this.dropInputsCache(),this.updateCurrentInput()},this.didMutated=(a=void 0)=>{const l=a===void 0,c=a instanceof InputEvent;!l&&!c&&this.detectToolRootChange(a);let f;l||c?f=!0:f=!(a.length>0&&a.every(h=>{const{addedNodes:y,removedNodes:p,target:v}=h;return[...Array.from(y),...Array.from(p),v].some(d=>(F.isElement(d)||(d=d.parentElement),d&&d.closest('[data-mutation-free="true"]')!==null))})),f&&(this.dropInputsCache(),this.updateCurrentInput(),this.toggleInputsEmptyMark(),this.call("updated"),this.emit("didMutated",this))},this.name=n.name,this.id=e,this.settings=n.settings,this.config=n.settings.config||{},this.editorEventBus=s||null,this.blockAPI=new Ue(this),this.tool=n,this.toolInstance=n.create(t,this.blockAPI,o),this.tunes=n.tunes,this.composeTunes(i),this.holder=this.compose(),window.requestIdleCallback(()=>{this.watchBlockMutations(),this.addInputEvents(),this.toggleInputsEmptyMark()})}static get CSS(){return{wrapper:"ce-block",wrapperStretched:"ce-block--stretched",content:"ce-block__content",selected:"ce-block--selected",dropTarget:"ce-block--drop-target"}}get inputs(){if(this.cachedInputs.length!==0)return this.cachedInputs;const e=F.findAllInputs(this.holder);return this.inputIndex>e.length-1&&(this.inputIndex=e.length-1),this.cachedInputs=e,e}get currentInput(){return this.inputs[this.inputIndex]}set currentInput(e){const t=this.inputs.findIndex(n=>n===e||n.contains(e));t!==-1&&(this.inputIndex=t)}get firstInput(){return this.inputs[0]}get lastInput(){const e=this.inputs;return e[e.length-1]}get nextInput(){return this.inputs[this.inputIndex+1]}get previousInput(){return this.inputs[this.inputIndex-1]}get data(){return this.save().then(e=>e&&!Ae(e.data)?e.data:{})}get sanitize(){return this.tool.sanitizeConfig}get mergeable(){return pe(this.toolInstance.merge)}get focusable(){return this.inputs.length!==0}get isEmpty(){const e=F.isEmpty(this.pluginsContent,"/"),t=!this.hasMedia;return e&&t}get hasMedia(){const e=["img","iframe","video","audio","source","input","textarea","twitterwidget"];return!!this.holder.querySelector(e.join(","))}set selected(e){var t,n;this.holder.classList.toggle(Ye.CSS.selected,e);const o=e===!0&&te.isRangeInsideContainer(this.holder),i=e===!1&&te.isFakeCursorInsideContainer(this.holder);(o||i)&&((t=this.editorEventBus)==null||t.emit(ki,{state:e}),o?te.addFakeCursor():te.removeFakeCursor(this.holder),(n=this.editorEventBus)==null||n.emit(wi,{state:e}))}get selected(){return this.holder.classList.contains(Ye.CSS.selected)}set stretched(e){this.holder.classList.toggle(Ye.CSS.wrapperStretched,e)}get stretched(){return this.holder.classList.contains(Ye.CSS.wrapperStretched)}set dropTarget(e){this.holder.classList.toggle(Ye.CSS.dropTarget,e)}get pluginsContent(){return this.toolRenderedElement}call(e,t){if(pe(this.toolInstance[e])){e==="appendCallback"&&ce("`appendCallback` hook is deprecated and will be removed in the next major release. Use `rendered` hook instead","warn");try{this.toolInstance[e].call(this.toolInstance,t)}catch(n){ce(`Error during '${e}' call: ${n.message}`,"error")}}}async mergeWith(e){await this.toolInstance.merge(e)}async save(){const e=await this.toolInstance.save(this.pluginsContent),t=this.unavailableTunesData;[...this.tunesInstances.entries(),...this.defaultTunesInstances.entries()].forEach(([i,s])=>{if(pe(s.save))try{t[i]=s.save()}catch(a){ce(`Tune ${s.constructor.name} save method throws an Error %o`,"warn",a)}});const n=window.performance.now();let o;return Promise.resolve(e).then(i=>(o=window.performance.now(),{id:this.id,tool:this.name,data:i,tunes:t,time:o-n})).catch(i=>{ce(`Saving process for ${this.name} tool failed due to the ${i}`,"log","red")})}async validate(e){let t=!0;return this.toolInstance.validate instanceof Function&&(t=await this.toolInstance.validate(e)),t}getTunes(){const e=[],t=[],n=typeof this.toolInstance.renderSettings=="function"?this.toolInstance.renderSettings():[];return F.isElement(n)?e.push({type:he.Html,element:n}):Array.isArray(n)?e.push(...n):e.push(n),[...this.tunesInstances.values(),...this.defaultTunesInstances.values()].map(o=>o.render()).forEach(o=>{F.isElement(o)?t.push({type:he.Html,element:o}):Array.isArray(o)?t.push(...o):t.push(o)}),{toolTunes:e,commonTunes:t}}updateCurrentInput(){this.currentInput=F.isNativeInput(document.activeElement)||!te.anchorNode?document.activeElement:te.anchorNode}dispatchChange(){this.didMutated()}destroy(){this.unwatchBlockMutations(),this.removeInputEvents(),super.destroy(),pe(this.toolInstance.destroy)&&this.toolInstance.destroy()}async getActiveToolboxEntry(){const e=this.tool.toolbox;if(e.length===1)return Promise.resolve(this.tool.toolbox[0]);const t=await this.data,n=e;return n?.find(o=>xi(o.data,t))}async exportDataAsString(){const e=await this.data;return Ta(e,this.tool.conversionConfig)}compose(){const e=F.make("div",Ye.CSS.wrapper),t=F.make("div",Ye.CSS.content),n=this.toolInstance.render();e.setAttribute("data-cy","block-wrapper"),e.dataset.id=this.id,this.toolRenderedElement=n,t.appendChild(this.toolRenderedElement);let o=t;return[...this.tunesInstances.values(),...this.defaultTunesInstances.values()].forEach(i=>{if(pe(i.wrap))try{o=i.wrap(o)}catch(s){ce(`Tune ${i.constructor.name} wrap method throws an Error %o`,"warn",s)}}),e.appendChild(o),e}composeTunes(e){Array.from(this.tunes.values()).forEach(t=>{(t.isInternal?this.defaultTunesInstances:this.tunesInstances).set(t.name,t.create(e[t.name],this.blockAPI))}),Object.entries(e).forEach(([t,n])=>{this.tunesInstances.has(t)||(this.unavailableTunesData[t]=n)})}addInputEvents(){this.inputs.forEach(e=>{e.addEventListener("focus",this.handleFocus),F.isNativeInput(e)&&e.addEventListener("input",this.didMutated)})}removeInputEvents(){this.inputs.forEach(e=>{e.removeEventListener("focus",this.handleFocus),F.isNativeInput(e)&&e.removeEventListener("input",this.didMutated)})}watchBlockMutations(){var e;this.redactorDomChangedCallback=t=>{const{mutations:n}=t;n.some(o=>Sa(o,this.toolRenderedElement))&&this.didMutated(n)},(e=this.editorEventBus)==null||e.on(Yn,this.redactorDomChangedCallback)}unwatchBlockMutations(){var e;(e=this.editorEventBus)==null||e.off(Yn,this.redactorDomChangedCallback)}detectToolRootChange(e){e.forEach(t=>{if(Array.from(t.removedNodes).includes(this.toolRenderedElement)){const n=t.addedNodes[t.addedNodes.length-1];this.toolRenderedElement=n}})}dropInputsCache(){this.cachedInputs=[]}toggleInputsEmptyMark(){this.inputs.forEach(fi)}};class Ba extends ae{constructor(){super(...arguments),this.insert=(e=this.config.defaultBlock,t={},n={},o,i,s,a)=>{const l=this.Editor.BlockManager.insert({id:a,tool:e,data:t,index:o,needToFocus:i,replace:s});return new Ue(l)},this.composeBlockData=async e=>{const t=this.Editor.Tools.blockTools.get(e);return new qe({tool:t,api:this.Editor.API,readOnly:!0,data:{},tunesData:{}}).data},this.update=async(e,t,n)=>{const{BlockManager:o}=this.Editor,i=o.getBlockById(e);if(i===void 0)throw new Error(`Block with id "${e}" not found`);const s=await o.update(i,t,n);return new Ue(s)},this.convert=async(e,t,n)=>{var o,i;const{BlockManager:s,Tools:a}=this.Editor,l=s.getBlockById(e);if(!l)throw new Error(`Block with id "${e}" not found`);const c=a.blockTools.get(l.name),f=a.blockTools.get(t);if(!f)throw new Error(`Block Tool with type "${t}" not found`);const h=((o=c?.conversionConfig)==null?void 0:o.export)!==void 0,y=((i=f.conversionConfig)==null?void 0:i.import)!==void 0;if(h&&y){const p=await s.convert(l,t,n);return new Ue(p)}else{const p=[h?!1:en(l.name),y?!1:en(t)].filter(Boolean).join(" and ");throw new Error(`Conversion from "${l.name}" to "${t}" is not possible. ${p} tool(s) should provide a "conversionConfig"`)}},this.insertMany=(e,t=this.Editor.BlockManager.blocks.length-1)=>{this.validateIndex(t);const n=e.map(({id:o,type:i,data:s})=>this.Editor.BlockManager.composeBlock({id:o,tool:i||this.config.defaultBlock,data:s}));return this.Editor.BlockManager.insertMany(n,t),n.map(o=>new Ue(o))}}get methods(){return{clear:()=>this.clear(),render:e=>this.render(e),renderFromHTML:e=>this.renderFromHTML(e),delete:e=>this.delete(e),swap:(e,t)=>this.swap(e,t),move:(e,t)=>this.move(e,t),getBlockByIndex:e=>this.getBlockByIndex(e),getById:e=>this.getById(e),getCurrentBlockIndex:()=>this.getCurrentBlockIndex(),getBlockIndex:e=>this.getBlockIndex(e),getBlocksCount:()=>this.getBlocksCount(),getBlockByElement:e=>this.getBlockByElement(e),stretchBlock:(e,t=!0)=>this.stretchBlock(e,t),insertNewBlock:()=>this.insertNewBlock(),insert:this.insert,insertMany:this.insertMany,update:this.update,composeBlockData:this.composeBlockData,convert:this.convert}}getBlocksCount(){return this.Editor.BlockManager.blocks.length}getCurrentBlockIndex(){return this.Editor.BlockManager.currentBlockIndex}getBlockIndex(e){const t=this.Editor.BlockManager.getBlockById(e);if(!t){Ie("There is no block with id `"+e+"`","warn");return}return this.Editor.BlockManager.getBlockIndex(t)}getBlockByIndex(e){const t=this.Editor.BlockManager.getBlockByIndex(e);if(t===void 0){Ie("There is no block at index `"+e+"`","warn");return}return new Ue(t)}getById(e){const t=this.Editor.BlockManager.getBlockById(e);return t===void 0?(Ie("There is no block with id `"+e+"`","warn"),null):new Ue(t)}getBlockByElement(e){const t=this.Editor.BlockManager.getBlock(e);if(t===void 0){Ie("There is no block corresponding to element `"+e+"`","warn");return}return new Ue(t)}swap(e,t){ce("`blocks.swap()` method is deprecated and will be removed in the next major release. Use `block.move()` method instead","info"),this.Editor.BlockManager.swap(e,t)}move(e,t){this.Editor.BlockManager.move(e,t)}delete(e=this.Editor.BlockManager.currentBlockIndex){try{const t=this.Editor.BlockManager.getBlockByIndex(e);this.Editor.BlockManager.removeBlock(t)}catch(t){Ie(t,"warn");return}this.Editor.BlockManager.blocks.length===0&&this.Editor.BlockManager.insert(),this.Editor.BlockManager.currentBlock&&this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END),this.Editor.Toolbar.close()}async clear(){await this.Editor.BlockManager.clear(!0),this.Editor.InlineToolbar.close()}async render(e){if(e===void 0||e.blocks===void 0)throw new Error("Incorrect data passed to the render() method");this.Editor.ModificationsObserver.disable(),await this.Editor.BlockManager.clear(),await this.Editor.Renderer.render(e.blocks),this.Editor.ModificationsObserver.enable()}renderFromHTML(e){return this.Editor.BlockManager.clear(),this.Editor.Paste.processText(e,!0)}stretchBlock(e,t=!0){Zn(!0,"blocks.stretchBlock()","BlockAPI");const n=this.Editor.BlockManager.getBlockByIndex(e);n&&(n.stretched=t)}insertNewBlock(){ce("Method blocks.insertNewBlock() is deprecated and it will be removed in the next major release. Use blocks.insert() instead.","warn"),this.insert()}validateIndex(e){if(typeof e!="number")throw new Error("Index should be a number");if(e<0)throw new Error("Index should be greater than or equal to 0");if(e===null)throw new Error("Index should be greater than or equal to 0")}}function Oa(r,e){return typeof r=="number"?e.BlockManager.getBlockByIndex(r):typeof r=="string"?e.BlockManager.getBlockById(r):e.BlockManager.getBlockById(r.id)}class Ia extends ae{constructor(){super(...arguments),this.setToFirstBlock=(e=this.Editor.Caret.positions.DEFAULT,t=0)=>this.Editor.BlockManager.firstBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.firstBlock,e,t),!0):!1,this.setToLastBlock=(e=this.Editor.Caret.positions.DEFAULT,t=0)=>this.Editor.BlockManager.lastBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.lastBlock,e,t),!0):!1,this.setToPreviousBlock=(e=this.Editor.Caret.positions.DEFAULT,t=0)=>this.Editor.BlockManager.previousBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.previousBlock,e,t),!0):!1,this.setToNextBlock=(e=this.Editor.Caret.positions.DEFAULT,t=0)=>this.Editor.BlockManager.nextBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.nextBlock,e,t),!0):!1,this.setToBlock=(e,t=this.Editor.Caret.positions.DEFAULT,n=0)=>{const o=Oa(e,this.Editor);return o===void 0?!1:(this.Editor.Caret.setToBlock(o,t,n),!0)},this.focus=(e=!1)=>e?this.setToLastBlock(this.Editor.Caret.positions.END):this.setToFirstBlock(this.Editor.Caret.positions.START)}get methods(){return{setToFirstBlock:this.setToFirstBlock,setToLastBlock:this.setToLastBlock,setToPreviousBlock:this.setToPreviousBlock,setToNextBlock:this.setToNextBlock,setToBlock:this.setToBlock,focus:this.focus}}}class Aa extends ae{get methods(){return{emit:(e,t)=>this.emit(e,t),off:(e,t)=>this.off(e,t),on:(e,t)=>this.on(e,t)}}on(e,t){this.eventsDispatcher.on(e,t)}emit(e,t){this.eventsDispatcher.emit(e,t)}off(e,t){this.eventsDispatcher.off(e,t)}}let Ma=class _i extends ae{static getNamespace(e,t){return t?`blockTunes.${e}`:`tools.${e}`}get methods(){return{t:()=>{Ie("I18n.t() method can be accessed only from Tools","warn")}}}getMethodsForTool(e,t){return Object.assign(this.methods,{t:n=>Ce.t(_i.getNamespace(e,t),n)})}};class La extends ae{get methods(){return{blocks:this.Editor.BlocksAPI.methods,caret:this.Editor.CaretAPI.methods,tools:this.Editor.ToolsAPI.methods,events:this.Editor.EventsAPI.methods,listeners:this.Editor.ListenersAPI.methods,notifier:this.Editor.NotifierAPI.methods,sanitizer:this.Editor.SanitizerAPI.methods,saver:this.Editor.SaverAPI.methods,selection:this.Editor.SelectionAPI.methods,styles:this.Editor.StylesAPI.classes,toolbar:this.Editor.ToolbarAPI.methods,inlineToolbar:this.Editor.InlineToolbarAPI.methods,tooltip:this.Editor.TooltipAPI.methods,i18n:this.Editor.I18nAPI.methods,readOnly:this.Editor.ReadOnlyAPI.methods,ui:this.Editor.UiAPI.methods}}getMethodsForTool(e,t){return Object.assign(this.methods,{i18n:this.Editor.I18nAPI.getMethodsForTool(e,t)})}}class Pa extends ae{get methods(){return{close:()=>this.close(),open:()=>this.open()}}open(){this.Editor.InlineToolbar.tryToShow()}close(){this.Editor.InlineToolbar.close()}}class Na extends ae{get methods(){return{on:(e,t,n,o)=>this.on(e,t,n,o),off:(e,t,n,o)=>this.off(e,t,n,o),offById:e=>this.offById(e)}}on(e,t,n,o){return this.listeners.on(e,t,n,o)}off(e,t,n,o){this.listeners.off(e,t,n,o)}offById(e){this.listeners.offById(e)}}var Ci={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(window,function(){return function(t){var n={};function o(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=t,o.c=n,o.d=function(i,s,a){o.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:a})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,s){if(1&s&&(i=o(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var l in i)o.d(a,l,function(c){return i[c]}.bind(null,l));return a},o.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(s,"a",s),s},o.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},o.p="/",o(o.s=0)}([function(t,n,o){o(1),t.exports=function(){var i=o(6),s="cdx-notify--bounce-in",a=null;return{show:function(l){if(l.message){(function(){if(a)return!0;a=i.getWrapper(),document.body.appendChild(a)})();var c=null,f=l.time||8e3;switch(l.type){case"confirm":c=i.confirm(l);break;case"prompt":c=i.prompt(l);break;default:c=i.alert(l),window.setTimeout(function(){c.remove()},f)}a.appendChild(c),c.classList.add(s)}}}}()},function(t,n,o){var i=o(2);typeof i=="string"&&(i=[[t.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};o(4)(i,s),i.locals&&(t.exports=i.locals)},function(t,n,o){(t.exports=o(3)(!1)).push([t.i,`.cdx-notify--error{background:#fffbfb!important}.cdx-notify--error::before{background:#fb5d5d!important}.cdx-notify__input{max-width:130px;padding:5px 10px;background:#f7f7f7;border:0;border-radius:3px;font-size:13px;color:#656b7c;outline:0}.cdx-notify__input:-ms-input-placeholder{color:#656b7c}.cdx-notify__input::placeholder{color:#656b7c}.cdx-notify__input:focus:-ms-input-placeholder{color:rgba(101,107,124,.3)}.cdx-notify__input:focus::placeholder{color:rgba(101,107,124,.3)}.cdx-notify__button{border:none;border-radius:3px;font-size:13px;padding:5px 10px;cursor:pointer}.cdx-notify__button:last-child{margin-left:10px}.cdx-notify__button--cancel{background:#f2f5f7;box-shadow:0 2px 1px 0 rgba(16,19,29,0);color:#656b7c}.cdx-notify__button--cancel:hover{background:#eee}.cdx-notify__button--confirm{background:#34c992;box-shadow:0 1px 1px 0 rgba(18,49,35,.05);color:#fff}.cdx-notify__button--confirm:hover{background:#33b082}.cdx-notify__btns-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin-top:5px}.cdx-notify__cross{position:absolute;top:5px;right:5px;width:10px;height:10px;padding:5px;opacity:.54;cursor:pointer}.cdx-notify__cross::after,.cdx-notify__cross::before{content:'';position:absolute;left:9px;top:5px;height:12px;width:2px;background:#575d67}.cdx-notify__cross::before{transform:rotate(-45deg)}.cdx-notify__cross::after{transform:rotate(45deg)}.cdx-notify__cross:hover{opacity:1}.cdx-notifies{position:fixed;z-index:2;bottom:20px;left:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.cdx-notify{position:relative;width:220px;margin-top:15px;padding:13px 16px;background:#fff;box-shadow:0 11px 17px 0 rgba(23,32,61,.13);border-radius:5px;font-size:14px;line-height:1.4em;word-wrap:break-word}.cdx-notify::before{content:'';position:absolute;display:block;top:0;left:0;width:3px;height:calc(100% - 6px);margin:3px;border-radius:5px;background:0 0}@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.05)}70%{transform:scale(.9)}100%{transform:scale(1)}}.cdx-notify--bounce-in{animation-name:bounceIn;animation-duration:.6s;animation-iteration-count:1}.cdx-notify--success{background:#fafffe!important}.cdx-notify--success::before{background:#41ffb1!important}`,""])},function(t,n){t.exports=function(o){var i=[];return i.toString=function(){return this.map(function(s){var a=function(l,c){var f=l[1]||"",h=l[3];if(!h)return f;if(c&&typeof btoa=="function"){var y=(v=h,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(v))))+" */"),p=h.sources.map(function(d){return"/*# sourceURL="+h.sourceRoot+d+" */"});return[f].concat(p).concat([y]).join(`
`)}var v;return[f].join(`
`)}(s,o);return s[2]?"@media "+s[2]+"{"+a+"}":a}).join("")},i.i=function(s,a){typeof s=="string"&&(s=[[null,s,""]]);for(var l={},c=0;c<this.length;c++){var f=this[c][0];typeof f=="number"&&(l[f]=!0)}for(c=0;c<s.length;c++){var h=s[c];typeof h[0]=="number"&&l[h[0]]||(a&&!h[2]?h[2]=a:a&&(h[2]="("+h[2]+") and ("+a+")"),i.push(h))}},i}},function(t,n,o){var i,s,a={},l=(i=function(){return window&&document&&document.all&&!window.atob},function(){return s===void 0&&(s=i.apply(this,arguments)),s}),c=function(O){var T={};return function(j){if(typeof j=="function")return j();if(T[j]===void 0){var Z=function(_){return document.querySelector(_)}.call(this,j);if(window.HTMLIFrameElement&&Z instanceof window.HTMLIFrameElement)try{Z=Z.contentDocument.head}catch{Z=null}T[j]=Z}return T[j]}}(),f=null,h=0,y=[],p=o(5);function v(O,T){for(var j=0;j<O.length;j++){var Z=O[j],_=a[Z.id];if(_){_.refs++;for(var A=0;A<_.parts.length;A++)_.parts[A](Z.parts[A]);for(;A<Z.parts.length;A++)_.parts.push(S(Z.parts[A],T))}else{var g=[];for(A=0;A<Z.parts.length;A++)g.push(S(Z.parts[A],T));a[Z.id]={id:Z.id,refs:1,parts:g}}}}function d(O,T){for(var j=[],Z={},_=0;_<O.length;_++){var A=O[_],g=T.base?A[0]+T.base:A[0],P={css:A[1],media:A[2],sourceMap:A[3]};Z[g]?Z[g].parts.push(P):j.push(Z[g]={id:g,parts:[P]})}return j}function m(O,T){var j=c(O.insertInto);if(!j)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var Z=y[y.length-1];if(O.insertAt==="top")Z?Z.nextSibling?j.insertBefore(T,Z.nextSibling):j.appendChild(T):j.insertBefore(T,j.firstChild),y.push(T);else if(O.insertAt==="bottom")j.appendChild(T);else{if(typeof O.insertAt!="object"||!O.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var _=c(O.insertInto+" "+O.insertAt.before);j.insertBefore(T,_)}}function b(O){if(O.parentNode===null)return!1;O.parentNode.removeChild(O);var T=y.indexOf(O);T>=0&&y.splice(T,1)}function k(O){var T=document.createElement("style");return O.attrs.type===void 0&&(O.attrs.type="text/css"),E(T,O.attrs),m(O,T),T}function E(O,T){Object.keys(T).forEach(function(j){O.setAttribute(j,T[j])})}function S(O,T){var j,Z,_,A;if(T.transform&&O.css){if(!(A=T.transform(O.css)))return function(){};O.css=A}if(T.singleton){var g=h++;j=f||(f=k(T)),Z=N.bind(null,j,g,!1),_=N.bind(null,j,g,!0)}else O.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(j=function(P){var X=document.createElement("link");return P.attrs.type===void 0&&(P.attrs.type="text/css"),P.attrs.rel="stylesheet",E(X,P.attrs),m(P,X),X}(T),Z=function(P,X,U){var ne=U.css,W=U.sourceMap,ee=X.convertToAbsoluteUrls===void 0&&W;(X.convertToAbsoluteUrls||ee)&&(ne=p(ne)),W&&(ne+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(W))))+" */");var R=new Blob([ne],{type:"text/css"}),M=P.href;P.href=URL.createObjectURL(R),M&&URL.revokeObjectURL(M)}.bind(null,j,T),_=function(){b(j),j.href&&URL.revokeObjectURL(j.href)}):(j=k(T),Z=function(P,X){var U=X.css,ne=X.media;if(ne&&P.setAttribute("media",ne),P.styleSheet)P.styleSheet.cssText=U;else{for(;P.firstChild;)P.removeChild(P.firstChild);P.appendChild(document.createTextNode(U))}}.bind(null,j),_=function(){b(j)});return Z(O),function(P){if(P){if(P.css===O.css&&P.media===O.media&&P.sourceMap===O.sourceMap)return;Z(O=P)}else _()}}t.exports=function(O,T){if(typeof DEBUG<"u"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(T=T||{}).attrs=typeof T.attrs=="object"?T.attrs:{},T.singleton||typeof T.singleton=="boolean"||(T.singleton=l()),T.insertInto||(T.insertInto="head"),T.insertAt||(T.insertAt="bottom");var j=d(O,T);return v(j,T),function(Z){for(var _=[],A=0;A<j.length;A++){var g=j[A];(P=a[g.id]).refs--,_.push(P)}for(Z&&v(d(Z,T),T),A=0;A<_.length;A++){var P;if((P=_[A]).refs===0){for(var X=0;X<P.parts.length;X++)P.parts[X]();delete a[P.id]}}}};var C,L=(C=[],function(O,T){return C[O]=T,C.filter(Boolean).join(`
`)});function N(O,T,j,Z){var _=j?"":Z.css;if(O.styleSheet)O.styleSheet.cssText=L(T,_);else{var A=document.createTextNode(_),g=O.childNodes;g[T]&&O.removeChild(g[T]),g.length?O.insertBefore(A,g[T]):O.appendChild(A)}}},function(t,n){t.exports=function(o){var i=typeof window<"u"&&window.location;if(!i)throw new Error("fixUrls requires window.location");if(!o||typeof o!="string")return o;var s=i.protocol+"//"+i.host,a=s+i.pathname.replace(/\/[^\/]*$/,"/");return o.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(l,c){var f,h=c.trim().replace(/^"(.*)"$/,function(y,p){return p}).replace(/^'(.*)'$/,function(y,p){return p});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(h)?l:(f=h.indexOf("//")===0?h:h.indexOf("/")===0?s+h:a+h.replace(/^\.\//,""),"url("+JSON.stringify(f)+")")})}},function(t,n,o){var i,s,a,l,c,f,h,y,p;t.exports=(i="cdx-notifies",s="cdx-notify",a="cdx-notify__cross",l="cdx-notify__button--confirm",c="cdx-notify__button--cancel",f="cdx-notify__input",h="cdx-notify__button",y="cdx-notify__btns-wrapper",{alert:p=function(v){var d=document.createElement("DIV"),m=document.createElement("DIV"),b=v.message,k=v.style;return d.classList.add(s),k&&d.classList.add(s+"--"+k),d.innerHTML=b,m.classList.add(a),m.addEventListener("click",d.remove.bind(d)),d.appendChild(m),d},confirm:function(v){var d=p(v),m=document.createElement("div"),b=document.createElement("button"),k=document.createElement("button"),E=d.querySelector("."+a),S=v.cancelHandler,C=v.okHandler;return m.classList.add(y),b.innerHTML=v.okText||"Confirm",k.innerHTML=v.cancelText||"Cancel",b.classList.add(h),k.classList.add(h),b.classList.add(l),k.classList.add(c),S&&typeof S=="function"&&(k.addEventListener("click",S),E.addEventListener("click",S)),C&&typeof C=="function"&&b.addEventListener("click",C),b.addEventListener("click",d.remove.bind(d)),k.addEventListener("click",d.remove.bind(d)),m.appendChild(b),m.appendChild(k),d.appendChild(m),d},prompt:function(v){var d=p(v),m=document.createElement("div"),b=document.createElement("button"),k=document.createElement("input"),E=d.querySelector("."+a),S=v.cancelHandler,C=v.okHandler;return m.classList.add(y),b.innerHTML=v.okText||"Ok",b.classList.add(h),b.classList.add(l),k.classList.add(f),v.placeholder&&k.setAttribute("placeholder",v.placeholder),v.default&&(k.value=v.default),v.inputType&&(k.type=v.inputType),S&&typeof S=="function"&&E.addEventListener("click",S),C&&typeof C=="function"&&b.addEventListener("click",function(){C(k.value)}),b.addEventListener("click",d.remove.bind(d)),m.appendChild(k),m.appendChild(b),d.appendChild(m),d},getWrapper:function(){var v=document.createElement("DIV");return v.classList.add(i),v}})}])})})(Ci);var Ra=Ci.exports;const Da=pn(Ra);class ja{show(e){Da.show(e)}}class Fa extends ae{constructor({config:e,eventsDispatcher:t}){super({config:e,eventsDispatcher:t}),this.notifier=new ja}get methods(){return{show:e=>this.show(e)}}show(e){return this.notifier.show(e)}}class za extends ae{get methods(){const e=()=>this.isEnabled;return{toggle:t=>this.toggle(t),get isEnabled(){return e()}}}toggle(e){return this.Editor.ReadOnly.toggle(e)}get isEnabled(){return this.Editor.ReadOnly.isEnabled}}var Si={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(It,function(){function t(h){var y=h.tags,p=Object.keys(y),v=p.map(function(d){return typeof y[d]}).every(function(d){return d==="object"||d==="boolean"||d==="function"});if(!v)throw new Error("The configuration was invalid");this.config=h}var n=["P","LI","TD","TH","DIV","H1","H2","H3","H4","H5","H6","PRE"];function o(h){return n.indexOf(h.nodeName)!==-1}var i=["A","B","STRONG","I","EM","SUB","SUP","U","STRIKE"];function s(h){return i.indexOf(h.nodeName)!==-1}t.prototype.clean=function(h){const y=document.implementation.createHTMLDocument(),p=y.createElement("div");return p.innerHTML=h,this._sanitize(y,p),p.innerHTML},t.prototype._sanitize=function(h,y){var p=a(h,y),v=p.firstChild();if(v)do{if(v.nodeType===Node.TEXT_NODE)if(v.data.trim()===""&&(v.previousElementSibling&&o(v.previousElementSibling)||v.nextElementSibling&&o(v.nextElementSibling))){y.removeChild(v),this._sanitize(h,y);break}else continue;if(v.nodeType===Node.COMMENT_NODE){y.removeChild(v),this._sanitize(h,y);break}var d=s(v),m;d&&(m=Array.prototype.some.call(v.childNodes,o));var b=!!y.parentNode,k=o(y)&&o(v)&&b,E=v.nodeName.toLowerCase(),S=l(this.config,E,v),C=d&&m;if(C||c(v,S)||!this.config.keepNestedBlockElements&&k){if(!(v.nodeName==="SCRIPT"||v.nodeName==="STYLE"))for(;v.childNodes.length>0;)y.insertBefore(v.childNodes[0],v);y.removeChild(v),this._sanitize(h,y);break}for(var L=0;L<v.attributes.length;L+=1){var N=v.attributes[L];f(N,S,v)&&(v.removeAttribute(N.name),L=L-1)}this._sanitize(h,v)}while(v=p.nextSibling())};function a(h,y){return h.createTreeWalker(y,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null,!1)}function l(h,y,p){return typeof h.tags[y]=="function"?h.tags[y](p):h.tags[y]}function c(h,y){return typeof y>"u"?!0:typeof y=="boolean"?!y:!1}function f(h,y,p){var v=h.name.toLowerCase();return y===!0?!1:typeof y[v]=="function"?!y[v](h.value,p):typeof y[v]>"u"||y[v]===!1?!0:typeof y[v]=="string"?y[v]!==h.value:!1}return t})})(Si);var Ha=Si.exports;const $a=pn(Ha);function nr(r,e){return r.map(t=>{const n=pe(e)?e(t.tool):e;return Ae(n)||(t.data=rr(t.data,n)),t})}function Fe(r,e={}){const t={tags:e};return new $a(t).clean(r)}function rr(r,e){return Array.isArray(r)?Ua(r,e):we(r)?Wa(r,e):Ze(r)?qa(r,e):r}function Ua(r,e){return r.map(t=>rr(t,e))}function Wa(r,e){const t={};for(const n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;const o=r[n],i=Za(e[n])?e[n]:e;t[n]=rr(o,i)}return t}function qa(r,e){return we(e)?Fe(r,e):e===!1?Fe(r,{}):r}function Za(r){return we(r)||da(r)||pe(r)}class Ka extends ae{get methods(){return{clean:(e,t)=>this.clean(e,t)}}clean(e,t){return Fe(e,t)}}class Ya extends ae{get methods(){return{save:()=>this.save()}}save(){const e="Editor's content can not be saved in read-only mode";return this.Editor.ReadOnly.isEnabled?(Ie(e,"warn"),Promise.reject(new Error(e))):this.Editor.Saver.save()}}class Va extends ae{constructor(){super(...arguments),this.selectionUtils=new te}get methods(){return{findParentTag:(e,t)=>this.findParentTag(e,t),expandToTag:e=>this.expandToTag(e),save:()=>this.selectionUtils.save(),restore:()=>this.selectionUtils.restore(),setFakeBackground:()=>this.selectionUtils.setFakeBackground(),removeFakeBackground:()=>this.selectionUtils.removeFakeBackground()}}findParentTag(e,t){return this.selectionUtils.findParentTag(e,t)}expandToTag(e){this.selectionUtils.expandToTag(e)}}class Ga extends ae{get methods(){return{getBlockTools:()=>Array.from(this.Editor.Tools.blockTools.values())}}}class Xa extends ae{get classes(){return{block:"cdx-block",inlineToolButton:"ce-inline-tool",inlineToolButtonActive:"ce-inline-tool--active",input:"cdx-input",loader:"cdx-loader",button:"cdx-button",settingsButton:"cdx-settings-button",settingsButtonActive:"cdx-settings-button--active"}}}class Ja extends ae{get methods(){return{close:()=>this.close(),open:()=>this.open(),toggleBlockSettings:e=>this.toggleBlockSettings(e),toggleToolbox:e=>this.toggleToolbox(e)}}open(){this.Editor.Toolbar.moveAndOpen()}close(){this.Editor.Toolbar.close()}toggleBlockSettings(e){if(this.Editor.BlockManager.currentBlockIndex===-1){Ie("Could't toggle the Toolbar because there is no block selected ","warn");return}e??!this.Editor.BlockSettings.opened?(this.Editor.Toolbar.moveAndOpen(),this.Editor.BlockSettings.open()):this.Editor.BlockSettings.close()}toggleToolbox(e){if(this.Editor.BlockManager.currentBlockIndex===-1){Ie("Could't toggle the Toolbox because there is no block selected ","warn");return}e??!this.Editor.Toolbar.toolbox.opened?(this.Editor.Toolbar.moveAndOpen(),this.Editor.Toolbar.toolbox.open()):this.Editor.Toolbar.toolbox.close()}}var Ti={exports:{}};/*!
 * CodeX.Tooltips
 * 
 * @version 1.0.5
 * 
 * @licence MIT
 * @author CodeX <https://codex.so>
 * 
 * 
 */(function(r,e){(function(t,n){r.exports=n()})(window,function(){return function(t){var n={};function o(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=t,o.c=n,o.d=function(i,s,a){o.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:a})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,s){if(1&s&&(i=o(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var l in i)o.d(a,l,function(c){return i[c]}.bind(null,l));return a},o.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(s,"a",s),s},o.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},o.p="",o(o.s=0)}([function(t,n,o){t.exports=o(1)},function(t,n,o){o.r(n),o.d(n,"default",function(){return i});class i{constructor(){this.nodes={wrapper:null,content:null},this.showed=!1,this.offsetTop=10,this.offsetLeft=10,this.offsetRight=10,this.hidingDelay=0,this.handleWindowScroll=()=>{this.showed&&this.hide(!0)},this.loadStyles(),this.prepare(),window.addEventListener("scroll",this.handleWindowScroll,{passive:!0})}get CSS(){return{tooltip:"ct",tooltipContent:"ct__content",tooltipShown:"ct--shown",placement:{left:"ct--left",bottom:"ct--bottom",right:"ct--right",top:"ct--top"}}}show(a,l,c){this.nodes.wrapper||this.prepare(),this.hidingTimeout&&clearTimeout(this.hidingTimeout);const f=Object.assign({placement:"bottom",marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,delay:70,hidingDelay:0},c);if(f.hidingDelay&&(this.hidingDelay=f.hidingDelay),this.nodes.content.innerHTML="",typeof l=="string")this.nodes.content.appendChild(document.createTextNode(l));else{if(!(l instanceof Node))throw Error("[CodeX Tooltip] Wrong type of «content» passed. It should be an instance of Node or String. But "+typeof l+" given.");this.nodes.content.appendChild(l)}switch(this.nodes.wrapper.classList.remove(...Object.values(this.CSS.placement)),f.placement){case"top":this.placeTop(a,f);break;case"left":this.placeLeft(a,f);break;case"right":this.placeRight(a,f);break;case"bottom":default:this.placeBottom(a,f)}f&&f.delay?this.showingTimeout=setTimeout(()=>{this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0},f.delay):(this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0)}hide(a=!1){if(this.hidingDelay&&!a)return this.hidingTimeout&&clearTimeout(this.hidingTimeout),void(this.hidingTimeout=setTimeout(()=>{this.hide(!0)},this.hidingDelay));this.nodes.wrapper.classList.remove(this.CSS.tooltipShown),this.showed=!1,this.showingTimeout&&clearTimeout(this.showingTimeout)}onHover(a,l,c){a.addEventListener("mouseenter",()=>{this.show(a,l,c)}),a.addEventListener("mouseleave",()=>{this.hide()})}destroy(){this.nodes.wrapper.remove(),window.removeEventListener("scroll",this.handleWindowScroll)}prepare(){this.nodes.wrapper=this.make("div",this.CSS.tooltip),this.nodes.content=this.make("div",this.CSS.tooltipContent),this.append(this.nodes.wrapper,this.nodes.content),this.append(document.body,this.nodes.wrapper)}loadStyles(){const a="codex-tooltips-style";if(document.getElementById(a))return;const l=o(2),c=this.make("style",null,{textContent:l.toString(),id:a});this.prepend(document.head,c)}placeBottom(a,l){const c=a.getBoundingClientRect(),f=c.left+a.clientWidth/2-this.nodes.wrapper.offsetWidth/2,h=c.bottom+window.pageYOffset+this.offsetTop+l.marginTop;this.applyPlacement("bottom",f,h)}placeTop(a,l){const c=a.getBoundingClientRect(),f=c.left+a.clientWidth/2-this.nodes.wrapper.offsetWidth/2,h=c.top+window.pageYOffset-this.nodes.wrapper.clientHeight-this.offsetTop;this.applyPlacement("top",f,h)}placeLeft(a,l){const c=a.getBoundingClientRect(),f=c.left-this.nodes.wrapper.offsetWidth-this.offsetLeft-l.marginLeft,h=c.top+window.pageYOffset+a.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("left",f,h)}placeRight(a,l){const c=a.getBoundingClientRect(),f=c.right+this.offsetRight+l.marginRight,h=c.top+window.pageYOffset+a.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("right",f,h)}applyPlacement(a,l,c){this.nodes.wrapper.classList.add(this.CSS.placement[a]),this.nodes.wrapper.style.left=l+"px",this.nodes.wrapper.style.top=c+"px"}make(a,l=null,c={}){const f=document.createElement(a);Array.isArray(l)?f.classList.add(...l):l&&f.classList.add(l);for(const h in c)c.hasOwnProperty(h)&&(f[h]=c[h]);return f}append(a,l){Array.isArray(l)?l.forEach(c=>a.appendChild(c)):a.appendChild(l)}prepend(a,l){Array.isArray(l)?(l=l.reverse()).forEach(c=>a.prepend(c)):a.prepend(l)}}},function(t,n){t.exports=`.ct{z-index:999;opacity:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1),-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);will-change:opacity,top,left;-webkit-box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);border-radius:9px}.ct,.ct:before{position:absolute;top:0;left:0}.ct:before{content:"";bottom:0;right:0;background-color:#1d202b;z-index:-1;border-radius:4px}@supports(-webkit-mask-box-image:url("")){.ct:before{border-radius:0;-webkit-mask-box-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M10.71 0h2.58c3.02 0 4.64.42 6.1 1.2a8.18 8.18 0 013.4 3.4C23.6 6.07 24 7.7 24 10.71v2.58c0 3.02-.42 4.64-1.2 6.1a8.18 8.18 0 01-3.4 3.4c-1.47.8-3.1 1.21-6.11 1.21H10.7c-3.02 0-4.64-.42-6.1-1.2a8.18 8.18 0 01-3.4-3.4C.4 17.93 0 16.3 0 13.29V10.7c0-3.02.42-4.64 1.2-6.1a8.18 8.18 0 013.4-3.4C6.07.4 7.7 0 10.71 0z"/></svg>') 48% 41% 37.9% 53.3%}}@media (--mobile){.ct{display:none}}.ct__content{padding:6px 10px;color:#cdd1e0;font-size:12px;text-align:center;letter-spacing:.02em;line-height:1em}.ct:after{content:"";width:8px;height:8px;position:absolute;background-color:#1d202b;z-index:-1}.ct--bottom{-webkit-transform:translateY(5px);transform:translateY(5px)}.ct--bottom:after{top:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--top{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.ct--top:after{top:auto;bottom:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--left{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.ct--left:after{top:50%;left:auto;right:0;-webkit-transform:translate(41.6%,-50%) rotate(-45deg);transform:translate(41.6%,-50%) rotate(-45deg)}.ct--right{-webkit-transform:translateX(5px);transform:translateX(5px)}.ct--right:after{top:50%;left:0;-webkit-transform:translate(-41.6%,-50%) rotate(-45deg);transform:translate(-41.6%,-50%) rotate(-45deg)}.ct--shown{opacity:1;-webkit-transform:none;transform:none}`}]).default})})(Ti);var Qa=Ti.exports;const el=pn(Qa);let Le=null;function or(){Le||(Le=new el)}function tl(r,e,t){or(),Le?.show(r,e,t)}function nn(r=!1){or(),Le?.hide(r)}function rn(r,e,t){or(),Le?.onHover(r,e,t)}function nl(){Le?.destroy(),Le=null}class rl extends ae{constructor({config:e,eventsDispatcher:t}){super({config:e,eventsDispatcher:t})}get methods(){return{show:(e,t,n)=>this.show(e,t,n),hide:()=>this.hide(),onHover:(e,t,n)=>this.onHover(e,t,n)}}show(e,t,n){tl(e,t,n)}hide(){nn()}onHover(e,t,n){rn(e,t,n)}}class ol extends ae{get methods(){return{nodes:this.editorNodes}}get editorNodes(){return{wrapper:this.Editor.UI.nodes.wrapper,redactor:this.Editor.UI.nodes.redactor}}}function Bi(r,e){const t={};return Object.entries(r).forEach(([n,o])=>{if(we(o)){const i=e?`${e}.${n}`:n;Object.values(o).every(s=>Ze(s))?t[n]=i:t[n]=Bi(o,i);return}t[n]=o}),t}const Be=Bi(gi);function il(r,e){const t={};return Object.keys(r).forEach(n=>{const o=e[n];o!==void 0?t[o]=r[n]:t[n]=r[n]}),t}const Oi=class Tt{constructor(e,t){this.cursor=-1,this.items=[],this.items=e||[],this.focusedCssClass=t}get currentItem(){return this.cursor===-1?null:this.items[this.cursor]}setCursor(e){e<this.items.length&&e>=-1&&(this.dropCursor(),this.cursor=e,this.items[this.cursor].classList.add(this.focusedCssClass))}setItems(e){this.items=e}next(){this.cursor=this.leafNodesAndReturnIndex(Tt.directions.RIGHT)}previous(){this.cursor=this.leafNodesAndReturnIndex(Tt.directions.LEFT)}dropCursor(){this.cursor!==-1&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}leafNodesAndReturnIndex(e){if(this.items.length===0)return this.cursor;let t=this.cursor;return t===-1?t=e===Tt.directions.RIGHT?-1:0:this.items[t].classList.remove(this.focusedCssClass),e===Tt.directions.RIGHT?t=(t+1)%this.items.length:t=(this.items.length+t-1)%this.items.length,F.canSetCaret(this.items[t])&&Qt(()=>te.setCursor(this.items[t]),50)(),this.items[t].classList.add(this.focusedCssClass),t}};Oi.directions={RIGHT:"right",LEFT:"left"};let Et=Oi,on=class Gn{constructor(e){this.iterator=null,this.activated=!1,this.flipCallbacks=[],this.onKeyDown=t=>{if(this.isEventReadyForHandling(t))switch(Gn.usedKeys.includes(t.keyCode)&&t.preventDefault(),t.keyCode){case re.TAB:this.handleTabPress(t);break;case re.LEFT:case re.UP:this.flipLeft();break;case re.RIGHT:case re.DOWN:this.flipRight();break;case re.ENTER:this.handleEnterPress(t);break}},this.iterator=new Et(e.items,e.focusedItemClass),this.activateCallback=e.activateCallback,this.allowedKeys=e.allowedKeys||Gn.usedKeys}get isActivated(){return this.activated}static get usedKeys(){return[re.TAB,re.LEFT,re.RIGHT,re.ENTER,re.UP,re.DOWN]}activate(e,t){this.activated=!0,e&&this.iterator.setItems(e),t!==void 0&&this.iterator.setCursor(t),document.addEventListener("keydown",this.onKeyDown,!0)}deactivate(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}focusFirst(){this.dropCursor(),this.flipRight()}flipLeft(){this.iterator.previous(),this.flipCallback()}flipRight(){this.iterator.next(),this.flipCallback()}hasFocus(){return!!this.iterator.currentItem}onFlip(e){this.flipCallbacks.push(e)}removeOnFlip(e){this.flipCallbacks=this.flipCallbacks.filter(t=>t!==e)}dropCursor(){this.iterator.dropCursor()}isEventReadyForHandling(e){return this.activated&&this.allowedKeys.includes(e.keyCode)}handleTabPress(e){switch(e.shiftKey?Et.directions.LEFT:Et.directions.RIGHT){case Et.directions.RIGHT:this.flipRight();break;case Et.directions.LEFT:this.flipLeft();break}}handleEnterPress(e){this.activated&&(this.iterator.currentItem&&(e.stopPropagation(),e.preventDefault(),this.iterator.currentItem.click()),pe(this.activateCallback)&&this.activateCallback(this.iterator.currentItem))}flipCallback(){this.iterator.currentItem&&this.iterator.currentItem.scrollIntoViewIfNeeded(),this.flipCallbacks.forEach(e=>e())}};const sl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M9 12L9 7.1C9 7.04477 9.04477 7 9.1 7H10.4C11.5 7 14 7.1 14 9.5C14 9.5 14 12 11 12M9 12V16.8C9 16.9105 9.08954 17 9.2 17H12.5C14 17 15 16 15 14.5C15 11.7046 11 12 11 12M9 12H11"/></svg>',al='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 10L11.8586 14.8586C11.9367 14.9367 12.0633 14.9367 12.1414 14.8586L17 10"/></svg>',ll='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M14.5 17.5L9.64142 12.6414C9.56331 12.5633 9.56331 12.4367 9.64142 12.3586L14.5 7.5"/></svg>',cl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M9.58284 17.5L14.4414 12.6414C14.5195 12.5633 14.5195 12.4367 14.4414 12.3586L9.58284 7.5"/></svg>',dl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 15L11.8586 10.1414C11.9367 10.0633 12.0633 10.0633 12.1414 10.1414L17 15"/></svg>',ul='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 8L12 12M12 12L16 16M12 12L16 8M12 12L8 16"/></svg>',hl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/></svg>',pl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M13.34 10C12.4223 12.7337 11 17 11 17"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M14.21 7H14.2"/></svg>',Yo='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.69998 12.6L7.67896 12.62C6.53993 13.7048 6.52012 15.5155 7.63516 16.625V16.625C8.72293 17.7073 10.4799 17.7102 11.5712 16.6314L13.0263 15.193C14.0703 14.1609 14.2141 12.525 13.3662 11.3266L13.22 11.12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16.22 11.12L16.3564 10.9805C17.2895 10.0265 17.3478 8.5207 16.4914 7.49733V7.49733C15.5691 6.39509 13.9269 6.25143 12.8271 7.17675L11.3901 8.38588C10.0935 9.47674 9.95706 11.4241 11.0888 12.6852L11.12 12.72"/></svg>',fl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.40999 7.29999H9.4"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 7.29999H14.59"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.30999 12H9.3"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 12H14.59"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.40999 16.7H9.4"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 16.7H14.59"/></svg>',gl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12 7V12M12 17V12M17 12H12M12 12H7"/></svg>',Ii='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M11.5 17.5L5 11M5 11V15.5M5 11H9.5"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12.5 6.5L19 13M19 13V8.5M19 13H14.5"/></svg>',ml='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="10.5" cy="10.5" r="5.5" stroke="currentColor" stroke-width="2"/><line x1="15.4142" x2="19" y1="15" y2="18.5858" stroke="currentColor" stroke-linecap="round" stroke-width="2"/></svg>',bl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M15.7795 11.5C15.7795 11.5 16.053 11.1962 16.5497 10.6722C17.4442 9.72856 17.4701 8.2475 16.5781 7.30145V7.30145C15.6482 6.31522 14.0873 6.29227 13.1288 7.25073L11.8796 8.49999"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.24517 12.3883C8.24517 12.3883 7.97171 12.6922 7.47504 13.2161C6.58051 14.1598 6.55467 15.6408 7.44666 16.5869V16.5869C8.37653 17.5731 9.93744 17.5961 10.8959 16.6376L12.1452 15.3883"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M17.7802 15.1032L16.597 14.9422C16.0109 14.8624 15.4841 15.3059 15.4627 15.8969L15.4199 17.0818"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6.39064 9.03238L7.58432 9.06668C8.17551 9.08366 8.6522 8.58665 8.61056 7.99669L8.5271 6.81397"/><line x1="12.1142" x2="11.7" y1="12.2" y2="11.7858" stroke="currentColor" stroke-linecap="round" stroke-width="2"/></svg>',vl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/><line x1="12" x2="12" y1="9" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12 15.02V15.01"/></svg>',yl="__",kl="--";function Je(r){return(e,t)=>[[r,e].filter(n=>!!n).join(yl),t].filter(n=>!!n).join(kl)}const _t=Je("ce-hint"),Ct={root:_t(),alignedStart:_t(null,"align-left"),alignedCenter:_t(null,"align-center"),title:_t("title"),description:_t("description")};class wl{constructor(e){this.nodes={root:F.make("div",[Ct.root,e.alignment==="center"?Ct.alignedCenter:Ct.alignedStart]),title:F.make("div",Ct.title,{textContent:e.title})},this.nodes.root.appendChild(this.nodes.title),e.description!==void 0&&(this.nodes.description=F.make("div",Ct.description,{textContent:e.description}),this.nodes.root.appendChild(this.nodes.description))}getElement(){return this.nodes.root}}let ir=class{constructor(e){this.params=e}get name(){if(this.params!==void 0&&"name"in this.params)return this.params.name}destroy(){nn()}onChildrenOpen(){var e;this.params!==void 0&&"children"in this.params&&typeof((e=this.params.children)==null?void 0:e.onOpen)=="function"&&this.params.children.onOpen()}onChildrenClose(){var e;this.params!==void 0&&"children"in this.params&&typeof((e=this.params.children)==null?void 0:e.onClose)=="function"&&this.params.children.onClose()}handleClick(){var e,t;this.params!==void 0&&"onActivate"in this.params&&((t=(e=this.params).onActivate)==null||t.call(e,this.params))}addHint(e,t){const n=new wl(t);rn(e,n.getElement(),{placement:t.position,hidingDelay:100})}get children(){var e;return this.params!==void 0&&"children"in this.params&&((e=this.params.children)==null?void 0:e.items)!==void 0?this.params.children.items:[]}get hasChildren(){return this.children.length>0}get isChildrenOpen(){var e;return this.params!==void 0&&"children"in this.params&&((e=this.params.children)==null?void 0:e.isOpen)===!0}get isChildrenFlippable(){var e;return!(this.params===void 0||!("children"in this.params)||((e=this.params.children)==null?void 0:e.isFlippable)===!1)}get isChildrenSearchable(){var e;return this.params!==void 0&&"children"in this.params&&((e=this.params.children)==null?void 0:e.searchable)===!0}get closeOnActivate(){return this.params!==void 0&&"closeOnActivate"in this.params&&this.params.closeOnActivate}get isActive(){return this.params===void 0||!("isActive"in this.params)?!1:typeof this.params.isActive=="function"?this.params.isActive():this.params.isActive===!0}};const Te=Je("ce-popover-item"),fe={container:Te(),active:Te(null,"active"),disabled:Te(null,"disabled"),focused:Te(null,"focused"),hidden:Te(null,"hidden"),confirmationState:Te(null,"confirmation"),noHover:Te(null,"no-hover"),noFocus:Te(null,"no-focus"),title:Te("title"),secondaryTitle:Te("secondary-title"),icon:Te("icon"),iconTool:Te("icon","tool"),iconChevronRight:Te("icon","chevron-right"),wobbleAnimation:Je("wobble")()};let et=class extends ir{constructor(e,t){super(e),this.params=e,this.nodes={root:null,icon:null},this.confirmationState=null,this.removeSpecialFocusBehavior=()=>{var n;(n=this.nodes.root)==null||n.classList.remove(fe.noFocus)},this.removeSpecialHoverBehavior=()=>{var n;(n=this.nodes.root)==null||n.classList.remove(fe.noHover)},this.onErrorAnimationEnd=()=>{var n,o;(n=this.nodes.icon)==null||n.classList.remove(fe.wobbleAnimation),(o=this.nodes.icon)==null||o.removeEventListener("animationend",this.onErrorAnimationEnd)},this.nodes.root=this.make(e,t)}get isDisabled(){return this.params.isDisabled===!0}get toggle(){return this.params.toggle}get title(){return this.params.title}get isConfirmationStateEnabled(){return this.confirmationState!==null}get isFocused(){return this.nodes.root===null?!1:this.nodes.root.classList.contains(fe.focused)}getElement(){return this.nodes.root}handleClick(){if(this.isConfirmationStateEnabled&&this.confirmationState!==null){this.activateOrEnableConfirmationMode(this.confirmationState);return}this.activateOrEnableConfirmationMode(this.params)}toggleActive(e){var t;(t=this.nodes.root)==null||t.classList.toggle(fe.active,e)}toggleHidden(e){var t;(t=this.nodes.root)==null||t.classList.toggle(fe.hidden,e)}reset(){this.isConfirmationStateEnabled&&this.disableConfirmationMode()}onFocus(){this.disableSpecialHoverAndFocusBehavior()}make(e,t){var n,o;const i=t?.wrapperTag||"div",s=F.make(i,fe.container,{type:i==="button"?"button":void 0});return e.name&&(s.dataset.itemName=e.name),this.nodes.icon=F.make("div",[fe.icon,fe.iconTool],{innerHTML:e.icon||hl}),s.appendChild(this.nodes.icon),e.title!==void 0&&s.appendChild(F.make("div",fe.title,{innerHTML:e.title||""})),e.secondaryLabel&&s.appendChild(F.make("div",fe.secondaryTitle,{textContent:e.secondaryLabel})),this.hasChildren&&s.appendChild(F.make("div",[fe.icon,fe.iconChevronRight],{innerHTML:cl})),this.isActive&&s.classList.add(fe.active),e.isDisabled&&s.classList.add(fe.disabled),e.hint!==void 0&&((n=t?.hint)==null?void 0:n.enabled)!==!1&&this.addHint(s,{...e.hint,position:((o=t?.hint)==null?void 0:o.position)||"right"}),s}enableConfirmationMode(e){if(this.nodes.root===null)return;const t={...this.params,...e,confirmation:"confirmation"in e?e.confirmation:void 0},n=this.make(t);this.nodes.root.innerHTML=n.innerHTML,this.nodes.root.classList.add(fe.confirmationState),this.confirmationState=e,this.enableSpecialHoverAndFocusBehavior()}disableConfirmationMode(){if(this.nodes.root===null)return;const e=this.make(this.params);this.nodes.root.innerHTML=e.innerHTML,this.nodes.root.classList.remove(fe.confirmationState),this.confirmationState=null,this.disableSpecialHoverAndFocusBehavior()}enableSpecialHoverAndFocusBehavior(){var e,t,n;(e=this.nodes.root)==null||e.classList.add(fe.noHover),(t=this.nodes.root)==null||t.classList.add(fe.noFocus),(n=this.nodes.root)==null||n.addEventListener("mouseleave",this.removeSpecialHoverBehavior,{once:!0})}disableSpecialHoverAndFocusBehavior(){var e;this.removeSpecialFocusBehavior(),this.removeSpecialHoverBehavior(),(e=this.nodes.root)==null||e.removeEventListener("mouseleave",this.removeSpecialHoverBehavior)}activateOrEnableConfirmationMode(e){var t;if(!("confirmation"in e)||e.confirmation===void 0)try{(t=e.onActivate)==null||t.call(e,e),this.disableConfirmationMode()}catch{this.animateError()}else this.enableConfirmationMode(e.confirmation)}animateError(){var e,t,n;(e=this.nodes.icon)!=null&&e.classList.contains(fe.wobbleAnimation)||((t=this.nodes.icon)==null||t.classList.add(fe.wobbleAnimation),(n=this.nodes.icon)==null||n.addEventListener("animationend",this.onErrorAnimationEnd))}};const Mn=Je("ce-popover-item-separator"),Ln={container:Mn(),line:Mn("line"),hidden:Mn(null,"hidden")};class Ai extends ir{constructor(){super(),this.nodes={root:F.make("div",Ln.container),line:F.make("div",Ln.line)},this.nodes.root.appendChild(this.nodes.line)}getElement(){return this.nodes.root}toggleHidden(e){var t;(t=this.nodes.root)==null||t.classList.toggle(Ln.hidden,e)}}var ze=(r=>(r.Closed="closed",r.ClosedOnActivate="closed-on-activate",r))(ze||{});const _e=Je("ce-popover"),ve={popover:_e(),popoverContainer:_e("container"),popoverOpenTop:_e(null,"open-top"),popoverOpenLeft:_e(null,"open-left"),popoverOpened:_e(null,"opened"),search:_e("search"),nothingFoundMessage:_e("nothing-found-message"),nothingFoundMessageDisplayed:_e("nothing-found-message","displayed"),items:_e("items"),overlay:_e("overlay"),overlayHidden:_e("overlay","hidden"),popoverNested:_e(null,"nested"),getPopoverNestedClass:r=>_e(null,`nested-level-${r.toString()}`),popoverInline:_e(null,"inline"),popoverHeader:_e("header")};var gt=(r=>(r.NestingLevel="--nesting-level",r.PopoverHeight="--popover-height",r.InlinePopoverWidth="--inline-popover-width",r.TriggerItemLeft="--trigger-item-left",r.TriggerItemTop="--trigger-item-top",r))(gt||{});const Vo=Je("ce-popover-item-html"),Go={root:Vo(),hidden:Vo(null,"hidden")};let Mt=class extends ir{constructor(e,t){var n,o;super(e),this.nodes={root:F.make("div",Go.root)},this.nodes.root.appendChild(e.element),e.name&&(this.nodes.root.dataset.itemName=e.name),e.hint!==void 0&&((n=t?.hint)==null?void 0:n.enabled)!==!1&&this.addHint(this.nodes.root,{...e.hint,position:((o=t?.hint)==null?void 0:o.position)||"right"})}getElement(){return this.nodes.root}toggleHidden(e){var t;(t=this.nodes.root)==null||t.classList.toggle(Go.hidden,e)}getControls(){const e=this.nodes.root.querySelectorAll(`button, ${F.allInputsSelector}`);return Array.from(e)}};class Mi extends Pt{constructor(e,t={}){super(),this.params=e,this.itemsRenderParams=t,this.listeners=new Nt,this.messages={nothingFound:"Nothing found",search:"Search"},this.items=this.buildItems(e.items),e.messages&&(this.messages={...this.messages,...e.messages}),this.nodes={},this.nodes.popoverContainer=F.make("div",[ve.popoverContainer]),this.nodes.nothingFoundMessage=F.make("div",[ve.nothingFoundMessage],{textContent:this.messages.nothingFound}),this.nodes.popoverContainer.appendChild(this.nodes.nothingFoundMessage),this.nodes.items=F.make("div",[ve.items]),this.items.forEach(n=>{const o=n.getElement();o!==null&&this.nodes.items.appendChild(o)}),this.nodes.popoverContainer.appendChild(this.nodes.items),this.listeners.on(this.nodes.popoverContainer,"click",n=>this.handleClick(n)),this.nodes.popover=F.make("div",[ve.popover,this.params.class]),this.nodes.popover.appendChild(this.nodes.popoverContainer)}get itemsDefault(){return this.items.filter(e=>e instanceof et)}getElement(){return this.nodes.popover}show(){this.nodes.popover.classList.add(ve.popoverOpened),this.search!==void 0&&this.search.focus()}hide(){this.nodes.popover.classList.remove(ve.popoverOpened),this.nodes.popover.classList.remove(ve.popoverOpenTop),this.itemsDefault.forEach(e=>e.reset()),this.search!==void 0&&this.search.clear(),this.emit(ze.Closed)}destroy(){var e;this.items.forEach(t=>t.destroy()),this.nodes.popover.remove(),this.listeners.removeAll(),(e=this.search)==null||e.destroy()}activateItemByName(e){const t=this.items.find(n=>n.name===e);this.handleItemClick(t)}buildItems(e){return e.map(t=>{switch(t.type){case he.Separator:return new Ai;case he.Html:return new Mt(t,this.itemsRenderParams[he.Html]);default:return new et(t,this.itemsRenderParams[he.Default])}})}getTargetItem(e){return this.items.filter(t=>t instanceof et||t instanceof Mt).find(t=>{const n=t.getElement();return n===null?!1:e.composedPath().includes(n)})}handleItemClick(e){if(!("isDisabled"in e&&e.isDisabled)){if(e.hasChildren){this.showNestedItems(e),"handleClick"in e&&typeof e.handleClick=="function"&&e.handleClick();return}this.itemsDefault.filter(t=>t!==e).forEach(t=>t.reset()),"handleClick"in e&&typeof e.handleClick=="function"&&e.handleClick(),this.toggleItemActivenessIfNeeded(e),e.closeOnActivate&&(this.hide(),this.emit(ze.ClosedOnActivate))}}handleClick(e){const t=this.getTargetItem(e);t!==void 0&&this.handleItemClick(t)}toggleItemActivenessIfNeeded(e){if(e instanceof et&&(e.toggle===!0&&e.toggleActive(),typeof e.toggle=="string")){const t=this.itemsDefault.filter(n=>n.toggle===e.toggle);if(t.length===1){e.toggleActive();return}t.forEach(n=>{n.toggleActive(n===e)})}}}var sn=(r=>(r.Search="search",r))(sn||{});const Pn=Je("cdx-search-field"),Nn={wrapper:Pn(),icon:Pn("icon"),input:Pn("input")};class xl extends Pt{constructor({items:e,placeholder:t}){super(),this.listeners=new Nt,this.items=e,this.wrapper=F.make("div",Nn.wrapper);const n=F.make("div",Nn.icon,{innerHTML:ml});this.input=F.make("input",Nn.input,{placeholder:t,tabIndex:-1}),this.wrapper.appendChild(n),this.wrapper.appendChild(this.input),this.listeners.on(this.input,"input",()=>{this.searchQuery=this.input.value,this.emit(sn.Search,{query:this.searchQuery,items:this.foundItems})})}getElement(){return this.wrapper}focus(){this.input.focus()}clear(){this.input.value="",this.searchQuery="",this.emit(sn.Search,{query:"",items:this.foundItems})}destroy(){this.listeners.removeAll()}get foundItems(){return this.items.filter(e=>this.checkItem(e))}checkItem(e){var t,n;const o=((t=e.title)==null?void 0:t.toLowerCase())||"",i=(n=this.searchQuery)==null?void 0:n.toLowerCase();return i!==void 0?o.includes(i):!1}}var El=Object.defineProperty,_l=Object.getOwnPropertyDescriptor,Cl=(r,e,t,n)=>{for(var o=_l(e,t),i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=s(e,t,o)||o);return o&&El(e,t,o),o};const Li=class Pi extends Mi{constructor(e,t){super(e,t),this.nestingLevel=0,this.nestedPopoverTriggerItem=null,this.previouslyHoveredItem=null,this.scopeElement=document.body,this.hide=()=>{var n;super.hide(),this.destroyNestedPopoverIfExists(),(n=this.flipper)==null||n.deactivate(),this.previouslyHoveredItem=null},this.onFlip=()=>{const n=this.itemsDefault.find(o=>o.isFocused);n?.onFocus()},this.onSearch=n=>{var o;const i=n.query==="",s=n.items.length===0;this.items.forEach(l=>{let c=!1;l instanceof et?c=!n.items.includes(l):(l instanceof Ai||l instanceof Mt)&&(c=s||!i),l.toggleHidden(c)}),this.toggleNothingFoundMessage(s);const a=n.query===""?this.flippableElements:n.items.map(l=>l.getElement());(o=this.flipper)!=null&&o.isActivated&&(this.flipper.deactivate(),this.flipper.activate(a))},e.nestingLevel!==void 0&&(this.nestingLevel=e.nestingLevel),this.nestingLevel>0&&this.nodes.popover.classList.add(ve.popoverNested),e.scopeElement!==void 0&&(this.scopeElement=e.scopeElement),this.nodes.popoverContainer!==null&&this.listeners.on(this.nodes.popoverContainer,"mouseover",n=>this.handleHover(n)),e.searchable&&this.addSearch(),e.flippable!==!1&&(this.flipper=new on({items:this.flippableElements,focusedItemClass:fe.focused,allowedKeys:[re.TAB,re.UP,re.DOWN,re.ENTER]}),this.flipper.onFlip(this.onFlip))}hasFocus(){return this.flipper===void 0?!1:this.flipper.hasFocus()}get scrollTop(){return this.nodes.items===null?0:this.nodes.items.scrollTop}get offsetTop(){return this.nodes.popoverContainer===null?0:this.nodes.popoverContainer.offsetTop}show(){var e;this.nodes.popover.style.setProperty(gt.PopoverHeight,this.size.height+"px"),this.shouldOpenBottom||this.nodes.popover.classList.add(ve.popoverOpenTop),this.shouldOpenRight||this.nodes.popover.classList.add(ve.popoverOpenLeft),super.show(),(e=this.flipper)==null||e.activate(this.flippableElements)}destroy(){this.hide(),super.destroy()}showNestedItems(e){this.nestedPopover!==null&&this.nestedPopover!==void 0||(this.nestedPopoverTriggerItem=e,this.showNestedPopoverForItem(e))}handleHover(e){const t=this.getTargetItem(e);t!==void 0&&this.previouslyHoveredItem!==t&&(this.destroyNestedPopoverIfExists(),this.previouslyHoveredItem=t,t.hasChildren&&this.showNestedPopoverForItem(t))}setTriggerItemPosition(e,t){const n=t.getElement(),o=(n?n.offsetTop:0)-this.scrollTop,i=this.offsetTop+o;e.style.setProperty(gt.TriggerItemTop,i+"px")}destroyNestedPopoverIfExists(){var e,t;this.nestedPopover===void 0||this.nestedPopover===null||(this.nestedPopover.off(ze.ClosedOnActivate,this.hide),this.nestedPopover.hide(),this.nestedPopover.destroy(),this.nestedPopover.getElement().remove(),this.nestedPopover=null,(e=this.flipper)==null||e.activate(this.flippableElements),(t=this.nestedPopoverTriggerItem)==null||t.onChildrenClose())}showNestedPopoverForItem(e){var t;this.nestedPopover=new Pi({searchable:e.isChildrenSearchable,items:e.children,nestingLevel:this.nestingLevel+1,flippable:e.isChildrenFlippable,messages:this.messages}),e.onChildrenOpen(),this.nestedPopover.on(ze.ClosedOnActivate,this.hide);const n=this.nestedPopover.getElement();return this.nodes.popover.appendChild(n),this.setTriggerItemPosition(n,e),n.style.setProperty(gt.NestingLevel,this.nestedPopover.nestingLevel.toString()),this.nestedPopover.show(),(t=this.flipper)==null||t.deactivate(),this.nestedPopover}get shouldOpenBottom(){if(this.nodes.popover===void 0||this.nodes.popover===null)return!1;const e=this.nodes.popoverContainer.getBoundingClientRect(),t=this.scopeElement.getBoundingClientRect(),n=this.size.height,o=e.top+n,i=e.top-n,s=Math.min(window.innerHeight,t.bottom);return i<t.top||o<=s}get shouldOpenRight(){if(this.nodes.popover===void 0||this.nodes.popover===null)return!1;const e=this.nodes.popover.getBoundingClientRect(),t=this.scopeElement.getBoundingClientRect(),n=this.size.width,o=e.right+n,i=e.left-n,s=Math.min(window.innerWidth,t.right);return i<t.left||o<=s}get size(){var e;const t={height:0,width:0};if(this.nodes.popover===null)return t;const n=this.nodes.popover.cloneNode(!0);n.style.visibility="hidden",n.style.position="absolute",n.style.top="-1000px",n.classList.add(ve.popoverOpened),(e=n.querySelector("."+ve.popoverNested))==null||e.remove(),document.body.appendChild(n);const o=n.querySelector("."+ve.popoverContainer);return t.height=o.offsetHeight,t.width=o.offsetWidth,n.remove(),t}get flippableElements(){return this.items.map(e=>{if(e instanceof et)return e.getElement();if(e instanceof Mt)return e.getControls()}).flat().filter(e=>e!=null)}addSearch(){this.search=new xl({items:this.itemsDefault,placeholder:this.messages.search}),this.search.on(sn.Search,this.onSearch);const e=this.search.getElement();e.classList.add(ve.search),this.nodes.popoverContainer.insertBefore(e,this.nodes.popoverContainer.firstChild)}toggleNothingFoundMessage(e){this.nodes.nothingFoundMessage.classList.toggle(ve.nothingFoundMessageDisplayed,e)}};Cl([vt],Li.prototype,"size");let sr=Li;class Sl extends sr{constructor(e){const t=!yt();super({...e,class:ve.popoverInline},{[he.Default]:{wrapperTag:"button",hint:{position:"top",alignment:"center",enabled:t}},[he.Html]:{hint:{position:"top",alignment:"center",enabled:t}}}),this.items.forEach(n=>{!(n instanceof et)&&!(n instanceof Mt)||n.hasChildren&&n.isChildrenOpen&&this.showNestedItems(n)})}get offsetLeft(){return this.nodes.popoverContainer===null?0:this.nodes.popoverContainer.offsetLeft}show(){this.nestingLevel===0&&this.nodes.popover.style.setProperty(gt.InlinePopoverWidth,this.size.width+"px"),super.show()}handleHover(){}setTriggerItemPosition(e,t){const n=t.getElement(),o=n?n.offsetLeft:0,i=this.offsetLeft+o;e.style.setProperty(gt.TriggerItemLeft,i+"px")}showNestedItems(e){if(this.nestedPopoverTriggerItem===e){this.destroyNestedPopoverIfExists(),this.nestedPopoverTriggerItem=null;return}super.showNestedItems(e)}showNestedPopoverForItem(e){const t=super.showNestedPopoverForItem(e);return t.getElement().classList.add(ve.getPopoverNestedClass(t.nestingLevel)),t}handleItemClick(e){var t;e!==this.nestedPopoverTriggerItem&&((t=this.nestedPopoverTriggerItem)==null||t.handleClick(),super.destroyNestedPopoverIfExists()),super.handleItemClick(e)}}const Ni=class Bt{constructor(){this.scrollPosition=null}lock(){Kn?this.lockHard():document.body.classList.add(Bt.CSS.scrollLocked)}unlock(){Kn?this.unlockHard():document.body.classList.remove(Bt.CSS.scrollLocked)}lockHard(){this.scrollPosition=window.pageYOffset,document.documentElement.style.setProperty("--window-scroll-offset",`${this.scrollPosition}px`),document.body.classList.add(Bt.CSS.scrollLockedHard)}unlockHard(){document.body.classList.remove(Bt.CSS.scrollLockedHard),this.scrollPosition!==null&&window.scrollTo(0,this.scrollPosition),this.scrollPosition=null}};Ni.CSS={scrollLocked:"ce-scroll-locked",scrollLockedHard:"ce-scroll-locked--hard"};let Tl=Ni;const Rn=Je("ce-popover-header"),Dn={root:Rn(),text:Rn("text"),backButton:Rn("back-button")};class Bl{constructor({text:e,onBackButtonClick:t}){this.listeners=new Nt,this.text=e,this.onBackButtonClick=t,this.nodes={root:F.make("div",[Dn.root]),backButton:F.make("button",[Dn.backButton]),text:F.make("div",[Dn.text])},this.nodes.backButton.innerHTML=ll,this.nodes.root.appendChild(this.nodes.backButton),this.listeners.on(this.nodes.backButton,"click",this.onBackButtonClick),this.nodes.text.innerText=this.text,this.nodes.root.appendChild(this.nodes.text)}getElement(){return this.nodes.root}destroy(){this.nodes.root.remove(),this.listeners.destroy()}}class Ol{constructor(){this.history=[]}push(e){this.history.push(e)}pop(){return this.history.pop()}get currentTitle(){return this.history.length===0?"":this.history[this.history.length-1].title}get currentItems(){return this.history.length===0?[]:this.history[this.history.length-1].items}reset(){for(;this.history.length>1;)this.pop()}}let Ri=class extends Mi{constructor(e){super(e,{[he.Default]:{hint:{enabled:!1}},[he.Html]:{hint:{enabled:!1}}}),this.scrollLocker=new Tl,this.history=new Ol,this.isHidden=!0,this.nodes.overlay=F.make("div",[ve.overlay,ve.overlayHidden]),this.nodes.popover.insertBefore(this.nodes.overlay,this.nodes.popover.firstChild),this.listeners.on(this.nodes.overlay,"click",()=>{this.hide()}),this.history.push({items:e.items})}show(){this.nodes.overlay.classList.remove(ve.overlayHidden),super.show(),this.scrollLocker.lock(),this.isHidden=!1}hide(){this.isHidden||(super.hide(),this.nodes.overlay.classList.add(ve.overlayHidden),this.scrollLocker.unlock(),this.history.reset(),this.isHidden=!0)}destroy(){super.destroy(),this.scrollLocker.unlock()}showNestedItems(e){this.updateItemsAndHeader(e.children,e.title),this.history.push({title:e.title,items:e.children})}updateItemsAndHeader(e,t){if(this.header!==null&&this.header!==void 0&&(this.header.destroy(),this.header=null),t!==void 0){this.header=new Bl({text:t,onBackButtonClick:()=>{this.history.pop(),this.updateItemsAndHeader(this.history.currentItems,this.history.currentTitle)}});const n=this.header.getElement();n!==null&&this.nodes.popoverContainer.insertBefore(n,this.nodes.popoverContainer.firstChild)}this.items.forEach(n=>{var o;return(o=n.getElement())==null?void 0:o.remove()}),this.items=this.buildItems(e),this.items.forEach(n=>{var o;const i=n.getElement();i!==null&&((o=this.nodes.items)==null||o.appendChild(i))})}};class Il extends ae{constructor(){super(...arguments),this.opened=!1,this.selection=new te,this.popover=null,this.close=()=>{this.opened&&(this.opened=!1,te.isAtEditor||this.selection.restore(),this.selection.clearSaved(),!this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted&&this.Editor.BlockManager.currentBlock&&this.Editor.BlockSelection.unselectBlock(this.Editor.BlockManager.currentBlock),this.eventsDispatcher.emit(this.events.closed),this.popover&&(this.popover.off(ze.Closed,this.onPopoverClose),this.popover.destroy(),this.popover.getElement().remove(),this.popover=null))},this.onPopoverClose=()=>{this.close()}}get events(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}get CSS(){return{settings:"ce-settings"}}get flipper(){var e;if(this.popover!==null)return"flipper"in this.popover?(e=this.popover)==null?void 0:e.flipper:void 0}make(){this.nodes.wrapper=F.make("div",[this.CSS.settings]),this.nodes.wrapper.setAttribute("data-cy","block-tunes"),this.eventsDispatcher.on(At,this.close)}destroy(){this.removeAllNodes(),this.listeners.destroy(),this.eventsDispatcher.off(At,this.close)}async open(e=this.Editor.BlockManager.currentBlock){var t;this.opened=!0,this.selection.save(),this.Editor.BlockSelection.selectBlock(e),this.Editor.BlockSelection.clearCache();const{toolTunes:n,commonTunes:o}=e.getTunes();this.eventsDispatcher.emit(this.events.opened);const i=yt()?Ri:sr;this.popover=new i({searchable:!0,items:await this.getTunesItems(e,o,n),scopeElement:this.Editor.API.methods.ui.nodes.redactor,messages:{nothingFound:Ce.ui(Be.ui.popover,"Nothing found"),search:Ce.ui(Be.ui.popover,"Filter")}}),this.popover.on(ze.Closed,this.onPopoverClose),(t=this.nodes.wrapper)==null||t.append(this.popover.getElement()),this.popover.show()}getElement(){return this.nodes.wrapper}async getTunesItems(e,t,n){const o=[];n!==void 0&&n.length>0&&(o.push(...n),o.push({type:he.Separator}));const i=Array.from(this.Editor.Tools.blockTools.values()),s=(await Ei(e,i)).reduce((a,l)=>(l.toolbox.forEach(c=>{a.push({icon:c.icon,title:Ce.t(Be.toolNames,c.title),name:l.name,closeOnActivate:!0,onActivate:async()=>{const{BlockManager:f,Caret:h,Toolbar:y}=this.Editor,p=await f.convert(e,l.name,c.data);y.close(),h.setToBlock(p,h.positions.END)}})}),a),[]);return s.length>0&&(o.push({icon:Ii,name:"convert-to",title:Ce.ui(Be.ui.popover,"Convert to"),children:{searchable:!0,items:s}}),o.push({type:he.Separator})),o.push(...t),o.map(a=>this.resolveTuneAliases(a))}resolveTuneAliases(e){if(e.type===he.Separator||e.type===he.Html)return e;const t=il(e,{label:"title"});return e.confirmation&&(t.confirmation=this.resolveTuneAliases(e.confirmation)),t}}var Di={exports:{}};/*!
 * Library for handling keyboard shortcuts
 * @copyright CodeX (https://codex.so)
 * @license MIT
 * @author CodeX (https://codex.so)
 * @version 1.2.0
 */(function(r,e){(function(t,n){r.exports=n()})(window,function(){return function(t){var n={};function o(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=t,o.c=n,o.d=function(i,s,a){o.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:a})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,s){if(1&s&&(i=o(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var l in i)o.d(a,l,function(c){return i[c]}.bind(null,l));return a},o.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(s,"a",s),s},o.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},o.p="",o(o.s=0)}([function(t,n,o){function i(l,c){for(var f=0;f<c.length;f++){var h=c[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,h.key,h)}}function s(l,c,f){return c&&i(l.prototype,c),f&&i(l,f),l}o.r(n);var a=function(){function l(c){var f=this;(function(h,y){if(!(h instanceof y))throw new TypeError("Cannot call a class as a function")})(this,l),this.commands={},this.keys={},this.name=c.name,this.parseShortcutName(c.name),this.element=c.on,this.callback=c.callback,this.executeShortcut=function(h){f.execute(h)},this.element.addEventListener("keydown",this.executeShortcut,!1)}return s(l,null,[{key:"supportedCommands",get:function(){return{SHIFT:["SHIFT"],CMD:["CMD","CONTROL","COMMAND","WINDOWS","CTRL"],ALT:["ALT","OPTION"]}}},{key:"keyCodes",get:function(){return{0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,BACKSPACE:8,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,".":190}}}]),s(l,[{key:"parseShortcutName",value:function(c){c=c.split("+");for(var f=0;f<c.length;f++){c[f]=c[f].toUpperCase();var h=!1;for(var y in l.supportedCommands)if(l.supportedCommands[y].includes(c[f])){h=this.commands[y]=!0;break}h||(this.keys[c[f]]=!0)}for(var p in l.supportedCommands)this.commands[p]||(this.commands[p]=!1)}},{key:"execute",value:function(c){var f,h={CMD:c.ctrlKey||c.metaKey,SHIFT:c.shiftKey,ALT:c.altKey},y=!0;for(f in this.commands)this.commands[f]!==h[f]&&(y=!1);var p,v=!0;for(p in this.keys)v=v&&c.keyCode===l.keyCodes[p];y&&v&&this.callback(c)}},{key:"remove",value:function(){this.element.removeEventListener("keydown",this.executeShortcut)}}]),l}();n.default=a}]).default})})(Di);var Al=Di.exports;const Ml=pn(Al);class Ll{constructor(){this.registeredShortcuts=new Map}add(e){if(this.findShortcut(e.on,e.name))throw Error(`Shortcut ${e.name} is already registered for ${e.on}. Please remove it before add a new handler.`);const t=new Ml({name:e.name,on:e.on,callback:e.handler}),n=this.registeredShortcuts.get(e.on)||[];this.registeredShortcuts.set(e.on,[...n,t])}remove(e,t){const n=this.findShortcut(e,t);if(!n)return;n.remove();const o=this.registeredShortcuts.get(e);this.registeredShortcuts.set(e,o.filter(i=>i!==n))}findShortcut(e,t){return(this.registeredShortcuts.get(e)||[]).find(({name:n})=>n===t)}}const mt=new Ll;var Pl=Object.defineProperty,Nl=Object.getOwnPropertyDescriptor,ji=(r,e,t,n)=>{for(var o=Nl(e,t),i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=s(e,t,o)||o);return o&&Pl(e,t,o),o},Wt=(r=>(r.Opened="toolbox-opened",r.Closed="toolbox-closed",r.BlockAdded="toolbox-block-added",r))(Wt||{});const ar=class Fi extends Pt{constructor({api:e,tools:t,i18nLabels:n}){super(),this.opened=!1,this.listeners=new Nt,this.popover=null,this.handleMobileLayoutToggle=()=>{this.destroyPopover(),this.initPopover()},this.onPopoverClose=()=>{this.opened=!1,this.emit("toolbox-closed")},this.api=e,this.tools=t,this.i18nLabels=n,this.enableShortcuts(),this.nodes={toolbox:F.make("div",Fi.CSS.toolbox)},this.initPopover(),this.nodes.toolbox.setAttribute("data-cy","toolbox"),this.api.events.on(At,this.handleMobileLayoutToggle)}get isEmpty(){return this.toolsToBeDisplayed.length===0}static get CSS(){return{toolbox:"ce-toolbox"}}getElement(){return this.nodes.toolbox}hasFocus(){if(this.popover!==null)return"hasFocus"in this.popover?this.popover.hasFocus():void 0}destroy(){var e;super.destroy(),this.nodes&&this.nodes.toolbox&&this.nodes.toolbox.remove(),this.removeAllShortcuts(),(e=this.popover)==null||e.off(ze.Closed,this.onPopoverClose),this.listeners.destroy(),this.api.events.off(At,this.handleMobileLayoutToggle)}toolButtonActivated(e,t){this.insertNewBlock(e,t)}open(){var e;this.isEmpty||((e=this.popover)==null||e.show(),this.opened=!0,this.emit("toolbox-opened"))}close(){var e;(e=this.popover)==null||e.hide(),this.opened=!1,this.emit("toolbox-closed")}toggle(){this.opened?this.close():this.open()}initPopover(){var e;const t=yt()?Ri:sr;this.popover=new t({scopeElement:this.api.ui.nodes.redactor,searchable:!0,messages:{nothingFound:this.i18nLabels.nothingFound,search:this.i18nLabels.filter},items:this.toolboxItemsToBeDisplayed}),this.popover.on(ze.Closed,this.onPopoverClose),(e=this.nodes.toolbox)==null||e.append(this.popover.getElement())}destroyPopover(){this.popover!==null&&(this.popover.hide(),this.popover.off(ze.Closed,this.onPopoverClose),this.popover.destroy(),this.popover=null),this.nodes.toolbox!==null&&(this.nodes.toolbox.innerHTML="")}get toolsToBeDisplayed(){const e=[];return this.tools.forEach(t=>{t.toolbox&&e.push(t)}),e}get toolboxItemsToBeDisplayed(){const e=(t,n,o=!0)=>({icon:t.icon,title:Ce.t(Be.toolNames,t.title||en(n.name)),name:n.name,onActivate:()=>{this.toolButtonActivated(n.name,t.data)},secondaryLabel:n.shortcut&&o?tr(n.shortcut):""});return this.toolsToBeDisplayed.reduce((t,n)=>(Array.isArray(n.toolbox)?n.toolbox.forEach((o,i)=>{t.push(e(o,n,i===0))}):n.toolbox!==void 0&&t.push(e(n.toolbox,n)),t),[])}enableShortcuts(){this.toolsToBeDisplayed.forEach(e=>{const t=e.shortcut;t&&this.enableShortcutForTool(e.name,t)})}enableShortcutForTool(e,t){mt.add({name:t,on:this.api.ui.nodes.redactor,handler:async n=>{n.preventDefault();const o=this.api.blocks.getCurrentBlockIndex(),i=this.api.blocks.getBlockByIndex(o);if(i)try{const s=await this.api.blocks.convert(i.id,e);this.api.caret.setToBlock(s,"end");return}catch{}this.insertNewBlock(e)}})}removeAllShortcuts(){this.toolsToBeDisplayed.forEach(e=>{const t=e.shortcut;t&&mt.remove(this.api.ui.nodes.redactor,t)})}async insertNewBlock(e,t){const n=this.api.blocks.getCurrentBlockIndex(),o=this.api.blocks.getBlockByIndex(n);if(!o)return;const i=o.isEmpty?n:n+1;let s;if(t){const l=await this.api.blocks.composeBlockData(e);s=Object.assign(l,t)}const a=this.api.blocks.insert(e,s,void 0,i,void 0,o.isEmpty);a.call(We.APPEND_CALLBACK),this.api.caret.setToBlock(i),this.emit("toolbox-block-added",{block:a}),this.api.toolbar.close()}};ji([vt],ar.prototype,"toolsToBeDisplayed");ji([vt],ar.prototype,"toolboxItemsToBeDisplayed");let Rl=ar;const zi="block hovered";async function Dl(r,e){const t=navigator.keyboard;if(!t)return e;try{return(await t.getLayoutMap()).get(r)||e}catch(n){return console.error(n),e}}class jl extends ae{constructor({config:e,eventsDispatcher:t}){super({config:e,eventsDispatcher:t}),this.toolboxInstance=null}get CSS(){return{toolbar:"ce-toolbar",content:"ce-toolbar__content",actions:"ce-toolbar__actions",actionsOpened:"ce-toolbar__actions--opened",toolbarOpened:"ce-toolbar--opened",openedToolboxHolderModifier:"codex-editor--toolbox-opened",plusButton:"ce-toolbar__plus",plusButtonShortcut:"ce-toolbar__plus-shortcut",settingsToggler:"ce-toolbar__settings-btn",settingsTogglerHidden:"ce-toolbar__settings-btn--hidden"}}get opened(){return this.nodes.wrapper.classList.contains(this.CSS.toolbarOpened)}get toolbox(){var e;return{opened:(e=this.toolboxInstance)==null?void 0:e.opened,close:()=>{var t;(t=this.toolboxInstance)==null||t.close()},open:()=>{if(this.toolboxInstance===null){ce("toolbox.open() called before initialization is finished","warn");return}this.Editor.BlockManager.currentBlock=this.hoveredBlock,this.toolboxInstance.open()},toggle:()=>{if(this.toolboxInstance===null){ce("toolbox.toggle() called before initialization is finished","warn");return}this.toolboxInstance.toggle()},hasFocus:()=>{var t;return(t=this.toolboxInstance)==null?void 0:t.hasFocus()}}}get blockActions(){return{hide:()=>{this.nodes.actions.classList.remove(this.CSS.actionsOpened)},show:()=>{this.nodes.actions.classList.add(this.CSS.actionsOpened)}}}get blockTunesToggler(){return{hide:()=>this.nodes.settingsToggler.classList.add(this.CSS.settingsTogglerHidden),show:()=>this.nodes.settingsToggler.classList.remove(this.CSS.settingsTogglerHidden)}}toggleReadOnly(e){e?(this.destroy(),this.Editor.BlockSettings.destroy(),this.disableModuleBindings()):window.requestIdleCallback(()=>{this.drawUI(),this.enableModuleBindings()},{timeout:2e3})}moveAndOpen(e=this.Editor.BlockManager.currentBlock){if(this.toolboxInstance===null){ce("Can't open Toolbar since Editor initialization is not finished yet","warn");return}if(this.toolboxInstance.opened&&this.toolboxInstance.close(),this.Editor.BlockSettings.opened&&this.Editor.BlockSettings.close(),!e)return;this.hoveredBlock=e;const t=e.holder,{isMobile:n}=this.Editor.UI;let o;const i=20,s=e.firstInput,a=t.getBoundingClientRect(),l=s!==void 0?s.getBoundingClientRect():null,c=l!==null?l.top-a.top:null,f=c!==null?c>i:void 0;if(n)o=t.offsetTop+t.offsetHeight;else if(s===void 0||f){const h=parseInt(window.getComputedStyle(e.pluginsContent).paddingTop);o=t.offsetTop+h}else{const h=wa(s),y=parseInt(window.getComputedStyle(this.nodes.plusButton).height,10);o=t.offsetTop+h-y+8+c}this.nodes.wrapper.style.top=`${Math.floor(o)}px`,this.Editor.BlockManager.blocks.length===1&&e.isEmpty?this.blockTunesToggler.hide():this.blockTunesToggler.show(),this.open()}close(){var e,t;this.Editor.ReadOnly.isEnabled||((e=this.nodes.wrapper)==null||e.classList.remove(this.CSS.toolbarOpened),this.blockActions.hide(),(t=this.toolboxInstance)==null||t.close(),this.Editor.BlockSettings.close(),this.reset())}reset(){this.nodes.wrapper.style.top="unset"}open(e=!0){this.nodes.wrapper.classList.add(this.CSS.toolbarOpened),e?this.blockActions.show():this.blockActions.hide()}async make(){this.nodes.wrapper=F.make("div",this.CSS.toolbar),["content","actions"].forEach(i=>{this.nodes[i]=F.make("div",this.CSS[i])}),F.append(this.nodes.wrapper,this.nodes.content),F.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=F.make("div",this.CSS.plusButton,{innerHTML:gl}),F.append(this.nodes.actions,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",()=>{nn(!0),this.plusButtonClicked()},!1);const e=F.make("div");e.appendChild(document.createTextNode(Ce.ui(Be.ui.toolbar.toolbox,"Add"))),e.appendChild(F.make("div",this.CSS.plusButtonShortcut,{textContent:"/"})),rn(this.nodes.plusButton,e,{hidingDelay:400}),this.nodes.settingsToggler=F.make("span",this.CSS.settingsToggler,{innerHTML:fl}),F.append(this.nodes.actions,this.nodes.settingsToggler);const t=F.make("div"),n=F.text(Ce.ui(Be.ui.blockTunes.toggler,"Click to tune")),o=await Dl("Slash","/");t.appendChild(n),t.appendChild(F.make("div",this.CSS.plusButtonShortcut,{textContent:tr(`CMD + ${o}`)})),rn(this.nodes.settingsToggler,t,{hidingDelay:400}),F.append(this.nodes.actions,this.makeToolbox()),F.append(this.nodes.actions,this.Editor.BlockSettings.getElement()),F.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper)}makeToolbox(){return this.toolboxInstance=new Rl({api:this.Editor.API.methods,tools:this.Editor.Tools.blockTools,i18nLabels:{filter:Ce.ui(Be.ui.popover,"Filter"),nothingFound:Ce.ui(Be.ui.popover,"Nothing found")}}),this.toolboxInstance.on(Wt.Opened,()=>{this.Editor.UI.nodes.wrapper.classList.add(this.CSS.openedToolboxHolderModifier)}),this.toolboxInstance.on(Wt.Closed,()=>{this.Editor.UI.nodes.wrapper.classList.remove(this.CSS.openedToolboxHolderModifier)}),this.toolboxInstance.on(Wt.BlockAdded,({block:e})=>{const{BlockManager:t,Caret:n}=this.Editor,o=t.getBlockById(e.id);o.inputs.length===0&&(o===t.lastBlock?(t.insertAtEnd(),n.setToBlock(t.lastBlock)):n.setToBlock(t.nextBlock))}),this.toolboxInstance.getElement()}plusButtonClicked(){var e;this.Editor.BlockManager.currentBlock=this.hoveredBlock,(e=this.toolboxInstance)==null||e.toggle()}enableModuleBindings(){this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"mousedown",e=>{var t;e.stopPropagation(),this.settingsTogglerClicked(),(t=this.toolboxInstance)!=null&&t.opened&&this.toolboxInstance.close(),nn(!0)},!0),yt()||this.eventsDispatcher.on(zi,e=>{var t;this.Editor.BlockSettings.opened||(t=this.toolboxInstance)!=null&&t.opened||this.moveAndOpen(e.block)})}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}settingsTogglerClicked(){this.Editor.BlockManager.currentBlock=this.hoveredBlock,this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.BlockSettings.open(this.hoveredBlock)}drawUI(){this.Editor.BlockSettings.make(),this.make()}destroy(){this.removeAllNodes(),this.toolboxInstance&&this.toolboxInstance.destroy()}}var tt=(r=>(r[r.Block=0]="Block",r[r.Inline=1]="Inline",r[r.Tune=2]="Tune",r))(tt||{}),qt=(r=>(r.Shortcut="shortcut",r.Toolbox="toolbox",r.EnabledInlineTools="inlineToolbar",r.EnabledBlockTunes="tunes",r.Config="config",r))(qt||{}),Hi=(r=>(r.Shortcut="shortcut",r.SanitizeConfig="sanitize",r))(Hi||{}),ht=(r=>(r.IsEnabledLineBreaks="enableLineBreaks",r.Toolbox="toolbox",r.ConversionConfig="conversionConfig",r.IsReadOnlySupported="isReadOnlySupported",r.PasteConfig="pasteConfig",r))(ht||{}),an=(r=>(r.IsInline="isInline",r.Title="title",r.IsReadOnlySupported="isReadOnlySupported",r))(an||{}),Xn=(r=>(r.IsTune="isTune",r))(Xn||{});let lr=class{constructor({name:e,constructable:t,config:n,api:o,isDefault:i,isInternal:s=!1,defaultPlaceholder:a}){this.api=o,this.name=e,this.constructable=t,this.config=n,this.isDefault=i,this.isInternal=s,this.defaultPlaceholder=a}get settings(){const e=this.config.config||{};return this.isDefault&&!("placeholder"in e)&&this.defaultPlaceholder&&(e.placeholder=this.defaultPlaceholder),e}reset(){if(pe(this.constructable.reset))return this.constructable.reset()}prepare(){if(pe(this.constructable.prepare))return this.constructable.prepare({toolName:this.name,config:this.settings})}get shortcut(){const e=this.constructable.shortcut;return this.config.shortcut||e}get sanitizeConfig(){return this.constructable.sanitize||{}}isInline(){return this.type===tt.Inline}isBlock(){return this.type===tt.Block}isTune(){return this.type===tt.Tune}};class Fl extends ae{constructor({config:e,eventsDispatcher:t}){super({config:e,eventsDispatcher:t}),this.CSS={inlineToolbar:"ce-inline-toolbar"},this.opened=!1,this.popover=null,this.toolbarVerticalMargin=yt()?20:6,this.tools=new Map,window.requestIdleCallback(()=>{this.make()},{timeout:2e3})}async tryToShow(e=!1){e&&this.close(),this.allowedToShow()&&(await this.open(),this.Editor.Toolbar.close())}close(){var e,t;if(this.opened){for(const[n,o]of this.tools){const i=this.getToolShortcut(n.name);i!==void 0&&mt.remove(this.Editor.UI.nodes.redactor,i),pe(o.clear)&&o.clear()}this.tools=new Map,this.reset(),this.opened=!1,(e=this.popover)==null||e.hide(),(t=this.popover)==null||t.destroy(),this.popover=null}}containsNode(e){return this.nodes.wrapper===void 0?!1:this.nodes.wrapper.contains(e)}destroy(){var e;this.removeAllNodes(),(e=this.popover)==null||e.destroy(),this.popover=null}make(){this.nodes.wrapper=F.make("div",[this.CSS.inlineToolbar,...this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]]),this.nodes.wrapper.setAttribute("data-cy","inline-toolbar"),F.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper)}async open(){var e;if(this.opened)return;this.opened=!0,this.popover!==null&&this.popover.destroy(),this.createToolsInstances();const t=await this.getPopoverItems();this.popover=new Sl({items:t,scopeElement:this.Editor.API.methods.ui.nodes.redactor,messages:{nothingFound:Ce.ui(Be.ui.popover,"Nothing found"),search:Ce.ui(Be.ui.popover,"Filter")}}),this.move(this.popover.size.width),(e=this.nodes.wrapper)==null||e.append(this.popover.getElement()),this.popover.show()}move(e){const t=te.rect,n=this.Editor.UI.nodes.wrapper.getBoundingClientRect(),o={x:t.x-n.x,y:t.y+t.height-n.top+this.toolbarVerticalMargin};o.x+e+n.x>this.Editor.UI.contentRect.right&&(o.x=this.Editor.UI.contentRect.right-e-n.x),this.nodes.wrapper.style.left=Math.floor(o.x)+"px",this.nodes.wrapper.style.top=Math.floor(o.y)+"px"}reset(){this.nodes.wrapper.style.left="0",this.nodes.wrapper.style.top="0"}allowedToShow(){const e=["IMG","INPUT"],t=te.get(),n=te.text;if(!t||!t.anchorNode||t.isCollapsed||n.length<1)return!1;const o=F.isElement(t.anchorNode)?t.anchorNode:t.anchorNode.parentElement;if(o===null||t!==null&&e.includes(o.tagName))return!1;const i=this.Editor.BlockManager.getBlock(t.anchorNode);return!i||this.getTools().some(s=>i.tool.inlineTools.has(s.name))===!1?!1:o.closest("[contenteditable]")!==null}getTools(){const e=this.Editor.BlockManager.currentBlock;return e?Array.from(e.tool.inlineTools.values()).filter(t=>!(this.Editor.ReadOnly.isEnabled&&t.isReadOnlySupported!==!0)):[]}createToolsInstances(){this.tools=new Map,this.getTools().forEach(e=>{const t=e.create();this.tools.set(e,t)})}async getPopoverItems(){const e=[];let t=0;for(const[n,o]of this.tools){const i=await o.render(),s=this.getToolShortcut(n.name);if(s!==void 0)try{this.enableShortcuts(n.name,s)}catch{}const a=s!==void 0?tr(s):void 0,l=Ce.t(Be.toolNames,n.title||en(n.name));[i].flat().forEach(c=>{var f,h;const y={name:n.name,onActivate:()=>{this.toolClicked(o)},hint:{title:l,description:a}};if(F.isElement(c)){const p={...y,element:c,type:he.Html};if(pe(o.renderActions)){const v=o.renderActions();p.children={isOpen:(f=o.checkState)==null?void 0:f.call(o,te.get()),isFlippable:!1,items:[{type:he.Html,element:v}]}}else(h=o.checkState)==null||h.call(o,te.get());e.push(p)}else if(c.type===he.Html)e.push({...y,...c,type:he.Html});else if(c.type===he.Separator)e.push({type:he.Separator});else{const p={...y,...c,type:he.Default};"children"in p&&t!==0&&e.push({type:he.Separator}),e.push(p),"children"in p&&t<this.tools.size-1&&e.push({type:he.Separator})}}),t++}return e}getToolShortcut(e){const{Tools:t}=this.Editor,n=t.inlineTools.get(e),o=t.internal.inlineTools;return Array.from(o.keys()).includes(e)?this.inlineTools[e][Hi.Shortcut]:n?.shortcut}enableShortcuts(e,t){mt.add({name:t,handler:n=>{var o;const{currentBlock:i}=this.Editor.BlockManager;i&&i.tool.enabledInlineTools&&(n.preventDefault(),(o=this.popover)==null||o.activateItemByName(e))},on:document})}toolClicked(e){var t;const n=te.range;(t=e.surround)==null||t.call(e,n),this.checkToolsState()}checkToolsState(){var e;(e=this.tools)==null||e.forEach(t=>{var n;(n=t.checkState)==null||n.call(t,te.get())})}get inlineTools(){const e={};return Array.from(this.Editor.Tools.inlineTools.entries()).forEach(([t,n])=>{e[t]=n.create()}),e}}function $i(){const r=window.getSelection();if(r===null)return[null,0];let e=r.focusNode,t=r.focusOffset;return e===null?[null,0]:(e.nodeType!==Node.TEXT_NODE&&e.childNodes.length>0&&(e.childNodes[t]?(e=e.childNodes[t],t=0):(e=e.childNodes[t-1],t=e.textContent.length)),[e,t])}function Ui(r,e,t,n){const o=document.createRange();n==="left"?(o.setStart(r,0),o.setEnd(e,t)):(o.setStart(e,t),o.setEnd(r,r.childNodes.length));const i=o.cloneContents(),s=document.createElement("div");s.appendChild(i);const a=s.textContent||"";return ka(a)}function Zt(r){const e=F.getDeepestNode(r);if(e===null||F.isEmpty(r))return!0;if(F.isNativeInput(e))return e.selectionEnd===0;if(F.isEmpty(r))return!0;const[t,n]=$i();return t===null?!1:Ui(r,t,n,"left")}function Kt(r){const e=F.getDeepestNode(r,!0);if(e===null)return!0;if(F.isNativeInput(e))return e.selectionEnd===e.value.length;const[t,n]=$i();return t===null?!1:Ui(r,t,n,"right")}var Wi={},cr={},fn={},rt={},dr={},ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.allInputsSelector=zl;function zl(){var r=["text","password","email","number","search","tel","url"];return"[contenteditable=true], textarea, input:not([type]), "+r.map(function(e){return'input[type="'.concat(e,'"]')}).join(", ")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.allInputsSelector=void 0;var e=ur;Object.defineProperty(r,"allInputsSelector",{enumerable:!0,get:function(){return e.allInputsSelector}})})(dr);var ot={},hr={};Object.defineProperty(hr,"__esModule",{value:!0});hr.isNativeInput=Hl;function Hl(r){var e=["INPUT","TEXTAREA"];return r&&r.tagName?e.includes(r.tagName):!1}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNativeInput=void 0;var e=hr;Object.defineProperty(r,"isNativeInput",{enumerable:!0,get:function(){return e.isNativeInput}})})(ot);var qi={},pr={};Object.defineProperty(pr,"__esModule",{value:!0});pr.append=$l;function $l(r,e){Array.isArray(e)?e.forEach(function(t){r.appendChild(t)}):r.appendChild(e)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.append=void 0;var e=pr;Object.defineProperty(r,"append",{enumerable:!0,get:function(){return e.append}})})(qi);var fr={},gr={};Object.defineProperty(gr,"__esModule",{value:!0});gr.blockElements=Ul;function Ul(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tbody","thead","tr","tfoot","ul","video"]}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.blockElements=void 0;var e=gr;Object.defineProperty(r,"blockElements",{enumerable:!0,get:function(){return e.blockElements}})})(fr);var Zi={},mr={};Object.defineProperty(mr,"__esModule",{value:!0});mr.calculateBaseline=Wl;function Wl(r){var e=window.getComputedStyle(r),t=parseFloat(e.fontSize),n=parseFloat(e.lineHeight)||t*1.2,o=parseFloat(e.paddingTop),i=parseFloat(e.borderTopWidth),s=parseFloat(e.marginTop),a=t*.8,l=(n-t)/2,c=s+i+o+l+a;return c}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.calculateBaseline=void 0;var e=mr;Object.defineProperty(r,"calculateBaseline",{enumerable:!0,get:function(){return e.calculateBaseline}})})(Zi);var Ki={},br={},vr={},yr={};Object.defineProperty(yr,"__esModule",{value:!0});yr.isContentEditable=ql;function ql(r){return r.contentEditable==="true"}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isContentEditable=void 0;var e=yr;Object.defineProperty(r,"isContentEditable",{enumerable:!0,get:function(){return e.isContentEditable}})})(vr);Object.defineProperty(br,"__esModule",{value:!0});br.canSetCaret=Yl;var Zl=ot,Kl=vr;function Yl(r){var e=!0;if((0,Zl.isNativeInput)(r))switch(r.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":e=!1;break}else e=(0,Kl.isContentEditable)(r);return e}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.canSetCaret=void 0;var e=br;Object.defineProperty(r,"canSetCaret",{enumerable:!0,get:function(){return e.canSetCaret}})})(Ki);var gn={},kr={};function Vl(r,e,t){const n=t.value!==void 0?"value":"get",o=t[n],i=`#${e}Cache`;if(t[n]=function(...s){return this[i]===void 0&&(this[i]=o.apply(this,s)),this[i]},n==="get"&&t.set){const s=t.set;t.set=function(a){delete r[i],s.apply(this,a)}}return t}function Yi(){const r={win:!1,mac:!1,x11:!1,linux:!1},e=Object.keys(r).find(t=>window.navigator.appVersion.toLowerCase().indexOf(t)!==-1);return e!==void 0&&(r[e]=!0),r}function wr(r){return r!=null&&r!==""&&(typeof r!="object"||Object.keys(r).length>0)}function Gl(r){return!wr(r)}const Xl=()=>typeof window<"u"&&window.navigator!==null&&wr(window.navigator.platform)&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);function Jl(r){const e=Yi();return r=r.replace(/shift/gi,"⇧").replace(/backspace/gi,"⌫").replace(/enter/gi,"⏎").replace(/up/gi,"↑").replace(/left/gi,"→").replace(/down/gi,"↓").replace(/right/gi,"←").replace(/escape/gi,"⎋").replace(/insert/gi,"Ins").replace(/delete/gi,"␡").replace(/\+/gi,"+"),e.mac?r=r.replace(/ctrl|cmd/gi,"⌘").replace(/alt/gi,"⌥"):r=r.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN"),r}function Ql(r){return r[0].toUpperCase()+r.slice(1)}function ec(r){const e=document.createElement("div");e.style.position="absolute",e.style.left="-999px",e.style.bottom="-999px",e.innerHTML=r,document.body.appendChild(e);const t=window.getSelection(),n=document.createRange();if(n.selectNode(e),t===null)throw new Error("Cannot copy text to clipboard");t.removeAllRanges(),t.addRange(n),document.execCommand("copy"),document.body.removeChild(e)}function tc(r,e,t){let n;return(...o)=>{const i=this,s=()=>{n=void 0,t!==!0&&r.apply(i,o)},a=t===!0&&n!==void 0;window.clearTimeout(n),n=window.setTimeout(s,e),a&&r.apply(i,o)}}function Ge(r){return Object.prototype.toString.call(r).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function nc(r){return Ge(r)==="boolean"}function Vi(r){return Ge(r)==="function"||Ge(r)==="asyncfunction"}function rc(r){return Vi(r)&&/^\s*class\s+/.test(r.toString())}function oc(r){return Ge(r)==="number"}function Yt(r){return Ge(r)==="object"}function ic(r){return Promise.resolve(r)===r}function sc(r){return Ge(r)==="string"}function ac(r){return Ge(r)==="undefined"}function Jn(r,...e){if(!e.length)return r;const t=e.shift();if(Yt(r)&&Yt(t))for(const n in t)Yt(t[n])?(r[n]===void 0&&Object.assign(r,{[n]:{}}),Jn(r[n],t[n])):Object.assign(r,{[n]:t[n]});return Jn(r,...e)}function lc(r,e,t){const n=`«${e}» is deprecated and will be removed in the next major release. Please use the «${t}» instead.`;r&&console.warn(n)}function cc(r){try{return new URL(r).href}catch{}return r.substring(0,2)==="//"?window.location.protocol+r:window.location.origin+r}function dc(r){return r>47&&r<58||r===32||r===13||r===229||r>64&&r<91||r>95&&r<112||r>185&&r<193||r>218&&r<223}const uc={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91,SLASH:191},hc={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4};let pc=class{constructor(){this.completed=Promise.resolve()}add(r){return new Promise((e,t)=>{this.completed=this.completed.then(r).then(e).catch(t)})}};function fc(r,e,t=void 0){let n,o,i,s=null,a=0;t||(t={});const l=function(){a=t.leading===!1?0:Date.now(),s=null,i=r.apply(n,o),s===null&&(n=o=null)};return function(){const c=Date.now();!a&&t.leading===!1&&(a=c);const f=e-(c-a);return n=this,o=arguments,f<=0||f>e?(s&&(clearTimeout(s),s=null),a=c,i=r.apply(n,o),s===null&&(n=o=null)):!s&&t.trailing!==!1&&(s=setTimeout(l,f)),i}}const gc=Object.freeze(Object.defineProperty({__proto__:null,PromiseQueue:pc,beautifyShortcut:Jl,cacheable:Vl,capitalize:Ql,copyTextToClipboard:ec,debounce:tc,deepMerge:Jn,deprecationAssert:lc,getUserOS:Yi,getValidUrl:cc,isBoolean:nc,isClass:rc,isEmpty:Gl,isFunction:Vi,isIosDevice:Xl,isNumber:oc,isObject:Yt,isPrintableKey:dc,isPromise:ic,isString:sc,isUndefined:ac,keyCodes:uc,mouseButtons:hc,notEmpty:wr,throttle:fc,typeOf:Ge},Symbol.toStringTag,{value:"Module"})),xr=sa(gc);Object.defineProperty(kr,"__esModule",{value:!0});kr.containsOnlyInlineElements=vc;var mc=xr,bc=fr;function vc(r){var e;(0,mc.isString)(r)?(e=document.createElement("div"),e.innerHTML=r):e=r;var t=function(n){return!(0,bc.blockElements)().includes(n.tagName.toLowerCase())&&Array.from(n.children).every(t)};return Array.from(e.children).every(t)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.containsOnlyInlineElements=void 0;var e=kr;Object.defineProperty(r,"containsOnlyInlineElements",{enumerable:!0,get:function(){return e.containsOnlyInlineElements}})})(gn);var Gi={},Er={},mn={},_r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.make=yc;function yc(r,e,t){var n;e===void 0&&(e=null),t===void 0&&(t={});var o=document.createElement(r);if(Array.isArray(e)){var i=e.filter(function(a){return a!==void 0});(n=o.classList).add.apply(n,i)}else e!==null&&o.classList.add(e);for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=t[s]);return o}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.make=void 0;var e=_r;Object.defineProperty(r,"make",{enumerable:!0,get:function(){return e.make}})})(mn);Object.defineProperty(Er,"__esModule",{value:!0});Er.fragmentToString=wc;var kc=mn;function wc(r){var e=(0,kc.make)("div");return e.appendChild(r),e.innerHTML}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.fragmentToString=void 0;var e=Er;Object.defineProperty(r,"fragmentToString",{enumerable:!0,get:function(){return e.fragmentToString}})})(Gi);var Xi={},Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.getContentLength=Ec;var xc=ot;function Ec(r){var e,t;return(0,xc.isNativeInput)(r)?r.value.length:r.nodeType===Node.TEXT_NODE?r.length:(t=(e=r.textContent)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContentLength=void 0;var e=Cr;Object.defineProperty(r,"getContentLength",{enumerable:!0,get:function(){return e.getContentLength}})})(Xi);var Sr={},Tr={},Xo=It&&It.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.getDeepestBlockElements=Ji;var _c=gn;function Ji(r){return(0,_c.containsOnlyInlineElements)(r)?[r]:Array.from(r.children).reduce(function(e,t){return Xo(Xo([],e,!0),Ji(t),!0)},[])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDeepestBlockElements=void 0;var e=Tr;Object.defineProperty(r,"getDeepestBlockElements",{enumerable:!0,get:function(){return e.getDeepestBlockElements}})})(Sr);var Qi={},Br={},bn={},Or={};Object.defineProperty(Or,"__esModule",{value:!0});Or.isLineBreakTag=Cc;function Cc(r){return["BR","WBR"].includes(r.tagName)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isLineBreakTag=void 0;var e=Or;Object.defineProperty(r,"isLineBreakTag",{enumerable:!0,get:function(){return e.isLineBreakTag}})})(bn);var vn={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.isSingleTag=Sc;function Sc(r){return["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(r.tagName)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isSingleTag=void 0;var e=Ir;Object.defineProperty(r,"isSingleTag",{enumerable:!0,get:function(){return e.isSingleTag}})})(vn);Object.defineProperty(Br,"__esModule",{value:!0});Br.getDeepestNode=es;var Tc=ot,Bc=bn,Oc=vn;function es(r,e){e===void 0&&(e=!1);var t=e?"lastChild":"firstChild",n=e?"previousSibling":"nextSibling";if(r.nodeType===Node.ELEMENT_NODE&&r[t]){var o=r[t];if((0,Oc.isSingleTag)(o)&&!(0,Tc.isNativeInput)(o)&&!(0,Bc.isLineBreakTag)(o))if(o[n])o=o[n];else if(o.parentNode!==null&&o.parentNode[n])o=o.parentNode[n];else return o.parentNode;return es(o,e)}return r}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDeepestNode=void 0;var e=Br;Object.defineProperty(r,"getDeepestNode",{enumerable:!0,get:function(){return e.getDeepestNode}})})(Qi);var ts={},Ar={},jt=It&&It.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(Ar,"__esModule",{value:!0});Ar.findAllInputs=Pc;var Ic=gn,Ac=Sr,Mc=dr,Lc=ot;function Pc(r){return Array.from(r.querySelectorAll((0,Mc.allInputsSelector)())).reduce(function(e,t){return(0,Lc.isNativeInput)(t)||(0,Ic.containsOnlyInlineElements)(t)?jt(jt([],e,!0),[t],!1):jt(jt([],e,!0),(0,Ac.getDeepestBlockElements)(t),!0)},[])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.findAllInputs=void 0;var e=Ar;Object.defineProperty(r,"findAllInputs",{enumerable:!0,get:function(){return e.findAllInputs}})})(ts);var ns={},Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.isCollapsedWhitespaces=Nc;function Nc(r){return!/[^\t\n\r ]/.test(r)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCollapsedWhitespaces=void 0;var e=Mr;Object.defineProperty(r,"isCollapsedWhitespaces",{enumerable:!0,get:function(){return e.isCollapsedWhitespaces}})})(ns);var Lr={},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.isElement=Dc;var Rc=xr;function Dc(r){return(0,Rc.isNumber)(r)?!1:!!r&&!!r.nodeType&&r.nodeType===Node.ELEMENT_NODE}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isElement=void 0;var e=Pr;Object.defineProperty(r,"isElement",{enumerable:!0,get:function(){return e.isElement}})})(Lr);var rs={},Nr={},Rr={},Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.isLeaf=jc;function jc(r){return r===null?!1:r.childNodes.length===0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isLeaf=void 0;var e=Dr;Object.defineProperty(r,"isLeaf",{enumerable:!0,get:function(){return e.isLeaf}})})(Rr);var jr={},Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.isNodeEmpty=Uc;var Fc=bn,zc=Lr,Hc=ot,$c=vn;function Uc(r,e){var t="";return(0,$c.isSingleTag)(r)&&!(0,Fc.isLineBreakTag)(r)?!1:((0,zc.isElement)(r)&&(0,Hc.isNativeInput)(r)?t=r.value:r.textContent!==null&&(t=r.textContent.replace("​","")),e!==void 0&&(t=t.replace(new RegExp(e,"g"),"")),t.trim().length===0)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeEmpty=void 0;var e=Fr;Object.defineProperty(r,"isNodeEmpty",{enumerable:!0,get:function(){return e.isNodeEmpty}})})(jr);Object.defineProperty(Nr,"__esModule",{value:!0});Nr.isEmpty=Zc;var Wc=Rr,qc=jr;function Zc(r,e){r.normalize();for(var t=[r];t.length>0;){var n=t.shift();if(n){if(r=n,(0,Wc.isLeaf)(r)&&!(0,qc.isNodeEmpty)(r,e))return!1;t.push.apply(t,Array.from(r.childNodes))}}return!0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isEmpty=void 0;var e=Nr;Object.defineProperty(r,"isEmpty",{enumerable:!0,get:function(){return e.isEmpty}})})(rs);var os={},zr={};Object.defineProperty(zr,"__esModule",{value:!0});zr.isFragment=Yc;var Kc=xr;function Yc(r){return(0,Kc.isNumber)(r)?!1:!!r&&!!r.nodeType&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isFragment=void 0;var e=zr;Object.defineProperty(r,"isFragment",{enumerable:!0,get:function(){return e.isFragment}})})(os);var is={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.isHTMLString=Gc;var Vc=mn;function Gc(r){var e=(0,Vc.make)("div");return e.innerHTML=r,e.childElementCount>0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isHTMLString=void 0;var e=Hr;Object.defineProperty(r,"isHTMLString",{enumerable:!0,get:function(){return e.isHTMLString}})})(is);var ss={},$r={};Object.defineProperty($r,"__esModule",{value:!0});$r.offset=Xc;function Xc(r){var e=r.getBoundingClientRect(),t=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop,o=e.top+n,i=e.left+t;return{top:o,left:i,bottom:o+e.height,right:i+e.width}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.offset=void 0;var e=$r;Object.defineProperty(r,"offset",{enumerable:!0,get:function(){return e.offset}})})(ss);var as={},Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.prepend=Jc;function Jc(r,e){Array.isArray(e)?(e=e.reverse(),e.forEach(function(t){return r.prepend(t)})):r.prepend(e)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.prepend=void 0;var e=Ur;Object.defineProperty(r,"prepend",{enumerable:!0,get:function(){return e.prepend}})})(as);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.prepend=r.offset=r.make=r.isLineBreakTag=r.isSingleTag=r.isNodeEmpty=r.isLeaf=r.isHTMLString=r.isFragment=r.isEmpty=r.isElement=r.isContentEditable=r.isCollapsedWhitespaces=r.findAllInputs=r.isNativeInput=r.allInputsSelector=r.getDeepestNode=r.getDeepestBlockElements=r.getContentLength=r.fragmentToString=r.containsOnlyInlineElements=r.canSetCaret=r.calculateBaseline=r.blockElements=r.append=void 0;var e=dr;Object.defineProperty(r,"allInputsSelector",{enumerable:!0,get:function(){return e.allInputsSelector}});var t=ot;Object.defineProperty(r,"isNativeInput",{enumerable:!0,get:function(){return t.isNativeInput}});var n=qi;Object.defineProperty(r,"append",{enumerable:!0,get:function(){return n.append}});var o=fr;Object.defineProperty(r,"blockElements",{enumerable:!0,get:function(){return o.blockElements}});var i=Zi;Object.defineProperty(r,"calculateBaseline",{enumerable:!0,get:function(){return i.calculateBaseline}});var s=Ki;Object.defineProperty(r,"canSetCaret",{enumerable:!0,get:function(){return s.canSetCaret}});var a=gn;Object.defineProperty(r,"containsOnlyInlineElements",{enumerable:!0,get:function(){return a.containsOnlyInlineElements}});var l=Gi;Object.defineProperty(r,"fragmentToString",{enumerable:!0,get:function(){return l.fragmentToString}});var c=Xi;Object.defineProperty(r,"getContentLength",{enumerable:!0,get:function(){return c.getContentLength}});var f=Sr;Object.defineProperty(r,"getDeepestBlockElements",{enumerable:!0,get:function(){return f.getDeepestBlockElements}});var h=Qi;Object.defineProperty(r,"getDeepestNode",{enumerable:!0,get:function(){return h.getDeepestNode}});var y=ts;Object.defineProperty(r,"findAllInputs",{enumerable:!0,get:function(){return y.findAllInputs}});var p=ns;Object.defineProperty(r,"isCollapsedWhitespaces",{enumerable:!0,get:function(){return p.isCollapsedWhitespaces}});var v=vr;Object.defineProperty(r,"isContentEditable",{enumerable:!0,get:function(){return v.isContentEditable}});var d=Lr;Object.defineProperty(r,"isElement",{enumerable:!0,get:function(){return d.isElement}});var m=rs;Object.defineProperty(r,"isEmpty",{enumerable:!0,get:function(){return m.isEmpty}});var b=os;Object.defineProperty(r,"isFragment",{enumerable:!0,get:function(){return b.isFragment}});var k=is;Object.defineProperty(r,"isHTMLString",{enumerable:!0,get:function(){return k.isHTMLString}});var E=Rr;Object.defineProperty(r,"isLeaf",{enumerable:!0,get:function(){return E.isLeaf}});var S=jr;Object.defineProperty(r,"isNodeEmpty",{enumerable:!0,get:function(){return S.isNodeEmpty}});var C=bn;Object.defineProperty(r,"isLineBreakTag",{enumerable:!0,get:function(){return C.isLineBreakTag}});var L=vn;Object.defineProperty(r,"isSingleTag",{enumerable:!0,get:function(){return L.isSingleTag}});var N=mn;Object.defineProperty(r,"make",{enumerable:!0,get:function(){return N.make}});var O=ss;Object.defineProperty(r,"offset",{enumerable:!0,get:function(){return O.offset}});var T=as;Object.defineProperty(r,"prepend",{enumerable:!0,get:function(){return T.prepend}})})(rt);var yn={};Object.defineProperty(yn,"__esModule",{value:!0});yn.getContenteditableSlice=ed;var Qc=rt;function ed(r,e,t,n,o){var i;o===void 0&&(o=!1);var s=document.createRange();if(n==="left"?(s.setStart(r,0),s.setEnd(e,t)):(s.setStart(e,t),s.setEnd(r,r.childNodes.length)),o===!0){var a=s.extractContents();return(0,Qc.fragmentToString)(a)}var l=s.cloneContents(),c=document.createElement("div");c.appendChild(l);var f=(i=c.textContent)!==null&&i!==void 0?i:"";return f}Object.defineProperty(fn,"__esModule",{value:!0});fn.checkContenteditableSliceForEmptiness=rd;var td=rt,nd=yn;function rd(r,e,t,n){var o=(0,nd.getContenteditableSlice)(r,e,t,n);return(0,td.isCollapsedWhitespaces)(o)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.checkContenteditableSliceForEmptiness=void 0;var e=fn;Object.defineProperty(r,"checkContenteditableSliceForEmptiness",{enumerable:!0,get:function(){return e.checkContenteditableSliceForEmptiness}})})(cr);var ls={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContenteditableSlice=void 0;var e=yn;Object.defineProperty(r,"getContenteditableSlice",{enumerable:!0,get:function(){return e.getContenteditableSlice}})})(ls);var cs={},Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.focus=id;var od=rt;function id(r,e){var t,n;if(e===void 0&&(e=!0),(0,od.isNativeInput)(r)){r.focus();var o=e?0:r.value.length;r.setSelectionRange(o,o)}else{var i=document.createRange(),s=window.getSelection();if(!s)return;var a=function(y){var p=document.createTextNode("");y.appendChild(p),i.setStart(p,0),i.setEnd(p,0)},l=function(y){return y!=null},c=r.childNodes,f=e?c[0]:c[c.length-1];if(l(f)){for(;l(f)&&f.nodeType!==Node.TEXT_NODE;)f=e?f.firstChild:f.lastChild;if(l(f)&&f.nodeType===Node.TEXT_NODE){var h=(n=(t=f.textContent)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0,o=e?0:h;i.setStart(f,o),i.setEnd(f,o)}else a(r)}else a(r);s.removeAllRanges(),s.addRange(i)}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.focus=void 0;var e=Wr;Object.defineProperty(r,"focus",{enumerable:!0,get:function(){return e.focus}})})(cs);var qr={},kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.getCaretNodeAndOffset=sd;function sd(){var r=window.getSelection();if(r===null)return[null,0];var e=r.focusNode,t=r.focusOffset;return e===null?[null,0]:(e.nodeType!==Node.TEXT_NODE&&e.childNodes.length>0&&(e.childNodes[t]!==void 0?(e=e.childNodes[t],t=0):(e=e.childNodes[t-1],e.textContent!==null&&(t=e.textContent.length))),[e,t])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCaretNodeAndOffset=void 0;var e=kn;Object.defineProperty(r,"getCaretNodeAndOffset",{enumerable:!0,get:function(){return e.getCaretNodeAndOffset}})})(qr);var ds={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.getRange=ad;function ad(){var r=window.getSelection();return r&&r.rangeCount?r.getRangeAt(0):null}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getRange=void 0;var e=wn;Object.defineProperty(r,"getRange",{enumerable:!0,get:function(){return e.getRange}})})(ds);var us={},Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.isCaretAtEndOfInput=dd;var Jo=rt,ld=qr,cd=cr;function dd(r){var e=(0,Jo.getDeepestNode)(r,!0);if(e===null)return!0;if((0,Jo.isNativeInput)(e))return e.selectionEnd===e.value.length;var t=(0,ld.getCaretNodeAndOffset)(),n=t[0],o=t[1];return n===null?!1:(0,cd.checkContenteditableSliceForEmptiness)(r,n,o,"right")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCaretAtEndOfInput=void 0;var e=Zr;Object.defineProperty(r,"isCaretAtEndOfInput",{enumerable:!0,get:function(){return e.isCaretAtEndOfInput}})})(us);var hs={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.isCaretAtStartOfInput=pd;var Ft=rt,ud=kn,hd=fn;function pd(r){var e=(0,Ft.getDeepestNode)(r);if(e===null||(0,Ft.isEmpty)(r))return!0;if((0,Ft.isNativeInput)(e))return e.selectionEnd===0;if((0,Ft.isEmpty)(r))return!0;var t=(0,ud.getCaretNodeAndOffset)(),n=t[0],o=t[1];return n===null?!1:(0,hd.checkContenteditableSliceForEmptiness)(r,n,o,"left")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCaretAtStartOfInput=void 0;var e=Kr;Object.defineProperty(r,"isCaretAtStartOfInput",{enumerable:!0,get:function(){return e.isCaretAtStartOfInput}})})(hs);var ps={},Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.save=md;var fd=rt,gd=wn;function md(){var r=(0,gd.getRange)(),e=(0,fd.make)("span");if(e.id="cursor",e.hidden=!0,!!r)return r.insertNode(e),function(){var t=window.getSelection();t&&(r.setStartAfter(e),r.setEndAfter(e),t.removeAllRanges(),t.addRange(r),setTimeout(function(){e.remove()},150))}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.save=void 0;var e=Yr;Object.defineProperty(r,"save",{enumerable:!0,get:function(){return e.save}})})(ps);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.save=r.isCaretAtStartOfInput=r.isCaretAtEndOfInput=r.getRange=r.getCaretNodeAndOffset=r.focus=r.getContenteditableSlice=r.checkContenteditableSliceForEmptiness=void 0;var e=cr;Object.defineProperty(r,"checkContenteditableSliceForEmptiness",{enumerable:!0,get:function(){return e.checkContenteditableSliceForEmptiness}});var t=ls;Object.defineProperty(r,"getContenteditableSlice",{enumerable:!0,get:function(){return t.getContenteditableSlice}});var n=cs;Object.defineProperty(r,"focus",{enumerable:!0,get:function(){return n.focus}});var o=qr;Object.defineProperty(r,"getCaretNodeAndOffset",{enumerable:!0,get:function(){return o.getCaretNodeAndOffset}});var i=ds;Object.defineProperty(r,"getRange",{enumerable:!0,get:function(){return i.getRange}});var s=us;Object.defineProperty(r,"isCaretAtEndOfInput",{enumerable:!0,get:function(){return s.isCaretAtEndOfInput}});var a=hs;Object.defineProperty(r,"isCaretAtStartOfInput",{enumerable:!0,get:function(){return a.isCaretAtStartOfInput}});var l=ps;Object.defineProperty(r,"save",{enumerable:!0,get:function(){return l.save}})})(Wi);class bd extends ae{keydown(e){switch(this.beforeKeydownProcessing(e),e.keyCode){case re.BACKSPACE:this.backspace(e);break;case re.DELETE:this.delete(e);break;case re.ENTER:this.enter(e);break;case re.DOWN:case re.RIGHT:this.arrowRightAndDown(e);break;case re.UP:case re.LEFT:this.arrowLeftAndUp(e);break;case re.TAB:this.tabPressed(e);break}e.key==="/"&&!e.ctrlKey&&!e.metaKey&&this.slashPressed(e),e.code==="Slash"&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.commandSlashPressed())}beforeKeydownProcessing(e){this.needToolbarClosing(e)&&ui(e.keyCode)&&(this.Editor.Toolbar.close(),e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||this.Editor.BlockSelection.clearSelection(e))}keyup(e){e.shiftKey||this.Editor.UI.checkEmptiness()}dragOver(e){const t=this.Editor.BlockManager.getBlockByChildNode(e.target);t.dropTarget=!0}dragLeave(e){const t=this.Editor.BlockManager.getBlockByChildNode(e.target);t.dropTarget=!1}handleCommandC(e){const{BlockSelection:t}=this.Editor;t.anyBlockSelected&&t.copySelectedBlocks(e)}handleCommandX(e){const{BlockSelection:t,BlockManager:n,Caret:o}=this.Editor;t.anyBlockSelected&&t.copySelectedBlocks(e).then(()=>{const i=n.removeSelectedBlocks(),s=n.insertDefaultBlockAtIndex(i,!0);o.setToBlock(s,o.positions.START),t.clearSelection(e)})}tabPressed(e){const{InlineToolbar:t,Caret:n}=this.Editor;t.opened||(e.shiftKey?n.navigatePrevious(!0):n.navigateNext(!0))&&e.preventDefault()}commandSlashPressed(){this.Editor.BlockSelection.selectedBlocks.length>1||this.activateBlockSettings()}slashPressed(e){this.Editor.BlockManager.currentBlock.isEmpty&&(e.preventDefault(),this.Editor.Caret.insertContentAtCaretPosition("/"),this.activateToolbox())}enter(e){const{BlockManager:t,UI:n}=this.Editor,o=t.currentBlock;if(o===void 0||o.tool.isLineBreaksEnabled||n.someToolbarOpened&&n.someFlipperButtonFocused||e.shiftKey&&!Kn)return;let i=o;o.currentInput!==void 0&&Zt(o.currentInput)&&!o.hasMedia?this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex):o.currentInput&&Kt(o.currentInput)?i=this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex+1):i=this.Editor.BlockManager.split(),this.Editor.Caret.setToBlock(i),this.Editor.Toolbar.moveAndOpen(i),e.preventDefault()}backspace(e){const{BlockManager:t,Caret:n}=this.Editor,{currentBlock:o,previousBlock:i}=t;if(!(o===void 0||!te.isCollapsed||!o.currentInput||!Zt(o.currentInput))){if(e.preventDefault(),this.Editor.Toolbar.close(),o.currentInput!==o.firstInput){n.navigatePrevious();return}if(i!==null){if(i.isEmpty){t.removeBlock(i);return}if(o.isEmpty){t.removeBlock(o);const s=t.currentBlock;n.setToBlock(s,n.positions.END);return}Zo(i,o)?this.mergeBlocks(i,o):n.setToBlock(i,n.positions.END)}}}delete(e){const{BlockManager:t,Caret:n}=this.Editor,{currentBlock:o,nextBlock:i}=t;if(!(!te.isCollapsed||!Kt(o.currentInput))){if(e.preventDefault(),this.Editor.Toolbar.close(),o.currentInput!==o.lastInput){n.navigateNext();return}if(i!==null){if(i.isEmpty){t.removeBlock(i);return}if(o.isEmpty){t.removeBlock(o),n.setToBlock(i,n.positions.START);return}Zo(o,i)?this.mergeBlocks(o,i):n.setToBlock(i,n.positions.START)}}}mergeBlocks(e,t){const{BlockManager:n,Toolbar:o}=this.Editor;e.lastInput!==void 0&&(Wi.focus(e.lastInput,!1),n.mergeBlocks(e,t).then(()=>{o.close()}))}arrowRightAndDown(e){const t=on.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===re.TAB);if(this.Editor.UI.someToolbarOpened&&t)return;this.Editor.Toolbar.close();const{currentBlock:n}=this.Editor.BlockManager,o=(n?.currentInput!==void 0?Kt(n.currentInput):void 0)||this.Editor.BlockSelection.anyBlockSelected;if(e.shiftKey&&e.keyCode===re.DOWN&&o){this.Editor.CrossBlockSelection.toggleBlockSelectedState();return}if(e.keyCode===re.DOWN||e.keyCode===re.RIGHT&&!this.isRtl?this.Editor.Caret.navigateNext():this.Editor.Caret.navigatePrevious()){e.preventDefault();return}Qt(()=>{this.Editor.BlockManager.currentBlock&&this.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(e)}arrowLeftAndUp(e){if(this.Editor.UI.someToolbarOpened){if(on.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===re.TAB))return;this.Editor.UI.closeAllToolbars()}this.Editor.Toolbar.close();const{currentBlock:t}=this.Editor.BlockManager,n=(t?.currentInput!==void 0?Zt(t.currentInput):void 0)||this.Editor.BlockSelection.anyBlockSelected;if(e.shiftKey&&e.keyCode===re.UP&&n){this.Editor.CrossBlockSelection.toggleBlockSelectedState(!1);return}if(e.keyCode===re.UP||e.keyCode===re.LEFT&&!this.isRtl?this.Editor.Caret.navigatePrevious():this.Editor.Caret.navigateNext()){e.preventDefault();return}Qt(()=>{this.Editor.BlockManager.currentBlock&&this.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(e)}needToolbarClosing(e){const t=e.keyCode===re.ENTER&&this.Editor.Toolbar.toolbox.opened,n=e.keyCode===re.ENTER&&this.Editor.BlockSettings.opened,o=e.keyCode===re.ENTER&&this.Editor.InlineToolbar.opened,i=e.keyCode===re.TAB;return!(e.shiftKey||i||t||n||o)}activateToolbox(){this.Editor.Toolbar.opened||this.Editor.Toolbar.moveAndOpen(),this.Editor.Toolbar.toolbox.open()}activateBlockSettings(){this.Editor.Toolbar.opened||this.Editor.Toolbar.moveAndOpen(),this.Editor.BlockSettings.opened||this.Editor.BlockSettings.open()}}class jn{constructor(e){this.blocks=[],this.workingArea=e}get length(){return this.blocks.length}get array(){return this.blocks}get nodes(){return hi(this.workingArea.children)}static set(e,t,n){return isNaN(Number(t))?(Reflect.set(e,t,n),!0):(e.insert(+t,n),!0)}static get(e,t){return isNaN(Number(t))?Reflect.get(e,t):e.get(+t)}push(e){this.blocks.push(e),this.insertToDOM(e)}swap(e,t){const n=this.blocks[t];F.swap(this.blocks[e].holder,n.holder),this.blocks[t]=this.blocks[e],this.blocks[e]=n}move(e,t){const n=this.blocks.splice(t,1)[0],o=e-1,i=Math.max(0,o),s=this.blocks[i];e>0?this.insertToDOM(n,"afterend",s):this.insertToDOM(n,"beforebegin",s),this.blocks.splice(e,0,n);const a=this.composeBlockEvent("move",{fromIndex:t,toIndex:e});n.call(We.MOVED,a)}insert(e,t,n=!1){if(!this.length){this.push(t);return}e>this.length&&(e=this.length),n&&(this.blocks[e].holder.remove(),this.blocks[e].call(We.REMOVED));const o=n?1:0;if(this.blocks.splice(e,o,t),e>0){const i=this.blocks[e-1];this.insertToDOM(t,"afterend",i)}else{const i=this.blocks[e+1];i?this.insertToDOM(t,"beforebegin",i):this.insertToDOM(t)}}replace(e,t){if(this.blocks[e]===void 0)throw Error("Incorrect index");this.blocks[e].holder.replaceWith(t.holder),this.blocks[e]=t}insertMany(e,t){const n=new DocumentFragment;for(const o of e)n.appendChild(o.holder);if(this.length>0){if(t>0){const o=Math.min(t-1,this.length-1);this.blocks[o].holder.after(n)}else t===0&&this.workingArea.prepend(n);this.blocks.splice(t,0,...e)}else this.blocks.push(...e),this.workingArea.appendChild(n);e.forEach(o=>o.call(We.RENDERED))}remove(e){isNaN(e)&&(e=this.length-1),this.blocks[e].holder.remove(),this.blocks[e].call(We.REMOVED),this.blocks.splice(e,1)}removeAll(){this.workingArea.innerHTML="",this.blocks.forEach(e=>e.call(We.REMOVED)),this.blocks.length=0}insertAfter(e,t){const n=this.blocks.indexOf(e);this.insert(n+1,t)}get(e){return this.blocks[e]}indexOf(e){return this.blocks.indexOf(e)}insertToDOM(e,t,n){t?n.holder.insertAdjacentElement(t,e.holder):this.workingArea.appendChild(e.holder),e.call(We.RENDERED)}composeBlockEvent(e,t){return new CustomEvent(e,{detail:t})}}const Qo="block-removed",ei="block-added",vd="block-moved",ti="block-changed";class yd{constructor(){this.completed=Promise.resolve()}add(e){return new Promise((t,n)=>{this.completed=this.completed.then(e).then(t).catch(n)})}}class kd extends ae{constructor(){super(...arguments),this._currentBlockIndex=-1,this._blocks=null}get currentBlockIndex(){return this._currentBlockIndex}set currentBlockIndex(e){this._currentBlockIndex=e}get firstBlock(){return this._blocks[0]}get lastBlock(){return this._blocks[this._blocks.length-1]}get currentBlock(){return this._blocks[this.currentBlockIndex]}set currentBlock(e){this.currentBlockIndex=this.getBlockIndex(e)}get nextBlock(){return this.currentBlockIndex===this._blocks.length-1?null:this._blocks[this.currentBlockIndex+1]}get nextContentfulBlock(){return this.blocks.slice(this.currentBlockIndex+1).find(e=>!!e.inputs.length)}get previousContentfulBlock(){return this.blocks.slice(0,this.currentBlockIndex).reverse().find(e=>!!e.inputs.length)}get previousBlock(){return this.currentBlockIndex===0?null:this._blocks[this.currentBlockIndex-1]}get blocks(){return this._blocks.array}get isEditorEmpty(){return this.blocks.every(e=>e.isEmpty)}prepare(){const e=new jn(this.Editor.UI.nodes.redactor);this._blocks=new Proxy(e,{set:jn.set,get:jn.get}),this.listeners.on(document,"copy",t=>this.Editor.BlockEvents.handleCommandC(t))}toggleReadOnly(e){e?this.disableModuleBindings():this.enableModuleBindings()}composeBlock({tool:e,data:t={},id:n=void 0,tunes:o={}}){const i=this.Editor.ReadOnly.isEnabled,s=this.Editor.Tools.blockTools.get(e),a=new qe({id:n,data:t,tool:s,api:this.Editor.API,readOnly:i,tunesData:o},this.eventsDispatcher);return i||window.requestIdleCallback(()=>{this.bindBlockEvents(a)},{timeout:2e3}),a}insert({id:e=void 0,tool:t=this.config.defaultBlock,data:n={},index:o,needToFocus:i=!0,replace:s=!1,tunes:a={}}={}){let l=o;l===void 0&&(l=this.currentBlockIndex+(s?0:1));const c=this.composeBlock({id:e,tool:t,data:n,tunes:a});return s&&this.blockDidMutated(Qo,this.getBlockByIndex(l),{index:l}),this._blocks.insert(l,c,s),this.blockDidMutated(ei,c,{index:l}),i?this.currentBlockIndex=l:l<=this.currentBlockIndex&&this.currentBlockIndex++,c}insertMany(e,t=0){this._blocks.insertMany(e,t)}async update(e,t,n){if(!t&&!n)return e;const o=await e.data,i=this.composeBlock({id:e.id,tool:e.name,data:Object.assign({},o,t??{}),tunes:n??e.tunes}),s=this.getBlockIndex(e);return this._blocks.replace(s,i),this.blockDidMutated(ti,i,{index:s}),i}replace(e,t,n){const o=this.getBlockIndex(e);return this.insert({tool:t,data:n,index:o,replace:!0})}paste(e,t,n=!1){const o=this.insert({tool:e,replace:n});try{window.requestIdleCallback(()=>{o.call(We.ON_PASTE,t)})}catch(i){ce(`${e}: onPaste callback call is failed`,"error",i)}return o}insertDefaultBlockAtIndex(e,t=!1){const n=this.composeBlock({tool:this.config.defaultBlock});return this._blocks[e]=n,this.blockDidMutated(ei,n,{index:e}),t?this.currentBlockIndex=e:e<=this.currentBlockIndex&&this.currentBlockIndex++,n}insertAtEnd(){return this.currentBlockIndex=this.blocks.length-1,this.insert()}async mergeBlocks(e,t){let n;if(e.name===t.name&&e.mergeable){const o=await t.data;if(Ae(o)){console.error("Could not merge Block. Failed to extract original Block data.");return}const[i]=nr([o],e.tool.sanitizeConfig);n=i}else if(e.mergeable&&tn(t,"export")&&tn(e,"import")){const o=await t.exportDataAsString(),i=Fe(o,e.tool.sanitizeConfig);n=Ko(i,e.tool.conversionConfig)}n!==void 0&&(await e.mergeWith(n),this.removeBlock(t),this.currentBlockIndex=this._blocks.indexOf(e))}removeBlock(e,t=!0){return new Promise(n=>{const o=this._blocks.indexOf(e);if(!this.validateIndex(o))throw new Error("Can't find a Block to remove");e.destroy(),this._blocks.remove(o),this.blockDidMutated(Qo,e,{index:o}),this.currentBlockIndex>=o&&this.currentBlockIndex--,this.blocks.length?o===0&&(this.currentBlockIndex=0):(this.unsetCurrentBlock(),t&&this.insert()),n()})}removeSelectedBlocks(){let e;for(let t=this.blocks.length-1;t>=0;t--)this.blocks[t].selected&&(this.removeBlock(this.blocks[t]),e=t);return e}removeAllBlocks(){for(let e=this.blocks.length-1;e>=0;e--)this._blocks.remove(e);this.unsetCurrentBlock(),this.insert(),this.currentBlock.firstInput.focus()}split(){const e=this.Editor.Caret.extractFragmentFromCaretPosition(),t=F.make("div");t.appendChild(e);const n={text:F.isEmpty(t)?"":t.innerHTML};return this.insert({data:n})}getBlockByIndex(e){return e===-1&&(e=this._blocks.length-1),this._blocks[e]}getBlockIndex(e){return this._blocks.indexOf(e)}getBlockById(e){return this._blocks.array.find(t=>t.id===e)}getBlock(e){F.isElement(e)||(e=e.parentNode);const t=this._blocks.nodes,n=e.closest(`.${qe.CSS.wrapper}`),o=t.indexOf(n);if(o>=0)return this._blocks[o]}setCurrentBlockByChildNode(e){F.isElement(e)||(e=e.parentNode);const t=e.closest(`.${qe.CSS.wrapper}`);if(!t)return;const n=t.closest(`.${this.Editor.UI.CSS.editorWrapper}`);if(n!=null&&n.isEqualNode(this.Editor.UI.nodes.wrapper))return this.currentBlockIndex=this._blocks.nodes.indexOf(t),this.currentBlock.updateCurrentInput(),this.currentBlock}getBlockByChildNode(e){if(!e||!(e instanceof Node))return;F.isElement(e)||(e=e.parentNode);const t=e.closest(`.${qe.CSS.wrapper}`);return this.blocks.find(n=>n.holder===t)}swap(e,t){this._blocks.swap(e,t),this.currentBlockIndex=t}move(e,t=this.currentBlockIndex){if(isNaN(e)||isNaN(t)){ce("Warning during 'move' call: incorrect indices provided.","warn");return}if(!this.validateIndex(e)||!this.validateIndex(t)){ce("Warning during 'move' call: indices cannot be lower than 0 or greater than the amount of blocks.","warn");return}this._blocks.move(e,t),this.currentBlockIndex=e,this.blockDidMutated(vd,this.currentBlock,{fromIndex:t,toIndex:e})}async convert(e,t,n){if(!await e.save())throw new Error("Could not convert Block. Failed to extract original Block data.");const o=this.Editor.Tools.blockTools.get(t);if(!o)throw new Error(`Could not convert Block. Tool «${t}» not found.`);const i=await e.exportDataAsString(),s=Fe(i,o.sanitizeConfig);let a=Ko(s,o.conversionConfig,o.settings);return n&&(a=Object.assign(a,n)),this.replace(e,o.name,a)}unsetCurrentBlock(){this.currentBlockIndex=-1}async clear(e=!1){const t=new yd;this.blocks.forEach(n=>{t.add(async()=>{await this.removeBlock(n,!1)})}),await t.completed,this.unsetCurrentBlock(),e&&this.insert(),this.Editor.UI.checkEmptiness()}async destroy(){await Promise.all(this.blocks.map(e=>e.destroy()))}bindBlockEvents(e){const{BlockEvents:t}=this.Editor;this.readOnlyMutableListeners.on(e.holder,"keydown",n=>{t.keydown(n)}),this.readOnlyMutableListeners.on(e.holder,"keyup",n=>{t.keyup(n)}),this.readOnlyMutableListeners.on(e.holder,"dragover",n=>{t.dragOver(n)}),this.readOnlyMutableListeners.on(e.holder,"dragleave",n=>{t.dragLeave(n)}),e.on("didMutated",n=>this.blockDidMutated(ti,n,{index:this.getBlockIndex(n)}))}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}enableModuleBindings(){this.readOnlyMutableListeners.on(document,"cut",e=>this.Editor.BlockEvents.handleCommandX(e)),this.blocks.forEach(e=>{this.bindBlockEvents(e)})}validateIndex(e){return!(e<0||e>=this._blocks.length)}blockDidMutated(e,t,n){const o=new CustomEvent(e,{detail:{target:new Ue(t),...n}});return this.eventsDispatcher.emit(yi,{event:o}),t}}class wd extends ae{constructor(){super(...arguments),this.anyBlockSelectedCache=null,this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1}get sanitizerConfig(){return{p:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},ol:{},ul:{},li:{},br:!0,img:{src:!0,width:!0,height:!0},a:{href:!0},b:{},i:{},u:{}}}get allBlocksSelected(){const{BlockManager:e}=this.Editor;return e.blocks.every(t=>t.selected===!0)}set allBlocksSelected(e){const{BlockManager:t}=this.Editor;t.blocks.forEach(n=>{n.selected=e}),this.clearCache()}get anyBlockSelected(){const{BlockManager:e}=this.Editor;return this.anyBlockSelectedCache===null&&(this.anyBlockSelectedCache=e.blocks.some(t=>t.selected===!0)),this.anyBlockSelectedCache}get selectedBlocks(){return this.Editor.BlockManager.blocks.filter(e=>e.selected)}prepare(){this.selection=new te,mt.add({name:"CMD+A",handler:e=>{const{BlockManager:t,ReadOnly:n}=this.Editor;if(n.isEnabled){e.preventDefault(),this.selectAllBlocks();return}t.currentBlock&&this.handleCommandA(e)},on:this.Editor.UI.nodes.redactor})}toggleReadOnly(){te.get().removeAllRanges(),this.allBlocksSelected=!1}unSelectBlockByIndex(e){const{BlockManager:t}=this.Editor;let n;isNaN(e)?n=t.currentBlock:n=t.getBlockByIndex(e),n.selected=!1,this.clearCache()}clearSelection(e,t=!1){const{BlockManager:n,Caret:o,RectangleSelection:i}=this.Editor;this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;const s=e&&e instanceof KeyboardEvent,a=s&&ui(e.keyCode);if(this.anyBlockSelected&&s&&a&&!te.isSelectionExists){const l=n.removeSelectedBlocks();n.insertDefaultBlockAtIndex(l,!0),o.setToBlock(n.currentBlock),Qt(()=>{const c=e.key;o.insertContentAtCaretPosition(c.length>1?"":c)},20)()}if(this.Editor.CrossBlockSelection.clear(e),!this.anyBlockSelected||i.isRectActivated()){this.Editor.RectangleSelection.clearSelection();return}t&&this.selection.restore(),this.allBlocksSelected=!1}copySelectedBlocks(e){e.preventDefault();const t=F.make("div");this.selectedBlocks.forEach(i=>{const s=Fe(i.holder.innerHTML,this.sanitizerConfig),a=F.make("p");a.innerHTML=s,t.appendChild(a)});const n=Array.from(t.childNodes).map(i=>i.textContent).join(`

`),o=t.innerHTML;return e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",o),Promise.all(this.selectedBlocks.map(i=>i.save())).then(i=>{try{e.clipboardData.setData(this.Editor.Paste.MIME_TYPE,JSON.stringify(i))}catch{}})}selectBlockByIndex(e){const{BlockManager:t}=this.Editor,n=t.getBlockByIndex(e);n!==void 0&&this.selectBlock(n)}selectBlock(e){this.selection.save(),te.get().removeAllRanges(),e.selected=!0,this.clearCache(),this.Editor.InlineToolbar.close()}unselectBlock(e){e.selected=!1,this.clearCache()}clearCache(){this.anyBlockSelectedCache=null}destroy(){mt.remove(this.Editor.UI.nodes.redactor,"CMD+A")}handleCommandA(e){if(this.Editor.RectangleSelection.clearSelection(),F.isNativeInput(e.target)&&!this.readyToBlockSelection){this.readyToBlockSelection=!0;return}const t=this.Editor.BlockManager.getBlock(e.target),n=t.inputs;if(n.length>1&&!this.readyToBlockSelection){this.readyToBlockSelection=!0;return}if(n.length===1&&!this.needToSelectAll){this.needToSelectAll=!0;return}this.needToSelectAll?(e.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1):this.readyToBlockSelection&&(e.preventDefault(),this.selectBlock(t),this.needToSelectAll=!0)}selectAllBlocks(){this.selection.save(),te.get().removeAllRanges(),this.allBlocksSelected=!0,this.Editor.InlineToolbar.close()}}let xd=class Qn extends ae{get positions(){return{START:"start",END:"end",DEFAULT:"default"}}static get CSS(){return{shadowCaret:"cdx-shadow-caret"}}setToBlock(e,t=this.positions.DEFAULT,n=0){var o;const{BlockManager:i,BlockSelection:s}=this.Editor;if(s.clearSelection(),!e.focusable){(o=window.getSelection())==null||o.removeAllRanges(),s.selectBlock(e),i.currentBlock=e;return}let a;switch(t){case this.positions.START:a=e.firstInput;break;case this.positions.END:a=e.lastInput;break;default:a=e.currentInput}if(!a)return;const l=F.getDeepestNode(a,t===this.positions.END),c=F.getContentLength(l);switch(!0){case t===this.positions.START:n=0;break;case t===this.positions.END:case n>c:n=c;break}this.set(l,n),i.setCurrentBlockByChildNode(e.holder),i.currentBlock.currentInput=a}setToInput(e,t=this.positions.DEFAULT,n=0){const{currentBlock:o}=this.Editor.BlockManager,i=F.getDeepestNode(e);switch(t){case this.positions.START:this.set(i,0);break;case this.positions.END:this.set(i,F.getContentLength(i));break;default:n&&this.set(i,n)}o.currentInput=e}set(e,t=0){const{top:n,bottom:o}=te.setCursor(e,t),{innerHeight:i}=window;n<0?window.scrollBy(0,n-30):o>i&&window.scrollBy(0,o-i+30)}setToTheLastBlock(){const e=this.Editor.BlockManager.lastBlock;if(e)if(e.tool.isDefault&&e.isEmpty)this.setToBlock(e);else{const t=this.Editor.BlockManager.insertAtEnd();this.setToBlock(t)}}extractFragmentFromCaretPosition(){const e=te.get();if(e.rangeCount){const t=e.getRangeAt(0),n=this.Editor.BlockManager.currentBlock.currentInput;if(t.deleteContents(),n)if(F.isNativeInput(n)){const o=n,i=document.createDocumentFragment(),s=o.value.substring(0,o.selectionStart),a=o.value.substring(o.selectionStart);return i.textContent=a,o.value=s,i}else{const o=t.cloneRange();return o.selectNodeContents(n),o.setStart(t.endContainer,t.endOffset),o.extractContents()}}}navigateNext(e=!1){const{BlockManager:t}=this.Editor,{currentBlock:n,nextBlock:o}=t;if(n===void 0)return!1;const{nextInput:i,currentInput:s}=n,a=s!==void 0?Kt(s):void 0;let l=o;const c=e||a||!n.focusable;if(i&&c)return this.setToInput(i,this.positions.START),!0;if(l===null){if(n.tool.isDefault||!c)return!1;l=t.insertAtEnd()}return c?(this.setToBlock(l,this.positions.START),!0):!1}navigatePrevious(e=!1){const{currentBlock:t,previousBlock:n}=this.Editor.BlockManager;if(!t)return!1;const{previousInput:o,currentInput:i}=t,s=i!==void 0?Zt(i):void 0,a=e||s||!t.focusable;return o&&a?(this.setToInput(o,this.positions.END),!0):n!==null&&a?(this.setToBlock(n,this.positions.END),!0):!1}createShadow(e){const t=document.createElement("span");t.classList.add(Qn.CSS.shadowCaret),e.insertAdjacentElement("beforeend",t)}restoreCaret(e){const t=e.querySelector(`.${Qn.CSS.shadowCaret}`);if(!t)return;new te().expandToTag(t);const n=document.createRange();n.selectNode(t),n.extractContents()}insertContentAtCaretPosition(e){const t=document.createDocumentFragment(),n=document.createElement("div"),o=te.get(),i=te.range;n.innerHTML=e,Array.from(n.childNodes).forEach(c=>t.appendChild(c)),t.childNodes.length===0&&t.appendChild(new Text);const s=t.lastChild;i.deleteContents(),i.insertNode(t);const a=document.createRange(),l=s.nodeType===Node.TEXT_NODE?s:s.firstChild;l!==null&&l.textContent!==null&&a.setStart(l,l.textContent.length),o.removeAllRanges(),o.addRange(a)}};class Ed extends ae{constructor(){super(...arguments),this.onMouseUp=()=>{this.listeners.off(document,"mouseover",this.onMouseOver),this.listeners.off(document,"mouseup",this.onMouseUp)},this.onMouseOver=e=>{const{BlockManager:t,BlockSelection:n}=this.Editor;if(e.relatedTarget===null&&e.target===null)return;const o=t.getBlockByChildNode(e.relatedTarget)||this.lastSelectedBlock,i=t.getBlockByChildNode(e.target);if(!(!o||!i)&&i!==o){if(o===this.firstSelectedBlock){te.get().removeAllRanges(),o.selected=!0,i.selected=!0,n.clearCache();return}if(i===this.firstSelectedBlock){o.selected=!1,i.selected=!1,n.clearCache();return}this.Editor.InlineToolbar.close(),this.toggleBlocksSelectedState(o,i),this.lastSelectedBlock=i}}}async prepare(){this.listeners.on(document,"mousedown",e=>{this.enableCrossBlockSelection(e)})}watchSelection(e){if(e.button!==la.LEFT)return;const{BlockManager:t}=this.Editor;this.firstSelectedBlock=t.getBlock(e.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(document,"mouseover",this.onMouseOver),this.listeners.on(document,"mouseup",this.onMouseUp)}get isCrossBlockSelectionStarted(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock&&this.firstSelectedBlock!==this.lastSelectedBlock}toggleBlockSelectedState(e=!0){const{BlockManager:t,BlockSelection:n}=this.Editor;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=t.currentBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,n.clearCache(),te.get().removeAllRanges());const o=t.blocks.indexOf(this.lastSelectedBlock)+(e?1:-1),i=t.blocks[o];i&&(this.lastSelectedBlock.selected!==i.selected?(i.selected=!0,n.clearCache()):(this.lastSelectedBlock.selected=!1,n.clearCache()),this.lastSelectedBlock=i,this.Editor.InlineToolbar.close(),i.holder.scrollIntoView({block:"nearest"}))}clear(e){const{BlockManager:t,BlockSelection:n,Caret:o}=this.Editor,i=t.blocks.indexOf(this.firstSelectedBlock),s=t.blocks.indexOf(this.lastSelectedBlock);if(n.anyBlockSelected&&i>-1&&s>-1&&e&&e instanceof KeyboardEvent)switch(e.keyCode){case re.DOWN:case re.RIGHT:o.setToBlock(t.blocks[Math.max(i,s)],o.positions.END);break;case re.UP:case re.LEFT:o.setToBlock(t.blocks[Math.min(i,s)],o.positions.START);break;default:o.setToBlock(t.blocks[Math.max(i,s)],o.positions.END)}this.firstSelectedBlock=this.lastSelectedBlock=null}enableCrossBlockSelection(e){const{UI:t}=this.Editor;te.isCollapsed||this.Editor.BlockSelection.clearSelection(e),t.nodes.redactor.contains(e.target)?this.watchSelection(e):this.Editor.BlockSelection.clearSelection(e)}toggleBlocksSelectedState(e,t){const{BlockManager:n,BlockSelection:o}=this.Editor,i=n.blocks.indexOf(e),s=n.blocks.indexOf(t),a=e.selected!==t.selected;for(let l=Math.min(i,s);l<=Math.max(i,s);l++){const c=n.blocks[l];c!==this.firstSelectedBlock&&c!==(a?e:t)&&(n.blocks[l].selected=!n.blocks[l].selected,o.clearCache())}}}class _d extends ae{constructor(){super(...arguments),this.isStartedAtEditor=!1}toggleReadOnly(e){e?this.disableModuleBindings():this.enableModuleBindings()}enableModuleBindings(){const{UI:e}=this.Editor;this.readOnlyMutableListeners.on(e.nodes.holder,"drop",async t=>{await this.processDrop(t)},!0),this.readOnlyMutableListeners.on(e.nodes.holder,"dragstart",()=>{this.processDragStart()}),this.readOnlyMutableListeners.on(e.nodes.holder,"dragover",t=>{this.processDragOver(t)},!0)}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}async processDrop(e){const{BlockManager:t,Paste:n,Caret:o}=this.Editor;e.preventDefault(),t.blocks.forEach(s=>{s.dropTarget=!1}),te.isAtEditor&&!te.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1;const i=t.setCurrentBlockByChildNode(e.target);if(i)this.Editor.Caret.setToBlock(i,o.positions.END);else{const s=t.setCurrentBlockByChildNode(t.lastBlock.holder);this.Editor.Caret.setToBlock(s,o.positions.END)}await n.processDataTransfer(e.dataTransfer,!0)}processDragStart(){te.isAtEditor&&!te.isCollapsed&&(this.isStartedAtEditor=!0),this.Editor.InlineToolbar.close()}processDragOver(e){e.preventDefault()}}const Cd=180,Sd=400;class Td extends ae{constructor({config:e,eventsDispatcher:t}){super({config:e,eventsDispatcher:t}),this.disabled=!1,this.batchingTimeout=null,this.batchingOnChangeQueue=new Map,this.batchTime=Sd,this.mutationObserver=new MutationObserver(n=>{this.redactorChanged(n)}),this.eventsDispatcher.on(yi,n=>{this.particularBlockChanged(n.event)}),this.eventsDispatcher.on(ki,()=>{this.disable()}),this.eventsDispatcher.on(wi,()=>{this.enable()})}enable(){this.mutationObserver.observe(this.Editor.UI.nodes.redactor,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.disabled=!1}disable(){this.mutationObserver.disconnect(),this.disabled=!0}particularBlockChanged(e){this.disabled||!pe(this.config.onChange)||(this.batchingOnChangeQueue.set(`block:${e.detail.target.id}:event:${e.type}`,e),this.batchingTimeout&&clearTimeout(this.batchingTimeout),this.batchingTimeout=setTimeout(()=>{let t;this.batchingOnChangeQueue.size===1?t=this.batchingOnChangeQueue.values().next().value:t=Array.from(this.batchingOnChangeQueue.values()),this.config.onChange&&this.config.onChange(this.Editor.API.methods,t),this.batchingOnChangeQueue.clear()},this.batchTime))}redactorChanged(e){this.eventsDispatcher.emit(Yn,{mutations:e})}}const fs=class gs extends ae{constructor(){super(...arguments),this.MIME_TYPE="application/x-editor-js",this.toolsTags={},this.tagsByTool={},this.toolsPatterns=[],this.toolsFiles={},this.exceptionList=[],this.processTool=e=>{try{const t=e.create({},{},!1);if(e.pasteConfig===!1){this.exceptionList.push(e.name);return}if(!pe(t.onPaste))return;this.getTagsConfig(e),this.getFilesConfig(e),this.getPatternsConfig(e)}catch(t){ce(`Paste handling for «${e.name}» Tool hasn't been set up because of the error`,"warn",t)}},this.handlePasteEvent=async e=>{const{BlockManager:t,Toolbar:n}=this.Editor,o=t.setCurrentBlockByChildNode(e.target);!o||this.isNativeBehaviour(e.target)&&!e.clipboardData.types.includes("Files")||o&&this.exceptionList.includes(o.name)||(e.preventDefault(),this.processDataTransfer(e.clipboardData),n.close())}}async prepare(){this.processTools()}toggleReadOnly(e){e?this.unsetCallback():this.setCallback()}async processDataTransfer(e,t=!1){const{Tools:n}=this.Editor,o=e.types;if((o.includes?o.includes("Files"):o.contains("Files"))&&!Ae(this.toolsFiles)){await this.processFiles(e.files);return}const i=e.getData(this.MIME_TYPE),s=e.getData("text/plain");let a=e.getData("text/html");if(i)try{this.insertEditorJSData(JSON.parse(i));return}catch{}t&&s.trim()&&a.trim()&&(a="<p>"+(a.trim()?a:s)+"</p>");const l=Object.keys(this.toolsTags).reduce((h,y)=>(h[y.toLowerCase()]=this.toolsTags[y].sanitizationConfig??{},h),{}),c=Object.assign({},l,n.getAllInlineToolsSanitizeConfig(),{br:{}}),f=Fe(a,c);!f.trim()||f.trim()===s||!F.isHTMLString(f)?await this.processText(s):await this.processText(f,!0)}async processText(e,t=!1){const{Caret:n,BlockManager:o}=this.Editor,i=t?this.processHTML(e):this.processPlain(e);if(!i.length)return;if(i.length===1){i[0].isBlock?this.processSingleBlock(i.pop()):this.processInlinePaste(i.pop());return}const s=o.currentBlock&&o.currentBlock.tool.isDefault&&o.currentBlock.isEmpty;i.map(async(a,l)=>this.insertBlock(a,l===0&&s)),o.currentBlock&&n.setToBlock(o.currentBlock,n.positions.END)}setCallback(){this.listeners.on(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}unsetCallback(){this.listeners.off(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}processTools(){const e=this.Editor.Tools.blockTools;Array.from(e.values()).forEach(this.processTool)}collectTagNames(e){return Ze(e)?[e]:we(e)?Object.keys(e):[]}getTagsConfig(e){if(e.pasteConfig===!1)return;const t=e.pasteConfig.tags||[],n=[];t.forEach(o=>{const i=this.collectTagNames(o);n.push(...i),i.forEach(s=>{if(Object.prototype.hasOwnProperty.call(this.toolsTags,s)){ce(`Paste handler for «${e.name}» Tool on «${s}» tag is skipped because it is already used by «${this.toolsTags[s].tool.name}» Tool.`,"warn");return}const a=we(o)?o[s]:null;this.toolsTags[s.toUpperCase()]={tool:e,sanitizationConfig:a}})}),this.tagsByTool[e.name]=n.map(o=>o.toUpperCase())}getFilesConfig(e){if(e.pasteConfig===!1)return;const{files:t={}}=e.pasteConfig;let{extensions:n,mimeTypes:o}=t;!n&&!o||(n&&!Array.isArray(n)&&(ce(`«extensions» property of the onDrop config for «${e.name}» Tool should be an array`),n=[]),o&&!Array.isArray(o)&&(ce(`«mimeTypes» property of the onDrop config for «${e.name}» Tool should be an array`),o=[]),o&&(o=o.filter(i=>pa(i)?!0:(ce(`MIME type value «${i}» for the «${e.name}» Tool is not a valid MIME type`,"warn"),!1))),this.toolsFiles[e.name]={extensions:n||[],mimeTypes:o||[]})}getPatternsConfig(e){e.pasteConfig===!1||!e.pasteConfig.patterns||Ae(e.pasteConfig.patterns)||Object.entries(e.pasteConfig.patterns).forEach(([t,n])=>{n instanceof RegExp||ce(`Pattern ${n} for «${e.name}» Tool is skipped because it should be a Regexp instance.`,"warn"),this.toolsPatterns.push({key:t,pattern:n,tool:e})})}isNativeBehaviour(e){return F.isNativeInput(e)}async processFiles(e){const{BlockManager:t}=this.Editor;let n;n=await Promise.all(Array.from(e).map(i=>this.processFile(i))),n=n.filter(i=>!!i);const o=t.currentBlock.tool.isDefault&&t.currentBlock.isEmpty;n.forEach((i,s)=>{t.paste(i.type,i.event,s===0&&o)})}async processFile(e){const t=ha(e),n=Object.entries(this.toolsFiles).find(([i,{mimeTypes:s,extensions:a}])=>{const[l,c]=e.type.split("/"),f=a.find(y=>y.toLowerCase()===t.toLowerCase()),h=s.find(y=>{const[p,v]=y.split("/");return p===l&&(v===c||v==="*")});return!!f||!!h});if(!n)return;const[o]=n;return{event:this.composePasteEvent("file",{file:e}),type:o}}processHTML(e){const{Tools:t}=this.Editor,n=F.make("DIV");return n.innerHTML=e,this.getNodes(n).map(o=>{let i,s=t.defaultTool,a=!1;switch(o.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:i=F.make("div"),i.appendChild(o);break;case Node.ELEMENT_NODE:i=o,a=!0,this.toolsTags[i.tagName]&&(s=this.toolsTags[i.tagName].tool);break}const{tags:l}=s.pasteConfig||{tags:[]},c=l.reduce((y,p)=>(this.collectTagNames(p).forEach(v=>{const d=we(p)?p[v]:null;y[v.toLowerCase()]=d||{}}),y),{}),f=Object.assign({},c,s.baseSanitizeConfig);if(i.tagName.toLowerCase()==="table"){const y=Fe(i.outerHTML,f);i=F.make("div",void 0,{innerHTML:y}).firstChild}else i.innerHTML=Fe(i.innerHTML,f);const h=this.composePasteEvent("tag",{data:i});return{content:i,isBlock:a,tool:s.name,event:h}}).filter(o=>{const i=F.isEmpty(o.content),s=F.isSingleTag(o.content);return!i||s})}processPlain(e){const{defaultBlock:t}=this.config;if(!e)return[];const n=t;return e.split(/\r?\n/).filter(o=>o.trim()).map(o=>{const i=F.make("div");i.textContent=o;const s=this.composePasteEvent("tag",{data:i});return{content:i,tool:n,isBlock:!1,event:s}})}async processSingleBlock(e){const{Caret:t,BlockManager:n}=this.Editor,{currentBlock:o}=n;if(!o||e.tool!==o.name||!F.containsOnlyInlineElements(e.content.innerHTML)){this.insertBlock(e,o?.tool.isDefault&&o.isEmpty);return}t.insertContentAtCaretPosition(e.content.innerHTML)}async processInlinePaste(e){const{BlockManager:t,Caret:n}=this.Editor,{content:o}=e;if(t.currentBlock&&t.currentBlock.tool.isDefault&&o.textContent.length<gs.PATTERN_PROCESSING_MAX_LENGTH){const i=await this.processPattern(o.textContent);if(i){const s=t.currentBlock&&t.currentBlock.tool.isDefault&&t.currentBlock.isEmpty,a=t.paste(i.tool,i.event,s);n.setToBlock(a,n.positions.END);return}}if(t.currentBlock&&t.currentBlock.currentInput){const i=t.currentBlock.tool.baseSanitizeConfig;document.execCommand("insertHTML",!1,Fe(o.innerHTML,i))}else this.insertBlock(e)}async processPattern(e){const t=this.toolsPatterns.find(n=>{const o=n.pattern.exec(e);return o?e===o.shift():!1});return t?{event:this.composePasteEvent("pattern",{key:t.key,data:e}),tool:t.tool.name}:void 0}insertBlock(e,t=!1){const{BlockManager:n,Caret:o}=this.Editor,{currentBlock:i}=n;let s;if(t&&i&&i.isEmpty){s=n.paste(e.tool,e.event,!0),o.setToBlock(s,o.positions.END);return}s=n.paste(e.tool,e.event),o.setToBlock(s,o.positions.END)}insertEditorJSData(e){const{BlockManager:t,Caret:n,Tools:o}=this.Editor;nr(e,i=>o.blockTools.get(i).sanitizeConfig).forEach(({tool:i,data:s},a)=>{let l=!1;a===0&&(l=t.currentBlock&&t.currentBlock.tool.isDefault&&t.currentBlock.isEmpty);const c=t.insert({tool:i,data:s,replace:l});n.setToBlock(c,n.positions.END)})}processElementNode(e,t,n){const o=Object.keys(this.toolsTags),i=e,{tool:s}=this.toolsTags[i.tagName]||{},a=this.tagsByTool[s?.name]||[],l=o.includes(i.tagName),c=F.blockElements.includes(i.tagName.toLowerCase()),f=Array.from(i.children).some(({tagName:y})=>o.includes(y)&&!a.includes(y)),h=Array.from(i.children).some(({tagName:y})=>F.blockElements.includes(y.toLowerCase()));if(!c&&!l&&!f)return n.appendChild(i),[...t,n];if(l&&!f||c&&!h&&!f)return[...t,n,i]}getNodes(e){const t=Array.from(e.childNodes);let n;const o=(i,s)=>{if(F.isEmpty(s)&&!F.isSingleTag(s))return i;const a=i[i.length-1];let l=new DocumentFragment;switch(a&&F.isFragment(a)&&(l=i.pop()),s.nodeType){case Node.ELEMENT_NODE:if(n=this.processElementNode(s,i,l),n)return n;break;case Node.TEXT_NODE:return l.appendChild(s),[...i,l];default:return[...i,l]}return[...i,...Array.from(s.childNodes).reduce(o,[])]};return t.reduce(o,[])}composePasteEvent(e,t){return new CustomEvent(e,{detail:t})}};fs.PATTERN_PROCESSING_MAX_LENGTH=450;let Bd=fs;class Od extends ae{constructor(){super(...arguments),this.toolsDontSupportReadOnly=[],this.readOnlyEnabled=!1}get isEnabled(){return this.readOnlyEnabled}async prepare(){const{Tools:e}=this.Editor,{blockTools:t}=e,n=[];Array.from(t.entries()).forEach(([o,i])=>{i.isReadOnlySupported||n.push(o)}),this.toolsDontSupportReadOnly=n,this.config.readOnly&&n.length>0&&this.throwCriticalError(),this.toggle(this.config.readOnly,!0)}async toggle(e=!this.readOnlyEnabled,t=!1){e&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError();const n=this.readOnlyEnabled;this.readOnlyEnabled=e;for(const i in this.Editor)this.Editor[i].toggleReadOnly&&this.Editor[i].toggleReadOnly(e);if(n===e)return this.readOnlyEnabled;if(t)return this.readOnlyEnabled;this.Editor.ModificationsObserver.disable();const o=await this.Editor.Saver.save();return await this.Editor.BlockManager.clear(),await this.Editor.Renderer.render(o.blocks),this.Editor.ModificationsObserver.enable(),this.readOnlyEnabled}throwCriticalError(){throw new bi(`To enable read-only mode all connected tools should support it. Tools ${this.toolsDontSupportReadOnly.join(", ")} don't support read-only mode.`)}}let Id=class Vt extends ae{constructor(){super(...arguments),this.isRectSelectionActivated=!1,this.SCROLL_SPEED=3,this.HEIGHT_OF_SCROLL_ZONE=40,this.BOTTOM_SCROLL_ZONE=1,this.TOP_SCROLL_ZONE=2,this.MAIN_MOUSE_BUTTON=0,this.mousedown=!1,this.isScrolling=!1,this.inScrollZone=null,this.startX=0,this.startY=0,this.mouseX=0,this.mouseY=0,this.stackOfSelected=[],this.listenerIds=[]}static get CSS(){return{overlay:"codex-editor-overlay",overlayContainer:"codex-editor-overlay__container",rect:"codex-editor-overlay__rectangle",topScrollZone:"codex-editor-overlay__scroll-zone--top",bottomScrollZone:"codex-editor-overlay__scroll-zone--bottom"}}prepare(){this.enableModuleBindings()}startSelection(e,t){const n=document.elementFromPoint(e-window.pageXOffset,t-window.pageYOffset);n.closest(`.${this.Editor.Toolbar.CSS.toolbar}`)||(this.Editor.BlockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);const o=[`.${qe.CSS.content}`,`.${this.Editor.Toolbar.CSS.toolbar}`,`.${this.Editor.InlineToolbar.CSS.inlineToolbar}`],i=n.closest("."+this.Editor.UI.CSS.editorWrapper),s=o.some(a=>!!n.closest(a));!i||s||(this.mousedown=!0,this.startX=e,this.startY=t)}endSelection(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}isRectActivated(){return this.isRectSelectionActivated}clearSelection(){this.isRectSelectionActivated=!1}enableModuleBindings(){const{container:e}=this.genHTML();this.listeners.on(e,"mousedown",t=>{this.processMouseDown(t)},!1),this.listeners.on(document.body,"mousemove",Wn(t=>{this.processMouseMove(t)},10),{passive:!0}),this.listeners.on(document.body,"mouseleave",()=>{this.processMouseLeave()}),this.listeners.on(window,"scroll",Wn(t=>{this.processScroll(t)},10),{passive:!0}),this.listeners.on(document.body,"mouseup",()=>{this.processMouseUp()},!1)}processMouseDown(e){e.button===this.MAIN_MOUSE_BUTTON&&(e.target.closest(F.allInputsSelector)!==null||this.startSelection(e.pageX,e.pageY))}processMouseMove(e){this.changingRectangle(e),this.scrollByZones(e.clientY)}processMouseLeave(){this.clearSelection(),this.endSelection()}processScroll(e){this.changingRectangle(e)}processMouseUp(){this.clearSelection(),this.endSelection()}scrollByZones(e){if(this.inScrollZone=null,e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),document.documentElement.clientHeight-e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),!this.inScrollZone){this.isScrolling=!1;return}this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0)}genHTML(){const{UI:e}=this.Editor,t=e.nodes.holder.querySelector("."+e.CSS.editorWrapper),n=F.make("div",Vt.CSS.overlay,{}),o=F.make("div",Vt.CSS.overlayContainer,{}),i=F.make("div",Vt.CSS.rect,{});return o.appendChild(i),n.appendChild(o),t.appendChild(n),this.overlayRectangle=i,{container:t,overlay:n}}scrollVertical(e){if(!(this.inScrollZone&&this.mousedown))return;const t=window.pageYOffset;window.scrollBy(0,e),this.mouseY+=window.pageYOffset-t,setTimeout(()=>{this.scrollVertical(e)},0)}changingRectangle(e){if(!this.mousedown)return;e.pageY!==void 0&&(this.mouseX=e.pageX,this.mouseY=e.pageY);const{rightPos:t,leftPos:n,index:o}=this.genInfoForMouseSelection(),i=this.startX>t&&this.mouseX>t,s=this.startX<n&&this.mouseX<n;this.rectCrossesBlocks=!(i||s),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),this.Editor.Toolbar.close(),o!==void 0&&(this.trySelectNextBlock(o),this.inverseSelection(),te.get().removeAllRanges())}shrinkRectangleToPoint(){this.overlayRectangle.style.left=`${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.top=`${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.bottom=`calc(100% - ${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.right=`calc(100% - ${this.startX-window.pageXOffset}px`}inverseSelection(){const e=this.Editor.BlockManager.getBlockByIndex(this.stackOfSelected[0]).selected;if(this.rectCrossesBlocks&&!e)for(const t of this.stackOfSelected)this.Editor.BlockSelection.selectBlockByIndex(t);if(!this.rectCrossesBlocks&&e)for(const t of this.stackOfSelected)this.Editor.BlockSelection.unSelectBlockByIndex(t)}updateRectangleSize(){this.mouseY>=this.startY?(this.overlayRectangle.style.top=`${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.bottom=`calc(100% - ${this.mouseY-window.pageYOffset}px`):(this.overlayRectangle.style.bottom=`calc(100% - ${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.top=`${this.mouseY-window.pageYOffset}px`),this.mouseX>=this.startX?(this.overlayRectangle.style.left=`${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.right=`calc(100% - ${this.mouseX-window.pageXOffset}px`):(this.overlayRectangle.style.right=`calc(100% - ${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.left=`${this.mouseX-window.pageXOffset}px`)}genInfoForMouseSelection(){const e=document.body.offsetWidth/2,t=this.mouseY-window.pageYOffset,n=document.elementFromPoint(e,t),o=this.Editor.BlockManager.getBlockByChildNode(n);let i;o!==void 0&&(i=this.Editor.BlockManager.blocks.findIndex(f=>f.holder===o.holder));const s=this.Editor.BlockManager.lastBlock.holder.querySelector("."+qe.CSS.content),a=Number.parseInt(window.getComputedStyle(s).width,10)/2,l=e-a,c=e+a;return{index:i,leftPos:l,rightPos:c}}addBlockInSelection(e){this.rectCrossesBlocks&&this.Editor.BlockSelection.selectBlockByIndex(e),this.stackOfSelected.push(e)}trySelectNextBlock(e){const t=this.stackOfSelected[this.stackOfSelected.length-1]===e,n=this.stackOfSelected.length,o=1,i=-1,s=0;if(t)return;const a=this.stackOfSelected[n-1]-this.stackOfSelected[n-2]>0;let l=s;n>1&&(l=a?o:i);const c=e>this.stackOfSelected[n-1]&&l===o,f=e<this.stackOfSelected[n-1]&&l===i,h=!(c||f||l===s);if(!h&&(e>this.stackOfSelected[n-1]||this.stackOfSelected[n-1]===void 0)){let v=this.stackOfSelected[n-1]+1||e;for(v;v<=e;v++)this.addBlockInSelection(v);return}if(!h&&e<this.stackOfSelected[n-1]){for(let v=this.stackOfSelected[n-1]-1;v>=e;v--)this.addBlockInSelection(v);return}if(!h)return;let y=n-1,p;for(e>this.stackOfSelected[n-1]?p=()=>e>this.stackOfSelected[y]:p=()=>e<this.stackOfSelected[y];p();)this.rectCrossesBlocks&&this.Editor.BlockSelection.unSelectBlockByIndex(this.stackOfSelected[y]),this.stackOfSelected.pop(),y--}};class Ad extends ae{async render(e){return new Promise(t=>{const{Tools:n,BlockManager:o}=this.Editor;if(e.length===0)o.insert();else{const i=e.map(({type:s,data:a,tunes:l,id:c})=>{n.available.has(s)===!1&&(Ie(`Tool «${s}» is not found. Check 'tools' property at the Editor.js config.`,"warn"),a=this.composeStubDataForTool(s,a,c),s=n.stubTool);let f;try{f=o.composeBlock({id:c,tool:s,data:a,tunes:l})}catch(h){ce(`Block «${s}» skipped because of plugins error`,"error",{data:a,error:h}),a=this.composeStubDataForTool(s,a,c),s=n.stubTool,f=o.composeBlock({id:c,tool:s,data:a,tunes:l})}return f});o.insertMany(i)}window.requestIdleCallback(()=>{t()},{timeout:2e3})})}composeStubDataForTool(e,t,n){const{Tools:o}=this.Editor;let i=e;if(o.unavailable.has(e)){const s=o.unavailable.get(e).toolbox;s!==void 0&&s[0].title!==void 0&&(i=s[0].title)}return{savedData:{id:n,type:e,data:t},title:i}}}class Md extends ae{async save(){const{BlockManager:e,Tools:t}=this.Editor,n=e.blocks,o=[];try{n.forEach(a=>{o.push(this.getSavedData(a))});const i=await Promise.all(o),s=await nr(i,a=>t.blockTools.get(a).sanitizeConfig);return this.makeOutput(s)}catch(i){Ie("Saving failed due to the Error %o","error",i)}}async getSavedData(e){const t=await e.save(),n=t&&await e.validate(t.data);return{...t,isValid:n}}makeOutput(e){const t=[];return e.forEach(({id:n,tool:o,data:i,tunes:s,isValid:a})=>{if(!a){ce(`Block «${o}» skipped because saved data is invalid`);return}if(o===this.Editor.Tools.stubTool){t.push(i);return}const l={id:n,type:o,data:i,...!Ae(s)&&{tunes:s}};t.push(l)}),{time:+new Date,blocks:t,version:"2.31.0-rc.7"}}}(function(){try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode(".ce-paragraph{line-height:1.6em;outline:none}.ce-block:only-of-type .ce-paragraph[data-placeholder-active]:empty:before,.ce-block:only-of-type .ce-paragraph[data-placeholder-active][data-empty=true]:before{content:attr(data-placeholder-active)}.ce-paragraph p:first-of-type{margin-top:0}.ce-paragraph p:last-of-type{margin-bottom:0}")),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Ld='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 9V7.2C8 7.08954 8.08954 7 8.2 7L12 7M16 9V7.2C16 7.08954 15.9105 7 15.8 7L12 7M12 7L12 17M12 17H10M12 17H14"/></svg>';function Pd(r){const e=document.createElement("div");e.innerHTML=r.trim();const t=document.createDocumentFragment();return t.append(...Array.from(e.childNodes)),t}/**
 * Base Paragraph Block for the Editor.js.
 * Represents a regular text block
 *
 * @author CodeX (team@codex.so)
 * @copyright CodeX 2018
 * @license The MIT License (MIT)
 */class Vr{static get DEFAULT_PLACEHOLDER(){return""}constructor({data:e,config:t,api:n,readOnly:o}){this.api=n,this.readOnly=o,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=t.placeholder?t.placeholder:Vr.DEFAULT_PLACEHOLDER,this._data=e??{},this._element=null,this._preserveBlank=t.preserveBlank??!1}onKeyUp(e){if(e.code!=="Backspace"&&e.code!=="Delete"||!this._element)return;const{textContent:t}=this._element;t===""&&(this._element.innerHTML="")}drawView(){const e=document.createElement("DIV");return e.classList.add(this._CSS.wrapper,this._CSS.block),e.contentEditable="false",e.dataset.placeholderActive=this.api.i18n.t(this._placeholder),this._data.text&&(e.innerHTML=this._data.text),this.readOnly||(e.contentEditable="true",e.addEventListener("keyup",this.onKeyUp)),e}render(){return this._element=this.drawView(),this._element}merge(e){if(!this._element)return;this._data.text+=e.text;const t=Pd(e.text);this._element.appendChild(t),this._element.normalize()}validate(e){return!(e.text.trim()===""&&!this._preserveBlank)}save(e){return{text:e.innerHTML}}onPaste(e){const t={text:e.detail.data.innerHTML};this._data=t,window.requestAnimationFrame(()=>{this._element&&(this._element.innerHTML=this._data.text||"")})}static get conversionConfig(){return{export:"text",import:"text"}}static get sanitize(){return{text:{br:!0}}}static get isReadOnlySupported(){return!0}static get pasteConfig(){return{tags:["P"]}}static get toolbox(){return{icon:Ld,title:"Text"}}}class Gr{constructor(){this.commandName="bold"}static get sanitize(){return{b:{}}}render(){return{icon:sl,name:"bold",onActivate:()=>{document.execCommand(this.commandName)},isActive:()=>document.queryCommandState(this.commandName)}}get shortcut(){return"CMD+B"}}Gr.isInline=!0;Gr.title="Bold";class Xr{constructor(){this.commandName="italic",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--italic"},this.nodes={button:null}}static get sanitize(){return{i:{}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.innerHTML=pl,this.nodes.button}surround(){document.execCommand(this.commandName)}checkState(){const e=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,e),e}get shortcut(){return"CMD+I"}}Xr.isInline=!0;Xr.title="Italic";class Jr{constructor({api:e}){this.commandLink="createLink",this.commandUnlink="unlink",this.ENTER_KEY=13,this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--link",buttonUnlink:"ce-inline-tool--unlink",input:"ce-inline-tool-input",inputShowed:"ce-inline-tool-input--showed"},this.nodes={button:null,input:null},this.inputOpened=!1,this.toolbar=e.toolbar,this.inlineToolbar=e.inlineToolbar,this.notifier=e.notifier,this.i18n=e.i18n,this.selection=new te}static get sanitize(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.innerHTML=Yo,this.nodes.button}renderActions(){return this.nodes.input=document.createElement("input"),this.nodes.input.placeholder=this.i18n.t("Add a link"),this.nodes.input.enterKeyHint="done",this.nodes.input.classList.add(this.CSS.input),this.nodes.input.addEventListener("keydown",e=>{e.keyCode===this.ENTER_KEY&&this.enterPressed(e)}),this.nodes.input}surround(e){if(e){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());const t=this.selection.findParentTag("A");if(t){this.selection.expandToTag(t),this.unlink(),this.closeActions(),this.checkState(),this.toolbar.close();return}}this.toggleActions()}checkState(){const e=this.selection.findParentTag("A");if(e){this.nodes.button.innerHTML=bl,this.nodes.button.classList.add(this.CSS.buttonUnlink),this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();const t=e.getAttribute("href");this.nodes.input.value=t!=="null"?t:"",this.selection.save()}else this.nodes.button.innerHTML=Yo,this.nodes.button.classList.remove(this.CSS.buttonUnlink),this.nodes.button.classList.remove(this.CSS.buttonActive);return!!e}clear(){this.closeActions()}get shortcut(){return"CMD+K"}toggleActions(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}openActions(e=!1){this.nodes.input.classList.add(this.CSS.inputShowed),e&&this.nodes.input.focus(),this.inputOpened=!0}closeActions(e=!0){if(this.selection.isFakeBackgroundEnabled){const t=new te;t.save(),this.selection.restore(),this.selection.removeFakeBackground(),t.restore()}this.nodes.input.classList.remove(this.CSS.inputShowed),this.nodes.input.value="",e&&this.selection.clearSaved(),this.inputOpened=!1}enterPressed(e){let t=this.nodes.input.value||"";if(!t.trim()){this.selection.restore(),this.unlink(),e.preventDefault(),this.closeActions();return}if(!this.validateURL(t)){this.notifier.show({message:"Pasted link is not valid.",style:"error"}),ce("Incorrect Link pasted","warn",t);return}t=this.prepareLink(t),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(t),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.selection.collapseToEnd(),this.inlineToolbar.close()}validateURL(e){return!/\s/.test(e)}prepareLink(e){return e=e.trim(),e=this.addProtocol(e),e}addProtocol(e){if(/^(\w+):(\/\/)?/.test(e))return e;const t=/^\/[^/\s]/.test(e),n=e.substring(0,1)==="#",o=/^\/\/[^/\s]/.test(e);return!t&&!n&&!o&&(e="http://"+e),e}insertLink(e){const t=this.selection.findParentTag("A");t&&this.selection.expandToTag(t),document.execCommand(this.commandLink,!1,e)}unlink(){document.execCommand(this.commandUnlink)}}Jr.isInline=!0;Jr.title="Link";let ms=class{constructor({api:e}){this.i18nAPI=e.i18n,this.blocksAPI=e.blocks,this.selectionAPI=e.selection,this.toolsAPI=e.tools,this.caretAPI=e.caret}async render(){const e=te.get(),t=this.blocksAPI.getBlockByElement(e.anchorNode);if(t===void 0)return[];const n=this.toolsAPI.getBlockTools(),o=await Ei(t,n);if(o.length===0)return[];const i=o.reduce((c,f)=>{var h;return(h=f.toolbox)==null||h.forEach(y=>{c.push({icon:y.icon,title:Ce.t(Be.toolNames,y.title),name:f.name,closeOnActivate:!0,onActivate:async()=>{const p=await this.blocksAPI.convert(t.id,f.name,y.data);this.caretAPI.setToBlock(p,"end")}})}),c},[]),s=await t.getActiveToolboxEntry(),a=s!==void 0?s.icon:Ii,l=!yt();return{icon:a,name:"convert-to",hint:{title:this.i18nAPI.t("Convert to")},children:{searchable:l,items:i,onOpen:()=>{l&&(this.selectionAPI.setFakeBackground(),this.selectionAPI.save())},onClose:()=>{l&&(this.selectionAPI.restore(),this.selectionAPI.removeFakeBackground())}}}}};ms.isInline=!0;let bs=class{constructor({data:e,api:t}){this.CSS={wrapper:"ce-stub",info:"ce-stub__info",title:"ce-stub__title",subtitle:"ce-stub__subtitle"},this.api=t,this.title=e.title||this.api.i18n.t("Error"),this.subtitle=this.api.i18n.t("The block can not be displayed correctly."),this.savedData=e.savedData,this.wrapper=this.make()}render(){return this.wrapper}save(){return this.savedData}make(){const e=F.make("div",this.CSS.wrapper),t=vl,n=F.make("div",this.CSS.info),o=F.make("div",this.CSS.title,{textContent:this.title}),i=F.make("div",this.CSS.subtitle,{textContent:this.subtitle});return e.innerHTML=t,n.appendChild(o),n.appendChild(i),e.appendChild(n),e}};bs.isReadOnlySupported=!0;class Nd extends lr{constructor(){super(...arguments),this.type=tt.Inline}get title(){return this.constructable[an.Title]}create(){return new this.constructable({api:this.api,config:this.settings})}get isReadOnlySupported(){return this.constructable[an.IsReadOnlySupported]??!1}}class Rd extends lr{constructor(){super(...arguments),this.type=tt.Tune}create(e,t){return new this.constructable({api:this.api,config:this.settings,block:t,data:e})}}let Re=class pt extends Map{get blockTools(){const e=Array.from(this.entries()).filter(([,t])=>t.isBlock());return new pt(e)}get inlineTools(){const e=Array.from(this.entries()).filter(([,t])=>t.isInline());return new pt(e)}get blockTunes(){const e=Array.from(this.entries()).filter(([,t])=>t.isTune());return new pt(e)}get internalTools(){const e=Array.from(this.entries()).filter(([,t])=>t.isInternal);return new pt(e)}get externalTools(){const e=Array.from(this.entries()).filter(([,t])=>!t.isInternal);return new pt(e)}};var Dd=Object.defineProperty,jd=Object.getOwnPropertyDescriptor,vs=(r,e,t,n)=>{for(var o=jd(e,t),i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=s(e,t,o)||o);return o&&Dd(e,t,o),o};class Qr extends lr{constructor(){super(...arguments),this.type=tt.Block,this.inlineTools=new Re,this.tunes=new Re}create(e,t,n){return new this.constructable({data:e,block:t,readOnly:n,api:this.api,config:this.settings})}get isReadOnlySupported(){return this.constructable[ht.IsReadOnlySupported]===!0}get isLineBreaksEnabled(){return this.constructable[ht.IsEnabledLineBreaks]}get toolbox(){const e=this.constructable[ht.Toolbox],t=this.config[qt.Toolbox];if(!Ae(e)&&t!==!1)return t?Array.isArray(e)?Array.isArray(t)?t.map((n,o)=>{const i=e[o];return i?{...i,...n}:n}):[t]:Array.isArray(t)?t:[{...e,...t}]:Array.isArray(e)?e:[e]}get conversionConfig(){return this.constructable[ht.ConversionConfig]}get enabledInlineTools(){return this.config[qt.EnabledInlineTools]||!1}get enabledBlockTunes(){return this.config[qt.EnabledBlockTunes]}get pasteConfig(){return this.constructable[ht.PasteConfig]??{}}get sanitizeConfig(){const e=super.sanitizeConfig,t=this.baseSanitizeConfig;if(Ae(e))return t;const n={};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const i=e[o];we(i)?n[o]=Object.assign({},t,i):n[o]=i}return n}get baseSanitizeConfig(){const e={};return Array.from(this.inlineTools.values()).forEach(t=>Object.assign(e,t.sanitizeConfig)),Array.from(this.tunes.values()).forEach(t=>Object.assign(e,t.sanitizeConfig)),e}}vs([vt],Qr.prototype,"sanitizeConfig");vs([vt],Qr.prototype,"baseSanitizeConfig");class Fd{constructor(e,t,n){this.api=n,this.config=e,this.editorConfig=t}get(e){const{class:t,isInternal:n=!1,...o}=this.config[e],i=this.getConstructor(t),s=t[Xn.IsTune];return new i({name:e,constructable:t,config:o,api:this.api.getMethodsForTool(e,s),isDefault:e===this.editorConfig.defaultBlock,defaultPlaceholder:this.editorConfig.placeholder,isInternal:n})}getConstructor(e){switch(!0){case e[an.IsInline]:return Nd;case e[Xn.IsTune]:return Rd;default:return Qr}}}let ys=class{constructor({api:e}){this.CSS={animation:"wobble"},this.api=e}render(){return{icon:al,title:this.api.i18n.t("Move down"),onActivate:()=>this.handleClick(),name:"move-down"}}handleClick(){const e=this.api.blocks.getCurrentBlockIndex(),t=this.api.blocks.getBlockByIndex(e+1);if(!t)throw new Error("Unable to move Block down since it is already the last");const n=t.holder,o=n.getBoundingClientRect();let i=Math.abs(window.innerHeight-n.offsetHeight);o.top<window.innerHeight&&(i=window.scrollY+n.offsetHeight),window.scrollTo(0,i),this.api.blocks.move(e+1),this.api.toolbar.toggleBlockSettings(!0)}};ys.isTune=!0;let ks=class{constructor({api:e}){this.api=e}render(){return{icon:ul,title:this.api.i18n.t("Delete"),name:"delete",confirmation:{title:this.api.i18n.t("Click to delete"),onActivate:()=>this.handleClick()}}}handleClick(){this.api.blocks.delete()}};ks.isTune=!0;let ws=class{constructor({api:e}){this.CSS={animation:"wobble"},this.api=e}render(){return{icon:dl,title:this.api.i18n.t("Move up"),onActivate:()=>this.handleClick(),name:"move-up"}}handleClick(){const e=this.api.blocks.getCurrentBlockIndex(),t=this.api.blocks.getBlockByIndex(e),n=this.api.blocks.getBlockByIndex(e-1);if(e===0||!t||!n)throw new Error("Unable to move Block up since it is already the first");const o=t.holder,i=n.holder,s=o.getBoundingClientRect(),a=i.getBoundingClientRect();let l;a.top>0?l=Math.abs(s.top)-Math.abs(a.top):l=Math.abs(s.top)+a.height,window.scrollBy(0,-1*l),this.api.blocks.move(e-1),this.api.toolbar.toggleBlockSettings(!0)}};ws.isTune=!0;var zd=Object.defineProperty,Hd=Object.getOwnPropertyDescriptor,$d=(r,e,t,n)=>{for(var o=Hd(e,t),i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=s(e,t,o)||o);return o&&zd(e,t,o),o};let xs=class extends ae{constructor(){super(...arguments),this.stubTool="stub",this.toolsAvailable=new Re,this.toolsUnavailable=new Re}get available(){return this.toolsAvailable}get unavailable(){return this.toolsUnavailable}get inlineTools(){return this.available.inlineTools}get blockTools(){return this.available.blockTools}get blockTunes(){return this.available.blockTunes}get defaultTool(){return this.blockTools.get(this.config.defaultBlock)}get internal(){return this.available.internalTools}async prepare(){if(this.validateTools(),this.config.tools=qn({},this.internalTools,this.config.tools),!Object.prototype.hasOwnProperty.call(this.config,"tools")||Object.keys(this.config.tools).length===0)throw Error("Can't start without tools");const e=this.prepareConfig();this.factory=new Fd(e,this.config,this.Editor.API);const t=this.getListOfPrepareFunctions(e);if(t.length===0)return Promise.resolve();await ua(t,n=>{this.toolPrepareMethodSuccess(n)},n=>{this.toolPrepareMethodFallback(n)}),this.prepareBlockTools()}getAllInlineToolsSanitizeConfig(){const e={};return Array.from(this.inlineTools.values()).forEach(t=>{Object.assign(e,t.sanitizeConfig)}),e}destroy(){Object.values(this.available).forEach(async e=>{pe(e.reset)&&await e.reset()})}get internalTools(){return{convertTo:{class:ms,isInternal:!0},link:{class:Jr,isInternal:!0},bold:{class:Gr,isInternal:!0},italic:{class:Xr,isInternal:!0},paragraph:{class:Vr,inlineToolbar:!0,isInternal:!0},stub:{class:bs,isInternal:!0},moveUp:{class:ws,isInternal:!0},delete:{class:ks,isInternal:!0},moveDown:{class:ys,isInternal:!0}}}toolPrepareMethodSuccess(e){const t=this.factory.get(e.toolName);if(t.isInline()){const n=["render"].filter(o=>!t.create()[o]);if(n.length){ce(`Incorrect Inline Tool: ${t.name}. Some of required methods is not implemented %o`,"warn",n),this.toolsUnavailable.set(t.name,t);return}}this.toolsAvailable.set(t.name,t)}toolPrepareMethodFallback(e){this.toolsUnavailable.set(e.toolName,this.factory.get(e.toolName))}getListOfPrepareFunctions(e){const t=[];return Object.entries(e).forEach(([n,o])=>{t.push({function:pe(o.class.prepare)?o.class.prepare:()=>{},data:{toolName:n,config:o.config}})}),t}prepareBlockTools(){Array.from(this.blockTools.values()).forEach(e=>{this.assignInlineToolsToBlockTool(e),this.assignBlockTunesToBlockTool(e)})}assignInlineToolsToBlockTool(e){if(this.config.inlineToolbar!==!1){if(e.enabledInlineTools===!0){e.inlineTools=new Re(Array.isArray(this.config.inlineToolbar)?this.config.inlineToolbar.map(t=>[t,this.inlineTools.get(t)]):Array.from(this.inlineTools.entries()));return}Array.isArray(e.enabledInlineTools)&&(e.inlineTools=new Re(["convertTo",...e.enabledInlineTools].map(t=>[t,this.inlineTools.get(t)])))}}assignBlockTunesToBlockTool(e){if(e.enabledBlockTunes!==!1){if(Array.isArray(e.enabledBlockTunes)){const t=new Re(e.enabledBlockTunes.map(n=>[n,this.blockTunes.get(n)]));e.tunes=new Re([...t,...this.blockTunes.internalTools]);return}if(Array.isArray(this.config.tunes)){const t=new Re(this.config.tunes.map(n=>[n,this.blockTunes.get(n)]));e.tunes=new Re([...t,...this.blockTunes.internalTools]);return}e.tunes=this.blockTunes.internalTools}}validateTools(){for(const e in this.config.tools)if(Object.prototype.hasOwnProperty.call(this.config.tools,e)){if(e in this.internalTools)return;const t=this.config.tools[e];if(!pe(t)&&!pe(t.class))throw Error(`Tool «${e}» must be a constructor function or an object with function in the «class» property`)}}prepareConfig(){const e={};for(const t in this.config.tools)we(this.config.tools[t])?e[t]=this.config.tools[t]:e[t]={class:this.config.tools[t]};return e}};$d([vt],xs.prototype,"getAllInlineToolsSanitizeConfig");const Ud=`:root{--selectionColor: #e1f2ff;--inlineSelectionColor: #d4ecff;--bg-light: #eff2f5;--grayText: #707684;--color-dark: #1D202B;--color-active-icon: #388AE5;--color-gray-border: rgba(201, 201, 204, .48);--content-width: 650px;--narrow-mode-right-padding: 50px;--toolbox-buttons-size: 26px;--toolbox-buttons-size--mobile: 36px;--icon-size: 20px;--icon-size--mobile: 28px;--block-padding-vertical: .4em;--color-line-gray: #EFF0F1 }.codex-editor{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.codex-editor .hide{display:none}.codex-editor__redactor [contenteditable]:empty:after{content:"\\feff"}@media (min-width: 651px){.codex-editor--narrow .codex-editor__redactor{margin-right:50px}}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .codex-editor__redactor{margin-left:50px;margin-right:0}}@media (min-width: 651px){.codex-editor--narrow .ce-toolbar__actions{right:-5px}}.codex-editor-copyable{position:absolute;height:1px;width:1px;top:-400%;opacity:.001}.codex-editor-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:999;pointer-events:none;overflow:hidden}.codex-editor-overlay__container{position:relative;pointer-events:auto;z-index:0}.codex-editor-overlay__rectangle{position:absolute;pointer-events:none;background-color:#2eaadc33;border:1px solid transparent}.codex-editor svg{max-height:100%}.codex-editor path{stroke:currentColor}.codex-editor ::-moz-selection{background-color:#d4ecff}.codex-editor ::selection{background-color:#d4ecff}.codex-editor--toolbox-opened [contentEditable=true][data-placeholder]:focus:before{opacity:0!important}.ce-scroll-locked{overflow:hidden}.ce-scroll-locked--hard{overflow:hidden;top:calc(-1 * var(--window-scroll-offset));position:fixed;width:100%}.ce-toolbar{position:absolute;left:0;right:0;top:0;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity,top;display:none}.ce-toolbar--opened{display:block}.ce-toolbar__content{max-width:650px;margin:0 auto;position:relative}.ce-toolbar__plus{color:#1d202b;cursor:pointer;width:26px;height:26px;border-radius:7px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-ms-flex-negative:0;flex-shrink:0}@media (max-width: 650px){.ce-toolbar__plus{width:36px;height:36px}}@media (hover: hover){.ce-toolbar__plus:hover{background-color:#eff2f5}}.ce-toolbar__plus--active{background-color:#eff2f5;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbar__plus-shortcut{opacity:.6;word-spacing:-2px;margin-top:5px}@media (max-width: 650px){.ce-toolbar__plus{position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;position:static}.ce-toolbar__plus--left-oriented:before{left:15px;margin-left:0}.ce-toolbar__plus--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar__actions{position:absolute;right:100%;opacity:0;display:-webkit-box;display:-ms-flexbox;display:flex;padding-right:5px}.ce-toolbar__actions--opened{opacity:1}@media (max-width: 650px){.ce-toolbar__actions{right:auto}}.ce-toolbar__settings-btn{color:#1d202b;width:26px;height:26px;border-radius:7px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;margin-left:3px;cursor:pointer;user-select:none}@media (max-width: 650px){.ce-toolbar__settings-btn{width:36px;height:36px}}@media (hover: hover){.ce-toolbar__settings-btn:hover{background-color:#eff2f5}}.ce-toolbar__settings-btn--active{background-color:#eff2f5;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@media (min-width: 651px){.ce-toolbar__settings-btn{width:24px}}.ce-toolbar__settings-btn--hidden{display:none}@media (max-width: 650px){.ce-toolbar__settings-btn{position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;position:static}.ce-toolbar__settings-btn--left-oriented:before{left:15px;margin-left:0}.ce-toolbar__settings-btn--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar__plus svg,.ce-toolbar__settings-btn svg{width:24px;height:24px}@media (min-width: 651px){.codex-editor--narrow .ce-toolbar__plus{left:5px}}@media (min-width: 651px){.codex-editor--narrow .ce-toolbox .ce-popover{right:0;left:auto;left:initial}}.ce-inline-toolbar{--y-offset: 8px;--color-background-icon-active: rgba(56, 138, 229, .1);--color-text-icon-active: #388AE5;--color-text-primary: black;position:absolute;visibility:hidden;-webkit-transition:opacity .25s ease;transition:opacity .25s ease;will-change:opacity,left,top;top:0;left:0;z-index:3;opacity:1;visibility:visible}.ce-inline-toolbar [hidden]{display:none!important}.ce-inline-toolbar__toggler-and-button-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;padding:0 6px}.ce-inline-toolbar__buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown{display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px;margin:0 6px 0 -6px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border-right:1px solid rgba(201,201,204,.48);-webkit-box-sizing:border-box;box-sizing:border-box}@media (hover: hover){.ce-inline-toolbar__dropdown:hover{background:#eff2f5}}.ce-inline-toolbar__dropdown--hidden{display:none}.ce-inline-toolbar__dropdown-content,.ce-inline-toolbar__dropdown-arrow{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown-content svg,.ce-inline-toolbar__dropdown-arrow svg{width:20px;height:20px}.ce-inline-toolbar__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}.ce-inline-tool{color:var(--color-text-primary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:0;border-radius:4px;line-height:normal;height:100%;padding:0;width:28px;background-color:transparent;cursor:pointer}@media (max-width: 650px){.ce-inline-tool{width:36px;height:36px}}@media (hover: hover){.ce-inline-tool:hover{background-color:#f8f8f8}}.ce-inline-tool svg{display:block;width:20px;height:20px}@media (max-width: 650px){.ce-inline-tool svg{width:28px;height:28px}}.ce-inline-tool--link .icon--unlink,.ce-inline-tool--unlink .icon--link{display:none}.ce-inline-tool--unlink .icon--unlink{display:inline-block;margin-bottom:-1px}.ce-inline-tool-input{background:#F8F8F8;border:1px solid rgba(226,226,229,.2);border-radius:6px;padding:4px 8px;font-size:14px;line-height:22px;outline:none;margin:0;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:none;font-weight:500;-webkit-appearance:none;font-family:inherit}@media (max-width: 650px){.ce-inline-tool-input{font-size:15px;font-weight:500}}.ce-inline-tool-input::-webkit-input-placeholder{color:#707684}.ce-inline-tool-input::-moz-placeholder{color:#707684}.ce-inline-tool-input:-ms-input-placeholder{color:#707684}.ce-inline-tool-input::-ms-input-placeholder{color:#707684}.ce-inline-tool-input::placeholder{color:#707684}.ce-inline-tool-input--showed{display:block}.ce-inline-tool--active{background:var(--color-background-icon-active);color:var(--color-text-icon-active)}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.ce-block{-webkit-animation:fade-in .3s ease;animation:fade-in .3s ease;-webkit-animation-fill-mode:none;animation-fill-mode:none;-webkit-animation-fill-mode:initial;animation-fill-mode:initial}.ce-block:first-of-type{margin-top:0}.ce-block--selected .ce-block__content{background:#e1f2ff}.ce-block--selected .ce-block__content [contenteditable]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-block--selected .ce-block__content img,.ce-block--selected .ce-block__content .ce-stub{opacity:.55}.ce-block--stretched .ce-block__content{max-width:none}.ce-block__content{position:relative;max-width:650px;margin:0 auto;-webkit-transition:background-color .15s ease;transition:background-color .15s ease}.ce-block--drop-target .ce-block__content:before{content:"";position:absolute;top:100%;left:-20px;margin-top:-1px;height:8px;width:8px;border:solid #388AE5;border-width:1px 1px 0 0;-webkit-transform-origin:right;transform-origin:right;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ce-block--drop-target .ce-block__content:after{content:"";position:absolute;top:100%;height:1px;width:100%;color:#388ae5;background:repeating-linear-gradient(90deg,#388AE5,#388AE5 1px,#fff 1px,#fff 6px)}.ce-block a{cursor:pointer;-webkit-text-decoration:underline;text-decoration:underline}.ce-block b{font-weight:700}.ce-block i{font-style:italic}@-webkit-keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@-webkit-keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@-webkit-keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}.cdx-block{padding:.4em 0}.cdx-block::-webkit-input-placeholder{line-height:normal!important}.cdx-input{border:1px solid rgba(201,201,204,.48);-webkit-box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);box-shadow:inset 0 1px 2px #232c480f;border-radius:3px;padding:10px 12px;outline:none;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.cdx-input[data-placeholder]:before{position:static!important}.cdx-input[data-placeholder]:before{display:inline-block;width:0;white-space:nowrap;pointer-events:none}.cdx-settings-button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:inherit;margin:0;min-width:26px;min-height:26px}.cdx-settings-button--focused{background:rgba(34,186,255,.08)!important}.cdx-settings-button--focused{-webkit-box-shadow:inset 0 0 0px 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px #07a1e314}.cdx-settings-button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.cdx-settings-button--active{color:#388ae5}.cdx-settings-button svg{width:auto;height:auto}@media (max-width: 650px){.cdx-settings-button svg{width:28px;height:28px}}@media (max-width: 650px){.cdx-settings-button{width:36px;height:36px;border-radius:8px}}@media (hover: hover){.cdx-settings-button:hover{background-color:#eff2f5}}.cdx-loader{position:relative;border:1px solid rgba(201,201,204,.48)}.cdx-loader:before{content:"";position:absolute;left:50%;top:50%;width:18px;height:18px;margin:-11px 0 0 -11px;border:2px solid rgba(201,201,204,.48);border-left-color:#388ae5;border-radius:50%;-webkit-animation:cdxRotation 1.2s infinite linear;animation:cdxRotation 1.2s infinite linear}@-webkit-keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.cdx-button{padding:13px;border-radius:3px;border:1px solid rgba(201,201,204,.48);font-size:14.9px;background:#fff;-webkit-box-shadow:0 2px 2px 0 rgba(18,30,57,.04);box-shadow:0 2px 2px #121e390a;color:#707684;text-align:center;cursor:pointer}@media (hover: hover){.cdx-button:hover{background:#FBFCFE;-webkit-box-shadow:0 1px 3px 0 rgba(18,30,57,.08);box-shadow:0 1px 3px #121e3914}}.cdx-button svg{height:20px;margin-right:.2em;margin-top:-2px}.ce-stub{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:12px 18px;margin:10px 0;border-radius:10px;background:#eff2f5;border:1px solid #EFF0F1;color:#707684;font-size:14px}.ce-stub svg{width:20px;height:20px}.ce-stub__info{margin-left:14px}.ce-stub__title{font-weight:500;text-transform:capitalize}.codex-editor.codex-editor--rtl{direction:rtl}.codex-editor.codex-editor--rtl .cdx-list{padding-left:0;padding-right:40px}.codex-editor.codex-editor--rtl .ce-toolbar__plus{right:-26px;left:auto}.codex-editor.codex-editor--rtl .ce-toolbar__actions{right:auto;left:-26px}@media (max-width: 650px){.codex-editor.codex-editor--rtl .ce-toolbar__actions{margin-left:0;margin-right:auto;padding-right:0;padding-left:10px}}.codex-editor.codex-editor--rtl .ce-settings{left:5px;right:auto}.codex-editor.codex-editor--rtl .ce-settings:before{right:auto;left:25px}.codex-editor.codex-editor--rtl .ce-settings__button:not(:nth-child(3n+3)){margin-left:3px;margin-right:0}.codex-editor.codex-editor--rtl .ce-conversion-tool__icon{margin-right:0;margin-left:10px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown{border-right:0px solid transparent;border-left:1px solid rgba(201,201,204,.48);margin:0 -6px 0 6px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:0;margin-right:4px}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__plus{left:0;right:5px}}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__actions{left:-5px}}.cdx-search-field{--icon-margin-right: 10px;background:#F8F8F8;border:1px solid rgba(226,226,229,.2);border-radius:6px;padding:2px;display:grid;grid-template-columns:auto auto 1fr;grid-template-rows:auto}.cdx-search-field__icon{width:26px;height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:var(--icon-margin-right)}.cdx-search-field__icon svg{width:20px;height:20px;color:#707684}.cdx-search-field__input{font-size:14px;outline:none;font-weight:500;font-family:inherit;border:0;background:transparent;margin:0;padding:0;line-height:22px;min-width:calc(100% - 26px - var(--icon-margin-right))}.cdx-search-field__input::-webkit-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::-moz-placeholder{color:#707684;font-weight:500}.cdx-search-field__input:-ms-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::-ms-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::placeholder{color:#707684;font-weight:500}.ce-popover{--border-radius: 6px;--width: 200px;--max-height: 270px;--padding: 6px;--offset-from-target: 8px;--color-border: #EFF0F1;--color-shadow: rgba(13, 20, 33, .1);--color-background: white;--color-text-primary: black;--color-text-secondary: #707684;--color-border-icon: rgba(201, 201, 204, .48);--color-border-icon-disabled: #EFF0F1;--color-text-icon-active: #388AE5;--color-background-icon-active: rgba(56, 138, 229, .1);--color-background-item-focus: rgba(34, 186, 255, .08);--color-shadow-item-focus: rgba(7, 161, 227, .08);--color-background-item-hover: #F8F8F8;--color-background-item-confirm: #E24A4A;--color-background-item-confirm-hover: #CE4343;--popover-top: calc(100% + var(--offset-from-target));--popover-left: 0;--nested-popover-overlap: 4px;--icon-size: 20px;--item-padding: 3px;--item-height: calc(var(--icon-size) + 2 * var(--item-padding))}.ce-popover__container{min-width:var(--width);width:var(--width);max-height:var(--max-height);border-radius:var(--border-radius);overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0px 3px 15px -3px var(--color-shadow);box-shadow:0 3px 15px -3px var(--color-shadow);position:absolute;left:var(--popover-left);top:var(--popover-top);background:var(--color-background);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;z-index:4;opacity:0;max-height:0;pointer-events:none;padding:0;border:none}.ce-popover--opened>.ce-popover__container{opacity:1;padding:var(--padding);max-height:var(--max-height);pointer-events:auto;-webkit-animation:panelShowing .1s ease;animation:panelShowing .1s ease;border:1px solid var(--color-border)}@media (max-width: 650px){.ce-popover--opened>.ce-popover__container{-webkit-animation:panelShowingMobile .25s ease;animation:panelShowingMobile .25s ease}}.ce-popover--open-top .ce-popover__container{--popover-top: calc(-1 * (var(--offset-from-target) + var(--popover-height)))}.ce-popover--open-left .ce-popover__container{--popover-left: calc(-1 * var(--width) + 100%)}.ce-popover__items{overflow-y:auto;-ms-scroll-chaining:none;overscroll-behavior:contain}@media (max-width: 650px){.ce-popover__overlay{position:fixed;top:0;bottom:0;left:0;right:0;background:#1D202B;z-index:3;opacity:.5;-webkit-transition:opacity .12s ease-in;transition:opacity .12s ease-in;will-change:opacity;visibility:visible}}.ce-popover__overlay--hidden{display:none}@media (max-width: 650px){.ce-popover .ce-popover__container{--offset: 5px;position:fixed;max-width:none;min-width:calc(100% - var(--offset) * 2);left:var(--offset);right:var(--offset);bottom:calc(var(--offset) + env(safe-area-inset-bottom));top:auto;border-radius:10px}}.ce-popover__search{margin-bottom:5px}.ce-popover__nothing-found-message{color:#707684;display:none;cursor:default;padding:3px;font-size:14px;line-height:20px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ce-popover__nothing-found-message--displayed{display:block}.ce-popover--nested .ce-popover__container{--popover-left: calc(var(--nesting-level) * (var(--width) - var(--nested-popover-overlap)));top:calc(var(--trigger-item-top) - var(--nested-popover-overlap));position:absolute}.ce-popover--open-top.ce-popover--nested .ce-popover__container{top:calc(var(--trigger-item-top) - var(--popover-height) + var(--item-height) + var(--offset-from-target) + var(--nested-popover-overlap))}.ce-popover--open-left .ce-popover--nested .ce-popover__container{--popover-left: calc(-1 * (var(--nesting-level) + 1) * var(--width) + 100%)}.ce-popover-item-separator{padding:4px 3px}.ce-popover-item-separator--hidden{display:none}.ce-popover-item-separator__line{height:1px;background:var(--color-border);width:100%}.ce-popover-item-html--hidden{display:none}.ce-popover-item{--border-radius: 6px;border-radius:var(--border-radius);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:var(--item-padding);color:var(--color-text-primary);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none;background:transparent}@media (max-width: 650px){.ce-popover-item{padding:4px}}.ce-popover-item:not(:last-of-type){margin-bottom:1px}.ce-popover-item__icon{width:26px;height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.ce-popover-item__icon svg{width:20px;height:20px}@media (max-width: 650px){.ce-popover-item__icon{width:36px;height:36px;border-radius:8px}.ce-popover-item__icon svg{width:28px;height:28px}}.ce-popover-item__icon--tool{margin-right:4px}.ce-popover-item__title{font-size:14px;line-height:20px;font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-right:auto}@media (max-width: 650px){.ce-popover-item__title{font-size:16px}}.ce-popover-item__secondary-title{color:var(--color-text-secondary);font-size:12px;white-space:nowrap;letter-spacing:-.1em;padding-right:5px;opacity:.6}@media (max-width: 650px){.ce-popover-item__secondary-title{display:none}}.ce-popover-item--active{background:var(--color-background-icon-active);color:var(--color-text-icon-active)}.ce-popover-item--disabled{color:var(--color-text-secondary);cursor:default;pointer-events:none}.ce-popover-item--focused:not(.ce-popover-item--no-focus){background:var(--color-background-item-focus)!important}.ce-popover-item--hidden{display:none}@media (hover: hover){.ce-popover-item:hover{cursor:pointer}.ce-popover-item:hover:not(.ce-popover-item--no-hover){background-color:var(--color-background-item-hover)}}.ce-popover-item--confirmation{background:var(--color-background-item-confirm)}.ce-popover-item--confirmation .ce-popover-item__title,.ce-popover-item--confirmation .ce-popover-item__icon{color:#fff}@media (hover: hover){.ce-popover-item--confirmation:not(.ce-popover-item--no-hover):hover{background:var(--color-background-item-confirm-hover)}}.ce-popover-item--confirmation:not(.ce-popover-item--no-focus).ce-popover-item--focused{background:var(--color-background-item-confirm-hover)!important}@-webkit-keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes panelShowingMobile{0%{opacity:0;-webkit-transform:translateY(14px) scale(.98);transform:translateY(14px) scale(.98)}70%{opacity:1;-webkit-transform:translateY(-4px);transform:translateY(-4px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowingMobile{0%{opacity:0;-webkit-transform:translateY(14px) scale(.98);transform:translateY(14px) scale(.98)}70%{opacity:1;-webkit-transform:translateY(-4px);transform:translateY(-4px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.wobble{-webkit-animation-name:wobble;animation-name:wobble;-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes wobble{0%{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-9%,0,0);transform:translate3d(-9%,0,0)}30%{-webkit-transform:translate3d(9%,0,0);transform:translate3d(9%,0,0)}45%{-webkit-transform:translate3d(-4%,0,0);transform:translate3d(-4%,0,0)}60%{-webkit-transform:translate3d(4%,0,0);transform:translate3d(4%,0,0)}75%{-webkit-transform:translate3d(-1%,0,0);transform:translate3d(-1%,0,0)}to{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}}@keyframes wobble{0%{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-9%,0,0);transform:translate3d(-9%,0,0)}30%{-webkit-transform:translate3d(9%,0,0);transform:translate3d(9%,0,0)}45%{-webkit-transform:translate3d(-4%,0,0);transform:translate3d(-4%,0,0)}60%{-webkit-transform:translate3d(4%,0,0);transform:translate3d(4%,0,0)}75%{-webkit-transform:translate3d(-1%,0,0);transform:translate3d(-1%,0,0)}to{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}}.ce-popover-header{margin-bottom:8px;margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ce-popover-header__text{font-size:18px;font-weight:600}.ce-popover-header__back-button{border:0;background:transparent;width:36px;height:36px;color:var(--color-text-primary)}.ce-popover-header__back-button svg{display:block;width:28px;height:28px}.ce-popover--inline{--height: 38px;--height-mobile: 46px;--container-padding: 4px;position:relative}.ce-popover--inline .ce-popover__custom-content{margin-bottom:0}.ce-popover--inline .ce-popover__items{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-popover--inline .ce-popover__container{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;padding:var(--container-padding);height:var(--height);top:0;min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;width:-webkit-max-content;width:-moz-max-content;width:max-content;-webkit-animation:none;animation:none}@media (max-width: 650px){.ce-popover--inline .ce-popover__container{height:var(--height-mobile);position:absolute}}.ce-popover--inline .ce-popover-item-separator{padding:0 4px}.ce-popover--inline .ce-popover-item-separator__line{height:100%;width:1px}.ce-popover--inline .ce-popover-item{border-radius:4px;padding:4px}.ce-popover--inline .ce-popover-item__icon--tool{-webkit-box-shadow:none;box-shadow:none;background:transparent;margin-right:0}.ce-popover--inline .ce-popover-item__icon{width:auto;width:initial;height:auto;height:initial}.ce-popover--inline .ce-popover-item__icon svg{width:20px;height:20px}@media (max-width: 650px){.ce-popover--inline .ce-popover-item__icon svg{width:28px;height:28px}}.ce-popover--inline .ce-popover-item:not(:last-of-type){margin-bottom:0;margin-bottom:initial}.ce-popover--inline .ce-popover-item-html{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ce-popover--inline .ce-popover-item__icon--chevron-right{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.ce-popover--inline .ce-popover--nested-level-1 .ce-popover__container{--offset: 3px;left:0;top:calc(var(--height) + var(--offset))}@media (max-width: 650px){.ce-popover--inline .ce-popover--nested-level-1 .ce-popover__container{top:calc(var(--height-mobile) + var(--offset))}}.ce-popover--inline .ce-popover--nested .ce-popover__container{min-width:var(--width);width:var(--width);height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:6px;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.ce-popover--inline .ce-popover--nested .ce-popover__items{display:block;width:100%}.ce-popover--inline .ce-popover--nested .ce-popover-item{border-radius:6px;padding:3px}@media (max-width: 650px){.ce-popover--inline .ce-popover--nested .ce-popover-item{padding:4px}}.ce-popover--inline .ce-popover--nested .ce-popover-item__icon--tool{margin-right:4px}.ce-popover--inline .ce-popover--nested .ce-popover-item__icon{width:26px;height:26px}.ce-popover--inline .ce-popover--nested .ce-popover-item-separator{padding:4px 3px}.ce-popover--inline .ce-popover--nested .ce-popover-item-separator__line{width:100%;height:1px}.codex-editor [data-placeholder]:empty:before,.codex-editor [data-placeholder][data-empty=true]:before{pointer-events:none;color:#707684;cursor:text;content:attr(data-placeholder)}.codex-editor [data-placeholder-active]:empty:before,.codex-editor [data-placeholder-active][data-empty=true]:before{pointer-events:none;color:#707684;cursor:text}.codex-editor [data-placeholder-active]:empty:focus:before,.codex-editor [data-placeholder-active][data-empty=true]:focus:before{content:attr(data-placeholder-active)}
`;class Wd extends ae{constructor(){super(...arguments),this.isMobile=!1,this.contentRectCache=null,this.resizeDebouncer=qo(()=>{this.windowResize()},200),this.selectionChangeDebounced=qo(()=>{this.selectionChanged()},Cd),this.documentTouchedListener=e=>{this.documentTouched(e)}}get CSS(){return{editorWrapper:"codex-editor",editorWrapperNarrow:"codex-editor--narrow",editorZone:"codex-editor__redactor",editorZoneHidden:"codex-editor__redactor--hidden",editorEmpty:"codex-editor--empty",editorRtlFix:"codex-editor--rtl"}}get contentRect(){if(this.contentRectCache!==null)return this.contentRectCache;const e=this.nodes.wrapper.querySelector(`.${qe.CSS.content}`);return e?(this.contentRectCache=e.getBoundingClientRect(),this.contentRectCache):{width:650,left:0,right:0}}async prepare(){this.setIsMobile(),this.make(),this.loadStyles()}toggleReadOnly(e){e?this.unbindReadOnlySensitiveListeners():window.requestIdleCallback(()=>{this.bindReadOnlySensitiveListeners()},{timeout:2e3})}checkEmptiness(){const{BlockManager:e}=this.Editor;this.nodes.wrapper.classList.toggle(this.CSS.editorEmpty,e.isEditorEmpty)}get someToolbarOpened(){const{Toolbar:e,BlockSettings:t,InlineToolbar:n}=this.Editor;return!!(t.opened||n.opened||e.toolbox.opened)}get someFlipperButtonFocused(){return this.Editor.Toolbar.toolbox.hasFocus()?!0:Object.entries(this.Editor).filter(([e,t])=>t.flipper instanceof on).some(([e,t])=>t.flipper.hasFocus())}destroy(){this.nodes.holder.innerHTML="",this.unbindReadOnlyInsensitiveListeners()}closeAllToolbars(){const{Toolbar:e,BlockSettings:t,InlineToolbar:n}=this.Editor;t.close(),n.close(),e.toolbox.close()}setIsMobile(){const e=window.innerWidth<pi;e!==this.isMobile&&this.eventsDispatcher.emit(At,{isEnabled:this.isMobile}),this.isMobile=e}make(){this.nodes.holder=F.getHolder(this.config.holder),this.nodes.wrapper=F.make("div",[this.CSS.editorWrapper,...this.isRtl?[this.CSS.editorRtlFix]:[]]),this.nodes.redactor=F.make("div",this.CSS.editorZone),this.nodes.holder.offsetWidth<this.contentRect.width&&this.nodes.wrapper.classList.add(this.CSS.editorWrapperNarrow),this.nodes.redactor.style.paddingBottom=this.config.minHeight+"px",this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper),this.bindReadOnlyInsensitiveListeners()}loadStyles(){const e="editor-js-styles";if(F.get(e))return;const t=F.make("style",null,{id:e,textContent:Ud.toString()});this.config.style&&!Ae(this.config.style)&&this.config.style.nonce&&t.setAttribute("nonce",this.config.style.nonce),F.prepend(document.head,t)}bindReadOnlyInsensitiveListeners(){this.listeners.on(document,"selectionchange",this.selectionChangeDebounced),this.listeners.on(window,"resize",this.resizeDebouncer,{passive:!0}),this.listeners.on(this.nodes.redactor,"mousedown",this.documentTouchedListener,{capture:!0,passive:!0}),this.listeners.on(this.nodes.redactor,"touchstart",this.documentTouchedListener,{capture:!0,passive:!0})}unbindReadOnlyInsensitiveListeners(){this.listeners.off(document,"selectionchange",this.selectionChangeDebounced),this.listeners.off(window,"resize",this.resizeDebouncer),this.listeners.off(this.nodes.redactor,"mousedown",this.documentTouchedListener),this.listeners.off(this.nodes.redactor,"touchstart",this.documentTouchedListener)}bindReadOnlySensitiveListeners(){this.readOnlyMutableListeners.on(this.nodes.redactor,"click",e=>{this.redactorClicked(e)},!1),this.readOnlyMutableListeners.on(document,"keydown",e=>{this.documentKeydown(e)},!0),this.readOnlyMutableListeners.on(document,"mousedown",e=>{this.documentClicked(e)},!0),this.watchBlockHoveredEvents(),this.enableInputsEmptyMark()}watchBlockHoveredEvents(){let e;this.readOnlyMutableListeners.on(this.nodes.redactor,"mousemove",Wn(t=>{const n=t.target.closest(".ce-block");this.Editor.BlockSelection.anyBlockSelected||n&&e!==n&&(e=n,this.eventsDispatcher.emit(zi,{block:this.Editor.BlockManager.getBlockByChildNode(n)}))},20),{passive:!0})}unbindReadOnlySensitiveListeners(){this.readOnlyMutableListeners.clearAll()}windowResize(){this.contentRectCache=null,this.setIsMobile()}documentKeydown(e){switch(e.keyCode){case re.ENTER:this.enterPressed(e);break;case re.BACKSPACE:case re.DELETE:this.backspacePressed(e);break;case re.ESC:this.escapePressed(e);break;default:this.defaultBehaviour(e);break}}defaultBehaviour(e){const{currentBlock:t}=this.Editor.BlockManager,n=e.target.closest(`.${this.CSS.editorWrapper}`),o=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;if(t!==void 0&&n===null){this.Editor.BlockEvents.keydown(e);return}n||t&&o||(this.Editor.BlockManager.unsetCurrentBlock(),this.Editor.Toolbar.close())}backspacePressed(e){const{BlockManager:t,BlockSelection:n,Caret:o}=this.Editor;if(n.anyBlockSelected&&!te.isSelectionExists){const i=t.removeSelectedBlocks(),s=t.insertDefaultBlockAtIndex(i,!0);o.setToBlock(s,o.positions.START),n.clearSelection(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}}escapePressed(e){this.Editor.BlockSelection.clearSelection(e),this.Editor.Toolbar.toolbox.opened?(this.Editor.Toolbar.toolbox.close(),this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END)):this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.InlineToolbar.opened?this.Editor.InlineToolbar.close():this.Editor.Toolbar.close()}enterPressed(e){const{BlockManager:t,BlockSelection:n}=this.Editor;if(this.someToolbarOpened)return;const o=t.currentBlockIndex>=0;if(n.anyBlockSelected&&!te.isSelectionExists){n.clearSelection(e),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();return}if(!this.someToolbarOpened&&o&&e.target.tagName==="BODY"){const i=this.Editor.BlockManager.insert();e.preventDefault(),this.Editor.Caret.setToBlock(i),this.Editor.Toolbar.moveAndOpen(i)}this.Editor.BlockSelection.clearSelection(e)}documentClicked(e){var t,n;if(!e.isTrusted)return;const o=e.target;this.nodes.holder.contains(o)||te.isAtEditor||(this.Editor.BlockManager.unsetCurrentBlock(),this.Editor.Toolbar.close());const i=(t=this.Editor.BlockSettings.nodes.wrapper)==null?void 0:t.contains(o),s=(n=this.Editor.Toolbar.nodes.settingsToggler)==null?void 0:n.contains(o),a=i||s;if(this.Editor.BlockSettings.opened&&!a){this.Editor.BlockSettings.close();const l=this.Editor.BlockManager.getBlockByChildNode(o);this.Editor.Toolbar.moveAndOpen(l)}this.Editor.BlockSelection.clearSelection(e)}documentTouched(e){let t=e.target;if(t===this.nodes.redactor){const n=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,o=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;t=document.elementFromPoint(n,o)}try{this.Editor.BlockManager.setCurrentBlockByChildNode(t)}catch{this.Editor.RectangleSelection.isRectActivated()||this.Editor.Caret.setToTheLastBlock()}this.Editor.ReadOnly.isEnabled||this.Editor.Toolbar.moveAndOpen()}redactorClicked(e){if(!te.isCollapsed)return;const t=e.target,n=e.metaKey||e.ctrlKey;if(F.isAnchor(t)&&n){e.stopImmediatePropagation(),e.stopPropagation();const o=t.getAttribute("href"),i=ga(o);ba(i);return}this.processBottomZoneClick(e)}processBottomZoneClick(e){const t=this.Editor.BlockManager.getBlockByIndex(-1),n=F.offset(t.holder).bottom,o=e.pageY,{BlockSelection:i}=this.Editor;if(e.target instanceof Element&&e.target.isEqualNode(this.nodes.redactor)&&!i.anyBlockSelected&&n<o){e.stopImmediatePropagation(),e.stopPropagation();const{BlockManager:s,Caret:a,Toolbar:l}=this.Editor;(!s.lastBlock.tool.isDefault||!s.lastBlock.isEmpty)&&s.insertAtEnd(),a.setToTheLastBlock(),l.moveAndOpen(s.lastBlock)}}selectionChanged(){const{CrossBlockSelection:e,BlockSelection:t}=this.Editor,n=te.anchorElement;if(e.isCrossBlockSelectionStarted&&t.anyBlockSelected&&te.get().removeAllRanges(),!n){te.range||this.Editor.InlineToolbar.close();return}const o=n.closest(`.${qe.CSS.content}`);(o===null||o.closest(`.${te.CSS.editorWrapper}`)!==this.nodes.wrapper)&&(this.Editor.InlineToolbar.containsNode(n)||this.Editor.InlineToolbar.close(),n.dataset.inlineToolbar!=="true")||(this.Editor.BlockManager.currentBlock||this.Editor.BlockManager.setCurrentBlockByChildNode(n),this.Editor.InlineToolbar.tryToShow(!0))}enableInputsEmptyMark(){function e(t){const n=t.target;fi(n)}this.readOnlyMutableListeners.on(this.nodes.wrapper,"input",e),this.readOnlyMutableListeners.on(this.nodes.wrapper,"focusin",e),this.readOnlyMutableListeners.on(this.nodes.wrapper,"focusout",e)}}const qd={BlocksAPI:Ba,CaretAPI:Ia,EventsAPI:Aa,I18nAPI:Ma,API:La,InlineToolbarAPI:Pa,ListenersAPI:Na,NotifierAPI:Fa,ReadOnlyAPI:za,SanitizerAPI:Ka,SaverAPI:Ya,SelectionAPI:Va,ToolsAPI:Ga,StylesAPI:Xa,ToolbarAPI:Ja,TooltipAPI:rl,UiAPI:ol,BlockSettings:Il,Toolbar:jl,InlineToolbar:Fl,BlockEvents:bd,BlockManager:kd,BlockSelection:wd,Caret:xd,CrossBlockSelection:Ed,DragNDrop:_d,ModificationsObserver:Td,Paste:Bd,ReadOnly:Od,RectangleSelection:Id,Renderer:Ad,Saver:Md,Tools:xs,UI:Wd};class Zd{constructor(e){this.moduleInstances={},this.eventsDispatcher=new Pt;let t,n;this.isReady=new Promise((o,i)=>{t=o,n=i}),Promise.resolve().then(async()=>{this.configuration=e,this.validate(),this.init(),await this.start(),await this.render();const{BlockManager:o,Caret:i,UI:s,ModificationsObserver:a}=this.moduleInstances;s.checkEmptiness(),a.enable(),this.configuration.autofocus===!0&&this.configuration.readOnly!==!0&&i.setToBlock(o.blocks[0],i.positions.START),t()}).catch(o=>{ce(`Editor.js is not ready because of ${o}`,"error"),n(o)})}set configuration(e){var t,n;we(e)?this.config={...e}:this.config={holder:e},Zn(!!this.config.holderId,"config.holderId","config.holder"),this.config.holderId&&!this.config.holder&&(this.config.holder=this.config.holderId,this.config.holderId=null),this.config.holder==null&&(this.config.holder="editorjs"),this.config.logLevel||(this.config.logLevel=di.VERBOSE),ca(this.config.logLevel),Zn(!!this.config.initialBlock,"config.initialBlock","config.defaultBlock"),this.config.defaultBlock=this.config.defaultBlock||this.config.initialBlock||"paragraph",this.config.minHeight=this.config.minHeight!==void 0?this.config.minHeight:300;const o={type:this.config.defaultBlock,data:{}};this.config.placeholder=this.config.placeholder||!1,this.config.sanitizer=this.config.sanitizer||{p:!0,b:!0,a:!0},this.config.hideToolbar=this.config.hideToolbar?this.config.hideToolbar:!1,this.config.tools=this.config.tools||{},this.config.i18n=this.config.i18n||{},this.config.data=this.config.data||{blocks:[]},this.config.onReady=this.config.onReady||(()=>{}),this.config.onChange=this.config.onChange||(()=>{}),this.config.inlineToolbar=this.config.inlineToolbar!==void 0?this.config.inlineToolbar:!0,(Ae(this.config.data)||!this.config.data.blocks||this.config.data.blocks.length===0)&&(this.config.data={blocks:[o]}),this.config.readOnly=this.config.readOnly||!1,(t=this.config.i18n)!=null&&t.messages&&Ce.setDictionary(this.config.i18n.messages),this.config.i18n.direction=((n=this.config.i18n)==null?void 0:n.direction)||"ltr"}get configuration(){return this.config}validate(){const{holderId:e,holder:t}=this.config;if(e&&t)throw Error("«holderId» and «holder» param can't assign at the same time.");if(Ze(t)&&!F.get(t))throw Error(`element with ID «${t}» is missing. Pass correct holder's ID.`);if(t&&we(t)&&!F.isElement(t))throw Error("«holder» value must be an Element node")}init(){this.constructModules(),this.configureModules()}async start(){await["Tools","UI","BlockManager","Paste","BlockSelection","RectangleSelection","CrossBlockSelection","ReadOnly"].reduce((e,t)=>e.then(async()=>{try{await this.moduleInstances[t].prepare()}catch(n){if(n instanceof bi)throw new Error(n.message);ce(`Module ${t} was skipped because of %o`,"warn",n)}}),Promise.resolve())}render(){return this.moduleInstances.Renderer.render(this.config.data.blocks)}constructModules(){Object.entries(qd).forEach(([e,t])=>{try{this.moduleInstances[e]=new t({config:this.configuration,eventsDispatcher:this.eventsDispatcher})}catch(n){ce("[constructModules]",`Module ${e} skipped because`,"error",n)}})}configureModules(){for(const e in this.moduleInstances)Object.prototype.hasOwnProperty.call(this.moduleInstances,e)&&(this.moduleInstances[e].state=this.getModulesDiff(e))}getModulesDiff(e){const t={};for(const n in this.moduleInstances)n!==e&&(t[n]=this.moduleInstances[n]);return t}}/**
 * Editor.js
 *
 * @license Apache-2.0
 * @see Editor.js <https://editorjs.io>
 * @author CodeX Team <https://codex.so>
 */class Kd{static get version(){return"2.31.0-rc.7"}constructor(e){let t=()=>{};we(e)&&pe(e.onReady)&&(t=e.onReady);const n=new Zd(e);this.isReady=n.isReady.then(()=>{this.exportAPI(n),t()})}exportAPI(e){const t=["configuration"],n=()=>{Object.values(e.moduleInstances).forEach(o=>{pe(o.destroy)&&o.destroy(),o.listeners.removeAll()}),nl(),e=null;for(const o in this)Object.prototype.hasOwnProperty.call(this,o)&&delete this[o];Object.setPrototypeOf(this,null)};t.forEach(o=>{this[o]=e[o]}),this.destroy=n,Object.setPrototypeOf(this,e.moduleInstances.API.methods),delete this.exportAPI,Object.entries({blocks:{clear:"clear",render:"render"},caret:{focus:"focus"},events:{on:"on",off:"off",emit:"emit"},saver:{save:"save"}}).forEach(([o,i])=>{Object.entries(i).forEach(([s,a])=>{this[a]=e.moduleInstances.API.methods[o][s]})})}}(function(){try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode('.cdx-list{margin:0;padding:0;outline:none;display:grid;counter-reset:item;gap:var(--spacing-s);padding:var(--spacing-xs);--spacing-s: 8px;--spacing-xs: 6px;--list-counter-type: numeric;--radius-border: 5px;--checkbox-background: #fff;--color-border: #C9C9C9;--color-bg-checked: #369FFF;--line-height: 1.45em;--color-bg-checked-hover: #0059AB;--color-tick: #fff;--size-checkbox: 1.2em}.cdx-list__item{line-height:var(--line-height);display:grid;grid-template-columns:auto 1fr;grid-template-rows:auto auto;grid-template-areas:"checkbox content" ". child"}.cdx-list__item-children{display:grid;grid-area:child;gap:var(--spacing-s);padding-top:var(--spacing-s)}.cdx-list__item [contenteditable]{outline:none}.cdx-list__item-content{word-break:break-word;white-space:pre-wrap;grid-area:content;padding-left:var(--spacing-s)}.cdx-list__item:before{counter-increment:item;white-space:nowrap}.cdx-list-ordered .cdx-list__item:before{content:counters(item,".",var(--list-counter-type)) "."}.cdx-list-ordered{counter-reset:item}.cdx-list-unordered .cdx-list__item:before{content:"•"}.cdx-list-checklist .cdx-list__item:before{content:""}.cdx-list__settings .cdx-settings-button{width:50%}.cdx-list__checkbox{padding-top:calc((var(--line-height) - var(--size-checkbox)) / 2);grid-area:checkbox;width:var(--size-checkbox);height:var(--size-checkbox);display:flex;cursor:pointer}.cdx-list__checkbox svg{opacity:0;height:var(--size-checkbox);width:var(--size-checkbox);left:-1px;top:-1px;position:absolute}@media (hover: hover){.cdx-list__checkbox:not(.cdx-list__checkbox--no-hover):hover .cdx-list__checkbox-check svg{opacity:1}}.cdx-list__checkbox--checked{line-height:var(--line-height)}@media (hover: hover){.cdx-list__checkbox--checked:not(.cdx-list__checkbox--checked--no-hover):hover .cdx-checklist__checkbox-check{background:var(--color-bg-checked-hover);border-color:var(--color-bg-checked-hover)}}.cdx-list__checkbox--checked .cdx-list__checkbox-check{background:var(--color-bg-checked);border-color:var(--color-bg-checked)}.cdx-list__checkbox--checked .cdx-list__checkbox-check svg{opacity:1}.cdx-list__checkbox--checked .cdx-list__checkbox-check svg path{stroke:var(--color-tick)}.cdx-list__checkbox--checked .cdx-list__checkbox-check:before{opacity:0;visibility:visible;transform:scale(2.5)}.cdx-list__checkbox-check{cursor:pointer;display:inline-block;position:relative;margin:0 auto;width:var(--size-checkbox);height:var(--size-checkbox);box-sizing:border-box;border-radius:var(--radius-border);border:1px solid var(--color-border);background:var(--checkbox-background)}.cdx-list__checkbox-check:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border-radius:100%;background-color:var(--color-bg-checked);visibility:hidden;pointer-events:none;transform:scale(1);transition:transform .4s ease-out,opacity .4s}.cdx-list-start-with-field{background:#F8F8F8;border:1px solid rgba(226,226,229,.2);border-radius:6px;padding:2px;display:grid;grid-template-columns:auto auto 1fr;grid-template-rows:auto}.cdx-list-start-with-field--invalid{background:#FFECED;border:1px solid #E13F3F}.cdx-list-start-with-field--invalid .cdx-list-start-with-field__input{color:#e13f3f}.cdx-list-start-with-field__input{font-size:14px;outline:none;font-weight:500;font-family:inherit;border:0;background:transparent;margin:0;padding:0;line-height:22px;min-width:calc(100% - var(--toolbox-buttons-size) - var(--icon-margin-right))}.cdx-list-start-with-field__input::placeholder{color:var(--grayText);font-weight:500}')),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Yd='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 12L10.4884 15.8372C10.5677 15.9245 10.705 15.9245 10.7844 15.8372L17 9"/></svg>',ni='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M9.2 12L11.0586 13.8586C11.1367 13.9367 11.2633 13.9367 11.3414 13.8586L14.7 10.5"/><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/></svg>',ri='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="9" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 17H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 12H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 7H4.99002"/></svg>',oi='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="12" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.79999 14L7.79999 7.2135C7.79999 7.12872 7.7011 7.0824 7.63597 7.13668L4.79999 9.5"/></svg>',Vd='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 14.2L10 7.4135C10 7.32872 9.90111 7.28241 9.83598 7.33668L7 9.7" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M13.2087 14.2H13.2" stroke="black" stroke-width="1.6" stroke-linecap="round"/></svg>',Gd='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2087 14.2H13.2" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M10 14.2L10 9.5" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M10 7.01L10 7" stroke="black" stroke-width="1.8" stroke-linecap="round"/></svg>',Xd='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2087 14.2H13.2" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M10 14.2L10 7.2" stroke="black" stroke-width="1.6" stroke-linecap="round"/></svg>',Jd='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.0087 14.2H16" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M7 14.2L7.78865 12M13 14.2L12.1377 12M7.78865 12C7.78865 12 9.68362 7 10 7C10.3065 7 12.1377 12 12.1377 12M7.78865 12L12.1377 12" stroke="black" stroke-width="1.6" stroke-linecap="round"/></svg>',Qd='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.2087 14.2H14.2" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M11.5 14.5C11.5 14.5 11 13.281 11 12.5M7 9.5C7 9.5 7.5 8.5 9 8.5C10.5 8.5 11 9.5 11 10.5L11 11.5M11 11.5L11 12.5M11 11.5C11 11.5 7 11 7 13C7 15.3031 11 15 11 12.5" stroke="black" stroke-width="1.6" stroke-linecap="round"/></svg>',eu='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 14.2L8 7.4135C8 7.32872 7.90111 7.28241 7.83598 7.33668L5 9.7" stroke="black" stroke-width="1.6" stroke-linecap="round"/><path d="M14 13L16.4167 10.7778M16.4167 10.7778L14 8.5M16.4167 10.7778H11.6562" stroke="black" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>';var ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tu(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var o=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return r[n]}})}),t}var ue={},eo={},to={};Object.defineProperty(to,"__esModule",{value:!0});to.allInputsSelector=nu;function nu(){var r=["text","password","email","number","search","tel","url"];return"[contenteditable=true], textarea, input:not([type]), "+r.map(function(e){return'input[type="'.concat(e,'"]')}).join(", ")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.allInputsSelector=void 0;var e=to;Object.defineProperty(r,"allInputsSelector",{enumerable:!0,get:function(){return e.allInputsSelector}})})(eo);var it={},no={};Object.defineProperty(no,"__esModule",{value:!0});no.isNativeInput=ru;function ru(r){var e=["INPUT","TEXTAREA"];return r&&r.tagName?e.includes(r.tagName):!1}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNativeInput=void 0;var e=no;Object.defineProperty(r,"isNativeInput",{enumerable:!0,get:function(){return e.isNativeInput}})})(it);var Es={},ro={};Object.defineProperty(ro,"__esModule",{value:!0});ro.append=ou;function ou(r,e){Array.isArray(e)?e.forEach(function(t){r.appendChild(t)}):r.appendChild(e)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.append=void 0;var e=ro;Object.defineProperty(r,"append",{enumerable:!0,get:function(){return e.append}})})(Es);var oo={},io={};Object.defineProperty(io,"__esModule",{value:!0});io.blockElements=iu;function iu(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tbody","thead","tr","tfoot","ul","video"]}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.blockElements=void 0;var e=io;Object.defineProperty(r,"blockElements",{enumerable:!0,get:function(){return e.blockElements}})})(oo);var _s={},so={};Object.defineProperty(so,"__esModule",{value:!0});so.calculateBaseline=su;function su(r){var e=window.getComputedStyle(r),t=parseFloat(e.fontSize),n=parseFloat(e.lineHeight)||t*1.2,o=parseFloat(e.paddingTop),i=parseFloat(e.borderTopWidth),s=parseFloat(e.marginTop),a=t*.8,l=(n-t)/2,c=s+i+o+l+a;return c}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.calculateBaseline=void 0;var e=so;Object.defineProperty(r,"calculateBaseline",{enumerable:!0,get:function(){return e.calculateBaseline}})})(_s);var Cs={},ao={},lo={},co={};Object.defineProperty(co,"__esModule",{value:!0});co.isContentEditable=au;function au(r){return r.contentEditable==="true"}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isContentEditable=void 0;var e=co;Object.defineProperty(r,"isContentEditable",{enumerable:!0,get:function(){return e.isContentEditable}})})(lo);Object.defineProperty(ao,"__esModule",{value:!0});ao.canSetCaret=du;var lu=it,cu=lo;function du(r){var e=!0;if((0,lu.isNativeInput)(r))switch(r.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":e=!1;break}else e=(0,cu.isContentEditable)(r);return e}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.canSetCaret=void 0;var e=ao;Object.defineProperty(r,"canSetCaret",{enumerable:!0,get:function(){return e.canSetCaret}})})(Cs);var xn={},uo={};function uu(r,e,t){const n=t.value!==void 0?"value":"get",o=t[n],i=`#${e}Cache`;if(t[n]=function(...s){return this[i]===void 0&&(this[i]=o.apply(this,s)),this[i]},n==="get"&&t.set){const s=t.set;t.set=function(a){delete r[i],s.apply(this,a)}}return t}function Ss(){const r={win:!1,mac:!1,x11:!1,linux:!1},e=Object.keys(r).find(t=>window.navigator.appVersion.toLowerCase().indexOf(t)!==-1);return e!==void 0&&(r[e]=!0),r}function ho(r){return r!=null&&r!==""&&(typeof r!="object"||Object.keys(r).length>0)}function hu(r){return!ho(r)}const pu=()=>typeof window<"u"&&window.navigator!==null&&ho(window.navigator.platform)&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);function fu(r){const e=Ss();return r=r.replace(/shift/gi,"⇧").replace(/backspace/gi,"⌫").replace(/enter/gi,"⏎").replace(/up/gi,"↑").replace(/left/gi,"→").replace(/down/gi,"↓").replace(/right/gi,"←").replace(/escape/gi,"⎋").replace(/insert/gi,"Ins").replace(/delete/gi,"␡").replace(/\+/gi,"+"),e.mac?r=r.replace(/ctrl|cmd/gi,"⌘").replace(/alt/gi,"⌥"):r=r.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN"),r}function gu(r){return r[0].toUpperCase()+r.slice(1)}function mu(r){const e=document.createElement("div");e.style.position="absolute",e.style.left="-999px",e.style.bottom="-999px",e.innerHTML=r,document.body.appendChild(e);const t=window.getSelection(),n=document.createRange();if(n.selectNode(e),t===null)throw new Error("Cannot copy text to clipboard");t.removeAllRanges(),t.addRange(n),document.execCommand("copy"),document.body.removeChild(e)}function bu(r,e,t){let n;return(...o)=>{const i=this,s=()=>{n=void 0,t!==!0&&r.apply(i,o)},a=t===!0&&n!==void 0;window.clearTimeout(n),n=window.setTimeout(s,e),a&&r.apply(i,o)}}function Xe(r){return Object.prototype.toString.call(r).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function vu(r){return Xe(r)==="boolean"}function Ts(r){return Xe(r)==="function"||Xe(r)==="asyncfunction"}function yu(r){return Ts(r)&&/^\s*class\s+/.test(r.toString())}function ku(r){return Xe(r)==="number"}function Gt(r){return Xe(r)==="object"}function wu(r){return Promise.resolve(r)===r}function xu(r){return Xe(r)==="string"}function Eu(r){return Xe(r)==="undefined"}function er(r,...e){if(!e.length)return r;const t=e.shift();if(Gt(r)&&Gt(t))for(const n in t)Gt(t[n])?(r[n]===void 0&&Object.assign(r,{[n]:{}}),er(r[n],t[n])):Object.assign(r,{[n]:t[n]});return er(r,...e)}function _u(r,e,t){const n=`«${e}» is deprecated and will be removed in the next major release. Please use the «${t}» instead.`;r&&console.warn(n)}function Cu(r){try{return new URL(r).href}catch{}return r.substring(0,2)==="//"?window.location.protocol+r:window.location.origin+r}function Su(r){return r>47&&r<58||r===32||r===13||r===229||r>64&&r<91||r>95&&r<112||r>185&&r<193||r>218&&r<223}const Tu={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91,SLASH:191},Bu={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4};class Ou{constructor(){this.completed=Promise.resolve()}add(e){return new Promise((t,n)=>{this.completed=this.completed.then(e).then(t).catch(n)})}}function Iu(r,e,t=void 0){let n,o,i,s=null,a=0;t||(t={});const l=function(){a=t.leading===!1?0:Date.now(),s=null,i=r.apply(n,o),s===null&&(n=o=null)};return function(){const c=Date.now();!a&&t.leading===!1&&(a=c);const f=e-(c-a);return n=this,o=arguments,f<=0||f>e?(s&&(clearTimeout(s),s=null),a=c,i=r.apply(n,o),s===null&&(n=o=null)):!s&&t.trailing!==!1&&(s=setTimeout(l,f)),i}}const Au=Object.freeze(Object.defineProperty({__proto__:null,PromiseQueue:Ou,beautifyShortcut:fu,cacheable:uu,capitalize:gu,copyTextToClipboard:mu,debounce:bu,deepMerge:er,deprecationAssert:_u,getUserOS:Ss,getValidUrl:Cu,isBoolean:vu,isClass:yu,isEmpty:hu,isFunction:Ts,isIosDevice:pu,isNumber:ku,isObject:Gt,isPrintableKey:Su,isPromise:wu,isString:xu,isUndefined:Eu,keyCodes:Tu,mouseButtons:Bu,notEmpty:ho,throttle:Iu,typeOf:Xe},Symbol.toStringTag,{value:"Module"})),po=tu(Au);Object.defineProperty(uo,"__esModule",{value:!0});uo.containsOnlyInlineElements=Pu;var Mu=po,Lu=oo;function Pu(r){var e;(0,Mu.isString)(r)?(e=document.createElement("div"),e.innerHTML=r):e=r;var t=function(n){return!(0,Lu.blockElements)().includes(n.tagName.toLowerCase())&&Array.from(n.children).every(t)};return Array.from(e.children).every(t)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.containsOnlyInlineElements=void 0;var e=uo;Object.defineProperty(r,"containsOnlyInlineElements",{enumerable:!0,get:function(){return e.containsOnlyInlineElements}})})(xn);var Bs={},fo={},En={},go={};Object.defineProperty(go,"__esModule",{value:!0});go.make=Nu;function Nu(r,e,t){var n;e===void 0&&(e=null),t===void 0&&(t={});var o=document.createElement(r);if(Array.isArray(e)){var i=e.filter(function(a){return a!==void 0});(n=o.classList).add.apply(n,i)}else e!==null&&o.classList.add(e);for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=t[s]);return o}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.make=void 0;var e=go;Object.defineProperty(r,"make",{enumerable:!0,get:function(){return e.make}})})(En);Object.defineProperty(fo,"__esModule",{value:!0});fo.fragmentToString=Du;var Ru=En;function Du(r){var e=(0,Ru.make)("div");return e.appendChild(r),e.innerHTML}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.fragmentToString=void 0;var e=fo;Object.defineProperty(r,"fragmentToString",{enumerable:!0,get:function(){return e.fragmentToString}})})(Bs);var Os={},mo={};Object.defineProperty(mo,"__esModule",{value:!0});mo.getContentLength=Fu;var ju=it;function Fu(r){var e,t;return(0,ju.isNativeInput)(r)?r.value.length:r.nodeType===Node.TEXT_NODE?r.length:(t=(e=r.textContent)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContentLength=void 0;var e=mo;Object.defineProperty(r,"getContentLength",{enumerable:!0,get:function(){return e.getContentLength}})})(Os);var bo={},vo={},ii=ln&&ln.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(vo,"__esModule",{value:!0});vo.getDeepestBlockElements=Is;var zu=xn;function Is(r){return(0,zu.containsOnlyInlineElements)(r)?[r]:Array.from(r.children).reduce(function(e,t){return ii(ii([],e,!0),Is(t),!0)},[])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDeepestBlockElements=void 0;var e=vo;Object.defineProperty(r,"getDeepestBlockElements",{enumerable:!0,get:function(){return e.getDeepestBlockElements}})})(bo);var As={},yo={},_n={},ko={};Object.defineProperty(ko,"__esModule",{value:!0});ko.isLineBreakTag=Hu;function Hu(r){return["BR","WBR"].includes(r.tagName)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isLineBreakTag=void 0;var e=ko;Object.defineProperty(r,"isLineBreakTag",{enumerable:!0,get:function(){return e.isLineBreakTag}})})(_n);var Cn={},wo={};Object.defineProperty(wo,"__esModule",{value:!0});wo.isSingleTag=$u;function $u(r){return["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(r.tagName)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isSingleTag=void 0;var e=wo;Object.defineProperty(r,"isSingleTag",{enumerable:!0,get:function(){return e.isSingleTag}})})(Cn);Object.defineProperty(yo,"__esModule",{value:!0});yo.getDeepestNode=Ms;var Uu=it,Wu=_n,qu=Cn;function Ms(r,e){e===void 0&&(e=!1);var t=e?"lastChild":"firstChild",n=e?"previousSibling":"nextSibling";if(r.nodeType===Node.ELEMENT_NODE&&r[t]){var o=r[t];if((0,qu.isSingleTag)(o)&&!(0,Uu.isNativeInput)(o)&&!(0,Wu.isLineBreakTag)(o))if(o[n])o=o[n];else if(o.parentNode!==null&&o.parentNode[n])o=o.parentNode[n];else return o.parentNode;return Ms(o,e)}return r}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDeepestNode=void 0;var e=yo;Object.defineProperty(r,"getDeepestNode",{enumerable:!0,get:function(){return e.getDeepestNode}})})(As);var Ls={},xo={},zt=ln&&ln.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(xo,"__esModule",{value:!0});xo.findAllInputs=Gu;var Zu=xn,Ku=bo,Yu=eo,Vu=it;function Gu(r){return Array.from(r.querySelectorAll((0,Yu.allInputsSelector)())).reduce(function(e,t){return(0,Vu.isNativeInput)(t)||(0,Zu.containsOnlyInlineElements)(t)?zt(zt([],e,!0),[t],!1):zt(zt([],e,!0),(0,Ku.getDeepestBlockElements)(t),!0)},[])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.findAllInputs=void 0;var e=xo;Object.defineProperty(r,"findAllInputs",{enumerable:!0,get:function(){return e.findAllInputs}})})(Ls);var Ps={},Eo={};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.isCollapsedWhitespaces=Xu;function Xu(r){return!/[^\t\n\r ]/.test(r)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCollapsedWhitespaces=void 0;var e=Eo;Object.defineProperty(r,"isCollapsedWhitespaces",{enumerable:!0,get:function(){return e.isCollapsedWhitespaces}})})(Ps);var _o={},Co={};Object.defineProperty(Co,"__esModule",{value:!0});Co.isElement=Qu;var Ju=po;function Qu(r){return(0,Ju.isNumber)(r)?!1:!!r&&!!r.nodeType&&r.nodeType===Node.ELEMENT_NODE}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isElement=void 0;var e=Co;Object.defineProperty(r,"isElement",{enumerable:!0,get:function(){return e.isElement}})})(_o);var Ns={},So={},To={},Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.isLeaf=eh;function eh(r){return r===null?!1:r.childNodes.length===0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isLeaf=void 0;var e=Bo;Object.defineProperty(r,"isLeaf",{enumerable:!0,get:function(){return e.isLeaf}})})(To);var Oo={},Io={};Object.defineProperty(Io,"__esModule",{value:!0});Io.isNodeEmpty=ih;var th=_n,nh=_o,rh=it,oh=Cn;function ih(r,e){var t="";return(0,oh.isSingleTag)(r)&&!(0,th.isLineBreakTag)(r)?!1:((0,nh.isElement)(r)&&(0,rh.isNativeInput)(r)?t=r.value:r.textContent!==null&&(t=r.textContent.replace("​","")),e!==void 0&&(t=t.replace(new RegExp(e,"g"),"")),t.trim().length===0)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeEmpty=void 0;var e=Io;Object.defineProperty(r,"isNodeEmpty",{enumerable:!0,get:function(){return e.isNodeEmpty}})})(Oo);Object.defineProperty(So,"__esModule",{value:!0});So.isEmpty=lh;var sh=To,ah=Oo;function lh(r,e){r.normalize();for(var t=[r];t.length>0;){var n=t.shift();if(n){if(r=n,(0,sh.isLeaf)(r)&&!(0,ah.isNodeEmpty)(r,e))return!1;t.push.apply(t,Array.from(r.childNodes))}}return!0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isEmpty=void 0;var e=So;Object.defineProperty(r,"isEmpty",{enumerable:!0,get:function(){return e.isEmpty}})})(Ns);var Rs={},Ao={};Object.defineProperty(Ao,"__esModule",{value:!0});Ao.isFragment=dh;var ch=po;function dh(r){return(0,ch.isNumber)(r)?!1:!!r&&!!r.nodeType&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isFragment=void 0;var e=Ao;Object.defineProperty(r,"isFragment",{enumerable:!0,get:function(){return e.isFragment}})})(Rs);var Ds={},Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.isHTMLString=hh;var uh=En;function hh(r){var e=(0,uh.make)("div");return e.innerHTML=r,e.childElementCount>0}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isHTMLString=void 0;var e=Mo;Object.defineProperty(r,"isHTMLString",{enumerable:!0,get:function(){return e.isHTMLString}})})(Ds);var js={},Lo={};Object.defineProperty(Lo,"__esModule",{value:!0});Lo.offset=ph;function ph(r){var e=r.getBoundingClientRect(),t=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop,o=e.top+n,i=e.left+t;return{top:o,left:i,bottom:o+e.height,right:i+e.width}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.offset=void 0;var e=Lo;Object.defineProperty(r,"offset",{enumerable:!0,get:function(){return e.offset}})})(js);var Fs={},Po={};Object.defineProperty(Po,"__esModule",{value:!0});Po.prepend=fh;function fh(r,e){Array.isArray(e)?(e=e.reverse(),e.forEach(function(t){return r.prepend(t)})):r.prepend(e)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.prepend=void 0;var e=Po;Object.defineProperty(r,"prepend",{enumerable:!0,get:function(){return e.prepend}})})(Fs);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.prepend=r.offset=r.make=r.isLineBreakTag=r.isSingleTag=r.isNodeEmpty=r.isLeaf=r.isHTMLString=r.isFragment=r.isEmpty=r.isElement=r.isContentEditable=r.isCollapsedWhitespaces=r.findAllInputs=r.isNativeInput=r.allInputsSelector=r.getDeepestNode=r.getDeepestBlockElements=r.getContentLength=r.fragmentToString=r.containsOnlyInlineElements=r.canSetCaret=r.calculateBaseline=r.blockElements=r.append=void 0;var e=eo;Object.defineProperty(r,"allInputsSelector",{enumerable:!0,get:function(){return e.allInputsSelector}});var t=it;Object.defineProperty(r,"isNativeInput",{enumerable:!0,get:function(){return t.isNativeInput}});var n=Es;Object.defineProperty(r,"append",{enumerable:!0,get:function(){return n.append}});var o=oo;Object.defineProperty(r,"blockElements",{enumerable:!0,get:function(){return o.blockElements}});var i=_s;Object.defineProperty(r,"calculateBaseline",{enumerable:!0,get:function(){return i.calculateBaseline}});var s=Cs;Object.defineProperty(r,"canSetCaret",{enumerable:!0,get:function(){return s.canSetCaret}});var a=xn;Object.defineProperty(r,"containsOnlyInlineElements",{enumerable:!0,get:function(){return a.containsOnlyInlineElements}});var l=Bs;Object.defineProperty(r,"fragmentToString",{enumerable:!0,get:function(){return l.fragmentToString}});var c=Os;Object.defineProperty(r,"getContentLength",{enumerable:!0,get:function(){return c.getContentLength}});var f=bo;Object.defineProperty(r,"getDeepestBlockElements",{enumerable:!0,get:function(){return f.getDeepestBlockElements}});var h=As;Object.defineProperty(r,"getDeepestNode",{enumerable:!0,get:function(){return h.getDeepestNode}});var y=Ls;Object.defineProperty(r,"findAllInputs",{enumerable:!0,get:function(){return y.findAllInputs}});var p=Ps;Object.defineProperty(r,"isCollapsedWhitespaces",{enumerable:!0,get:function(){return p.isCollapsedWhitespaces}});var v=lo;Object.defineProperty(r,"isContentEditable",{enumerable:!0,get:function(){return v.isContentEditable}});var d=_o;Object.defineProperty(r,"isElement",{enumerable:!0,get:function(){return d.isElement}});var m=Ns;Object.defineProperty(r,"isEmpty",{enumerable:!0,get:function(){return m.isEmpty}});var b=Rs;Object.defineProperty(r,"isFragment",{enumerable:!0,get:function(){return b.isFragment}});var k=Ds;Object.defineProperty(r,"isHTMLString",{enumerable:!0,get:function(){return k.isHTMLString}});var E=To;Object.defineProperty(r,"isLeaf",{enumerable:!0,get:function(){return E.isLeaf}});var S=Oo;Object.defineProperty(r,"isNodeEmpty",{enumerable:!0,get:function(){return S.isNodeEmpty}});var C=_n;Object.defineProperty(r,"isLineBreakTag",{enumerable:!0,get:function(){return C.isLineBreakTag}});var L=Cn;Object.defineProperty(r,"isSingleTag",{enumerable:!0,get:function(){return L.isSingleTag}});var N=En;Object.defineProperty(r,"make",{enumerable:!0,get:function(){return N.make}});var O=js;Object.defineProperty(r,"offset",{enumerable:!0,get:function(){return O.offset}});var T=Fs;Object.defineProperty(r,"prepend",{enumerable:!0,get:function(){return T.prepend}})})(ue);const Se="cdx-list",Ee={wrapper:Se,item:`${Se}__item`,itemContent:`${Se}__item-content`,itemChildren:`${Se}__item-children`};class De{static get CSS(){return{...Ee,orderedList:`${Se}-ordered`}}constructor(e,t){this.config=t,this.readOnly=e}renderWrapper(e){let t;return e===!0?t=ue.make("ol",[De.CSS.wrapper,De.CSS.orderedList]):t=ue.make("ol",[De.CSS.orderedList,De.CSS.itemChildren]),t}renderItem(e,t){const n=ue.make("li",De.CSS.item),o=ue.make("div",De.CSS.itemContent,{innerHTML:e,contentEditable:(!this.readOnly).toString()});return n.appendChild(o),n}getItemContent(e){const t=e.querySelector(`.${De.CSS.itemContent}`);return!t||ue.isEmpty(t)?"":t.innerHTML}getItemMeta(){return{}}composeDefaultMeta(){return{}}}class je{static get CSS(){return{...Ee,unorderedList:`${Se}-unordered`}}constructor(e,t){this.config=t,this.readOnly=e}renderWrapper(e){let t;return e===!0?t=ue.make("ul",[je.CSS.wrapper,je.CSS.unorderedList]):t=ue.make("ul",[je.CSS.unorderedList,je.CSS.itemChildren]),t}renderItem(e,t){const n=ue.make("li",je.CSS.item),o=ue.make("div",je.CSS.itemContent,{innerHTML:e,contentEditable:(!this.readOnly).toString()});return n.appendChild(o),n}getItemContent(e){const t=e.querySelector(`.${je.CSS.itemContent}`);return!t||ue.isEmpty(t)?"":t.innerHTML}getItemMeta(){return{}}composeDefaultMeta(){return{}}}function Qe(r){return r.nodeType===Node.ELEMENT_NODE}var Ot={},No={},Sn={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.getContenteditableSlice=mh;var gh=ue;function mh(r,e,t,n,o){var i;o===void 0&&(o=!1);var s=document.createRange();if(n==="left"?(s.setStart(r,0),s.setEnd(e,t)):(s.setStart(e,t),s.setEnd(r,r.childNodes.length)),o===!0){var a=s.extractContents();return(0,gh.fragmentToString)(a)}var l=s.cloneContents(),c=document.createElement("div");c.appendChild(l);var f=(i=c.textContent)!==null&&i!==void 0?i:"";return f}Object.defineProperty(Sn,"__esModule",{value:!0});Sn.checkContenteditableSliceForEmptiness=yh;var bh=ue,vh=Tn;function yh(r,e,t,n){var o=(0,vh.getContenteditableSlice)(r,e,t,n);return(0,bh.isCollapsedWhitespaces)(o)}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.checkContenteditableSliceForEmptiness=void 0;var e=Sn;Object.defineProperty(r,"checkContenteditableSliceForEmptiness",{enumerable:!0,get:function(){return e.checkContenteditableSliceForEmptiness}})})(No);var zs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContenteditableSlice=void 0;var e=Tn;Object.defineProperty(r,"getContenteditableSlice",{enumerable:!0,get:function(){return e.getContenteditableSlice}})})(zs);var Hs={},Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.focus=wh;var kh=ue;function wh(r,e){var t,n;if(e===void 0&&(e=!0),(0,kh.isNativeInput)(r)){r.focus();var o=e?0:r.value.length;r.setSelectionRange(o,o)}else{var i=document.createRange(),s=window.getSelection();if(!s)return;var a=function(y,p){p===void 0&&(p=!1);var v=document.createTextNode("");p?y.insertBefore(v,y.firstChild):y.appendChild(v),i.setStart(v,0),i.setEnd(v,0)},l=function(y){return y!=null},c=r.childNodes,f=e?c[0]:c[c.length-1];if(l(f)){for(;l(f)&&f.nodeType!==Node.TEXT_NODE;)f=e?f.firstChild:f.lastChild;if(l(f)&&f.nodeType===Node.TEXT_NODE){var h=(n=(t=f.textContent)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0,o=e?0:h;i.setStart(f,o),i.setEnd(f,o)}else a(r,e)}else a(r);s.removeAllRanges(),s.addRange(i)}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.focus=void 0;var e=Ro;Object.defineProperty(r,"focus",{enumerable:!0,get:function(){return e.focus}})})(Hs);var Do={},Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.getCaretNodeAndOffset=xh;function xh(){var r=window.getSelection();if(r===null)return[null,0];var e=r.focusNode,t=r.focusOffset;return e===null?[null,0]:(e.nodeType!==Node.TEXT_NODE&&e.childNodes.length>0&&(e.childNodes[t]!==void 0?(e=e.childNodes[t],t=0):(e=e.childNodes[t-1],e.textContent!==null&&(t=e.textContent.length))),[e,t])}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCaretNodeAndOffset=void 0;var e=Bn;Object.defineProperty(r,"getCaretNodeAndOffset",{enumerable:!0,get:function(){return e.getCaretNodeAndOffset}})})(Do);var $s={},On={};Object.defineProperty(On,"__esModule",{value:!0});On.getRange=Eh;function Eh(){var r=window.getSelection();return r&&r.rangeCount?r.getRangeAt(0):null}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getRange=void 0;var e=On;Object.defineProperty(r,"getRange",{enumerable:!0,get:function(){return e.getRange}})})($s);var Us={},jo={};Object.defineProperty(jo,"__esModule",{value:!0});jo.isCaretAtEndOfInput=Sh;var si=ue,_h=Do,Ch=No;function Sh(r){var e=(0,si.getDeepestNode)(r,!0);if(e===null)return!0;if((0,si.isNativeInput)(e))return e.selectionEnd===e.value.length;var t=(0,_h.getCaretNodeAndOffset)(),n=t[0],o=t[1];return n===null?!1:(0,Ch.checkContenteditableSliceForEmptiness)(r,n,o,"right")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCaretAtEndOfInput=void 0;var e=jo;Object.defineProperty(r,"isCaretAtEndOfInput",{enumerable:!0,get:function(){return e.isCaretAtEndOfInput}})})(Us);var Ws={},Fo={};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.isCaretAtStartOfInput=Oh;var Ht=ue,Th=Bn,Bh=Sn;function Oh(r){var e=(0,Ht.getDeepestNode)(r);if(e===null||(0,Ht.isEmpty)(r))return!0;if((0,Ht.isNativeInput)(e))return e.selectionEnd===0;if((0,Ht.isEmpty)(r))return!0;var t=(0,Th.getCaretNodeAndOffset)(),n=t[0],o=t[1];return n===null?!1:(0,Bh.checkContenteditableSliceForEmptiness)(r,n,o,"left")}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCaretAtStartOfInput=void 0;var e=Fo;Object.defineProperty(r,"isCaretAtStartOfInput",{enumerable:!0,get:function(){return e.isCaretAtStartOfInput}})})(Ws);var qs={},zo={};Object.defineProperty(zo,"__esModule",{value:!0});zo.save=Mh;var Ih=ue,Ah=On;function Mh(){var r=(0,Ah.getRange)(),e=(0,Ih.make)("span");if(e.id="cursor",e.hidden=!0,!!r)return r.insertNode(e),function(){var t=window.getSelection();t&&(r.setStartAfter(e),r.setEndAfter(e),t.removeAllRanges(),t.addRange(r),setTimeout(function(){e.remove()},150))}}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.save=void 0;var e=zo;Object.defineProperty(r,"save",{enumerable:!0,get:function(){return e.save}})})(qs);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.save=r.isCaretAtStartOfInput=r.isCaretAtEndOfInput=r.getRange=r.getCaretNodeAndOffset=r.focus=r.getContenteditableSlice=r.checkContenteditableSliceForEmptiness=void 0;var e=No;Object.defineProperty(r,"checkContenteditableSliceForEmptiness",{enumerable:!0,get:function(){return e.checkContenteditableSliceForEmptiness}});var t=zs;Object.defineProperty(r,"getContenteditableSlice",{enumerable:!0,get:function(){return t.getContenteditableSlice}});var n=Hs;Object.defineProperty(r,"focus",{enumerable:!0,get:function(){return n.focus}});var o=Do;Object.defineProperty(r,"getCaretNodeAndOffset",{enumerable:!0,get:function(){return o.getCaretNodeAndOffset}});var i=$s;Object.defineProperty(r,"getRange",{enumerable:!0,get:function(){return i.getRange}});var s=Us;Object.defineProperty(r,"isCaretAtEndOfInput",{enumerable:!0,get:function(){return s.isCaretAtEndOfInput}});var a=Ws;Object.defineProperty(r,"isCaretAtStartOfInput",{enumerable:!0,get:function(){return a.isCaretAtStartOfInput}});var l=qs;Object.defineProperty(r,"save",{enumerable:!0,get:function(){return l.save}})})(Ot);class ye{static get CSS(){return{...Ee,checklist:`${Se}-checklist`,itemChecked:`${Se}__checkbox--checked`,noHover:`${Se}__checkbox--no-hover`,checkbox:`${Se}__checkbox-check`,checkboxContainer:`${Se}__checkbox`}}constructor(e,t){this.config=t,this.readOnly=e}renderWrapper(e){let t;return e===!0?(t=ue.make("ul",[ye.CSS.wrapper,ye.CSS.checklist]),t.addEventListener("click",n=>{const o=n.target;if(o){const i=o.closest(`.${ye.CSS.checkboxContainer}`);i&&i.contains(o)&&this.toggleCheckbox(i)}})):t=ue.make("ul",[ye.CSS.checklist,ye.CSS.itemChildren]),t}renderItem(e,t){const n=ue.make("li",[ye.CSS.item,ye.CSS.item]),o=ue.make("div",ye.CSS.itemContent,{innerHTML:e,contentEditable:(!this.readOnly).toString()}),i=ue.make("span",ye.CSS.checkbox),s=ue.make("div",ye.CSS.checkboxContainer);return t.checked===!0&&s.classList.add(ye.CSS.itemChecked),i.innerHTML=Yd,s.appendChild(i),n.appendChild(s),n.appendChild(o),n}getItemContent(e){const t=e.querySelector(`.${ye.CSS.itemContent}`);return!t||ue.isEmpty(t)?"":t.innerHTML}getItemMeta(e){const t=e.querySelector(`.${ye.CSS.checkboxContainer}`);return{checked:t?t.classList.contains(ye.CSS.itemChecked):!1}}composeDefaultMeta(){return{checked:!1}}toggleCheckbox(e){e.classList.toggle(ye.CSS.itemChecked),e.classList.add(ye.CSS.noHover),e.addEventListener("mouseleave",()=>this.removeSpecialHoverBehavior(e),{once:!0})}removeSpecialHoverBehavior(e){e.classList.remove(ye.CSS.noHover)}}function Fn(r,e="after"){const t=[];let n;function o(i){switch(e){case"after":return i.nextElementSibling;case"before":return i.previousElementSibling}}for(n=o(r);n!==null;)t.push(n),n=o(n);return t.length!==0?t:null}function $e(r,e=!0){let t=r;return r.classList.contains(Ee.item)&&(t=r.querySelector(`.${Ee.itemChildren}`)),t===null?[]:e?Array.from(t.querySelectorAll(`:scope > .${Ee.item}`)):Array.from(t.querySelectorAll(`.${Ee.item}`))}function Lh(r){return r.nextElementSibling===null}function Ph(r){return r.querySelector(`.${Ee.itemChildren}`)!==null}function Ve(r){return r.querySelector(`.${Ee.itemChildren}`)}function zn(r){let e=r;r.classList.contains(Ee.item)&&(e=Ve(r)),e!==null&&$e(e).length===0&&e.remove()}function Xt(r){return r.querySelector(`.${Ee.itemContent}`)}function st(r,e=!0){const t=Xt(r);t&&Ot.focus(t,e)}class Hn{get currentItem(){const e=window.getSelection();if(!e)return null;let t=e.anchorNode;return!t||(Qe(t)||(t=t.parentNode),!t)||!Qe(t)?null:t.closest(`.${Ee.item}`)}get currentItemLevel(){const e=this.currentItem;if(e===null)return null;let t=e.parentNode,n=0;for(;t!==null&&t!==this.listWrapper;)Qe(t)&&t.classList.contains(Ee.item)&&(n+=1),t=t.parentNode;return n+1}constructor({data:e,config:t,api:n,readOnly:o,block:i},s){this.config=t,this.data=e,this.readOnly=o,this.api=n,this.block=i,this.renderer=s}render(){return this.listWrapper=this.renderer.renderWrapper(!0),this.data.items.length?this.appendItems(this.data.items,this.listWrapper):this.appendItems([{content:"",meta:{},items:[]}],this.listWrapper),this.readOnly||this.listWrapper.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.enterPressed(e);break;case"Backspace":this.backspace(e);break;case"Tab":e.shiftKey?this.shiftTab(e):this.addTab(e);break}},!1),"start"in this.data.meta&&this.data.meta.start!==void 0&&this.changeStartWith(this.data.meta.start),"counterType"in this.data.meta&&this.data.meta.counterType!==void 0&&this.changeCounters(this.data.meta.counterType),this.listWrapper}save(e){const t=e??this.listWrapper,n=s=>$e(s).map(a=>{const l=Ve(a),c=this.renderer.getItemContent(a),f=this.renderer.getItemMeta(a),h=l?n(l):[];return{content:c,meta:f,items:h}}),o=t?n(t):[];let i={style:this.data.style,meta:{},items:o};return this.data.style==="ordered"&&(i.meta={start:this.data.meta.start,counterType:this.data.meta.counterType}),i}static get pasteConfig(){return{tags:["OL","UL","LI"]}}merge(e){const t=this.block.holder.querySelectorAll(`.${Ee.item}`),n=t[t.length-1],o=Xt(n);if(n===null||o===null||(o.insertAdjacentHTML("beforeend",e.items[0].content),this.listWrapper===void 0))return;const i=$e(this.listWrapper);if(i.length===0)return;const s=i[i.length-1];let a=Ve(s);const l=e.items.shift();l!==void 0&&(l.items.length!==0&&(a===null&&(a=this.renderer.renderWrapper(!1)),this.appendItems(l.items,a)),e.items.length>0&&this.appendItems(e.items,this.listWrapper))}onPaste(e){const t=e.detail.data;this.data=this.pasteHandler(t);const n=this.listWrapper;n&&n.parentNode&&n.parentNode.replaceChild(this.render(),n)}pasteHandler(e){const{tagName:t}=e;let n="unordered",o;switch(t){case"OL":n="ordered",o="ol";break;case"UL":case"LI":n="unordered",o="ul"}const i={style:n,meta:{},items:[]};n==="ordered"&&(this.data.meta.counterType="numeric",this.data.meta.start=1);const s=a=>Array.from(a.querySelectorAll(":scope > li")).map(l=>{const c=l.querySelector(`:scope > ${o}`),f=c?s(c):[];return{content:l.innerHTML??"",meta:{},items:f}});return i.items=s(e),i}changeStartWith(e){this.listWrapper.style.setProperty("counter-reset",`item ${e-1}`),this.data.meta.start=e}changeCounters(e){this.listWrapper.style.setProperty("--list-counter-type",e),this.data.meta.counterType=e}enterPressed(e){var t;const n=this.currentItem;if(e.stopPropagation(),e.preventDefault(),e.isComposing||n===null)return;const o=((t=this.renderer)==null?void 0:t.getItemContent(n).trim().length)===0,i=n.parentNode===this.listWrapper,s=n.previousElementSibling===null,a=this.api.blocks.getCurrentBlockIndex();if(i&&o)if(Lh(n)&&!Ph(n)){s?this.convertItemToDefaultBlock(a,!0):this.convertItemToDefaultBlock();return}else{this.splitList(n);return}else if(o){this.unshiftItem(n);return}else this.splitItem(n)}backspace(e){var t;const n=this.currentItem;if(n!==null&&Ot.isCaretAtStartOfInput(n)&&((t=window.getSelection())==null?void 0:t.isCollapsed)!==!1){if(e.stopPropagation(),n.parentNode===this.listWrapper&&n.previousElementSibling===null){this.convertFirstItemToDefaultBlock();return}e.preventDefault(),this.mergeItemWithPrevious(n)}}shiftTab(e){e.stopPropagation(),e.preventDefault(),this.currentItem!==null&&this.unshiftItem(this.currentItem)}unshiftItem(e){if(!e.parentNode||!Qe(e.parentNode))return;const t=e.parentNode.closest(`.${Ee.item}`);if(!t)return;let n=Ve(e);if(e.parentElement===null)return;const o=Fn(e);o!==null&&(n===null&&(n=this.renderer.renderWrapper(!1)),o.forEach(i=>{n.appendChild(i)}),e.appendChild(n)),t.after(e),st(e,!1),zn(t)}splitList(e){const t=$e(e),n=this.block,o=this.api.blocks.getCurrentBlockIndex();if(t.length!==0){const l=t[0];this.unshiftItem(l),st(e,!1)}if(e.previousElementSibling===null&&e.parentNode===this.listWrapper){this.convertItemToDefaultBlock(o);return}const i=Fn(e);if(i===null)return;const s=this.renderer.renderWrapper(!0);i.forEach(l=>{s.appendChild(l)});const a=this.save(s);a.meta.start=this.data.style=="ordered"?1:void 0,this.api.blocks.insert(n?.name,a,this.config,o+1),this.convertItemToDefaultBlock(o+1),s.remove()}splitItem(e){const[t,n]=Ot.getCaretNodeAndOffset();if(t===null)return;const o=Xt(e);let i;o===null?i="":i=Ot.getContenteditableSlice(o,t,n,"right",!0);const s=Ve(e),a=this.renderItem(i);e?.after(a),s&&a.appendChild(s),st(a)}mergeItemWithPrevious(e){const t=e.previousElementSibling,n=e.parentNode;if(n===null||!Qe(n))return;const o=n.closest(`.${Ee.item}`);if(!t&&!o||t&&!Qe(t))return;let i;if(t){const h=$e(t,!1);h.length!==0&&h.length!==0?i=h[h.length-1]:i=t}else i=o;const s=this.renderer.getItemContent(e);if(!i)return;st(i,!1);const a=Xt(i);if(a===null)return;a.insertAdjacentHTML("beforeend",s);const l=$e(e);if(l.length===0){e.remove(),zn(i);return}const c=t||o,f=Ve(c)??this.renderer.renderWrapper(!1);t?l.forEach(h=>{f.appendChild(h)}):l.forEach(h=>{f.prepend(h)}),Ve(c)===null&&i.appendChild(f),e.remove()}addTab(e){var t;e.stopPropagation(),e.preventDefault();const n=this.currentItem;if(!n)return;if(((t=this.config)==null?void 0:t.maxLevel)!==void 0){const s=this.currentItemLevel;if(s!==null&&s===this.config.maxLevel)return}const o=n.previousSibling;if(o===null||!Qe(o))return;const i=Ve(o);if(i)i.appendChild(n),$e(n).forEach(s=>{i.appendChild(s)});else{const s=this.renderer.renderWrapper(!1);s.appendChild(n),$e(n).forEach(a=>{s.appendChild(a)}),o.appendChild(s)}zn(n),st(n,!1)}convertItemToDefaultBlock(e,t){let n;const o=this.currentItem,i=o!==null?this.renderer.getItemContent(o):"";t===!0&&this.api.blocks.delete(),e!==void 0?n=this.api.blocks.insert(void 0,{text:i},void 0,e):n=this.api.blocks.insert(),o?.remove(),this.api.caret.setToBlock(n,"start")}convertFirstItemToDefaultBlock(){const e=this.currentItem;if(e===null)return;const t=$e(e);if(t.length!==0){const s=t[0];this.unshiftItem(s),st(e)}const n=Fn(e),o=this.api.blocks.getCurrentBlockIndex(),i=n===null;this.convertItemToDefaultBlock(o,i)}renderItem(e,t){const n=t??this.renderer.composeDefaultMeta();switch(!0){case this.renderer instanceof De:return this.renderer.renderItem(e,n);case this.renderer instanceof je:return this.renderer.renderItem(e,n);default:return this.renderer.renderItem(e,n)}}appendItems(e,t){e.forEach(n=>{var o;const i=this.renderItem(n.content,n.meta);if(t.appendChild(i),n.items.length){const s=(o=this.renderer)==null?void 0:o.renderWrapper(!1);this.appendItems(n.items,s),i.appendChild(s)}})}}const at={wrapper:`${Se}-start-with-field`,input:`${Se}-start-with-field__input`,startWithElementWrapperInvalid:`${Se}-start-with-field--invalid`};function Nh(r,{value:e,placeholder:t,attributes:n,sanitize:o}){const i=ue.make("div",at.wrapper),s=ue.make("input",at.input,{placeholder:t,tabIndex:-1,value:e});for(const a in n)s.setAttribute(a,n[a]);return i.appendChild(s),s.addEventListener("input",()=>{o!==void 0&&(s.value=o(s.value));const a=s.checkValidity();!a&&!i.classList.contains(at.startWithElementWrapperInvalid)&&i.classList.add(at.startWithElementWrapperInvalid),a&&i.classList.contains(at.startWithElementWrapperInvalid)&&i.classList.remove(at.startWithElementWrapperInvalid),a&&r(s.value)}),i}const St=new Map([["Numeric","numeric"],["Lower Roman","lower-roman"],["Upper Roman","upper-roman"],["Lower Alpha","lower-alpha"],["Upper Alpha","upper-alpha"]]),ai=new Map([["numeric",Vd],["lower-roman",Gd],["upper-roman",Xd],["lower-alpha",Qd],["upper-alpha",Jd]]);function Rh(r){return r.replace(/\D+/g,"")}function Dh(r){return typeof r.items[0]=="string"}function jh(r){return!("meta"in r)}function Fh(r){return typeof r.items[0]!="string"&&"text"in r.items[0]&&"checked"in r.items[0]&&typeof r.items[0].text=="string"&&typeof r.items[0].checked=="boolean"}function zh(r){const e=[];return Dh(r)?(r.items.forEach(t=>{e.push({content:t,meta:{},items:[]})}),{style:r.style,meta:{},items:e}):Fh(r)?(r.items.forEach(t=>{e.push({content:t.text,meta:{checked:t.checked},items:[]})}),{style:"checklist",meta:{},items:e}):jh(r)?{style:r.style,meta:{},items:r.items}:r}class cn{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}static get toolbox(){return[{icon:ri,title:"Unordered List",data:{style:"unordered"}},{icon:oi,title:"Ordered List",data:{style:"ordered"}},{icon:ni,title:"Checklist",data:{style:"checklist"}}]}static get pasteConfig(){return{tags:["OL","UL","LI"]}}static get conversionConfig(){return{export:e=>cn.joinRecursive(e),import:(e,t)=>({meta:{},items:[{content:e,meta:{},items:[]}],style:t?.defaultStyle!==void 0?t.defaultStyle:"unordered"})}}get listStyle(){return this.data.style||this.defaultListStyle}set listStyle(e){var t;this.data.style=e,this.changeTabulatorByStyle();const n=this.list.render();(t=this.listElement)==null||t.replaceWith(n),this.listElement=n}constructor({data:e,config:t,api:n,readOnly:o,block:i}){var s;this.api=n,this.readOnly=o,this.config=t,this.block=i,this.defaultListStyle=((s=this.config)==null?void 0:s.defaultStyle)||"unordered",this.defaultCounterTypes=this.config.counterTypes||Array.from(St.values());const a={style:this.defaultListStyle,meta:{},items:[]};this.data=Object.keys(e).length?zh(e):a,this.listStyle==="ordered"&&this.data.meta.counterType===void 0&&(this.data.meta.counterType="numeric"),this.changeTabulatorByStyle()}static joinRecursive(e){return e.items.map(t=>`${t.content} ${cn.joinRecursive(t)}`).join("")}render(){return this.listElement=this.list.render(),this.listElement}save(){return this.data=this.list.save(),this.data}merge(e){this.list.merge(e)}renderSettings(){const e=[{label:this.api.i18n.t("Unordered"),icon:ri,closeOnActivate:!0,isActive:this.listStyle=="unordered",onActivate:()=>{this.listStyle="unordered"}},{label:this.api.i18n.t("Ordered"),icon:oi,closeOnActivate:!0,isActive:this.listStyle=="ordered",onActivate:()=>{this.listStyle="ordered"}},{label:this.api.i18n.t("Checklist"),icon:ni,closeOnActivate:!0,isActive:this.listStyle=="checklist",onActivate:()=>{this.listStyle="checklist"}}];if(this.listStyle==="ordered"){const t=Nh(i=>this.changeStartWith(Number(i)),{value:String(this.data.meta.start??1),placeholder:"",attributes:{required:"true"},sanitize:i=>Rh(i)}),n=[{label:this.api.i18n.t("Start with"),icon:eu,children:{items:[{element:t,type:"html"}]}}],o={label:this.api.i18n.t("Counter type"),icon:ai.get(this.data.meta.counterType),children:{items:[]}};St.forEach((i,s)=>{const a=St.get(s);this.defaultCounterTypes.includes(a)&&o.children.items.push({title:this.api.i18n.t(s),icon:ai.get(a),isActive:this.data.meta.counterType===St.get(s),closeOnActivate:!0,onActivate:()=>{this.changeCounters(St.get(s))}})}),o.children.items.length>1&&n.push(o),e.push({type:"separator"},...n)}return e}onPaste(e){const{tagName:t}=e.detail.data;switch(t){case"OL":this.listStyle="ordered";break;case"UL":case"LI":this.listStyle="unordered"}this.list.onPaste(e)}pasteHandler(e){return this.list.pasteHandler(e)}changeCounters(e){var t;(t=this.list)==null||t.changeCounters(e),this.data.meta.counterType=e}changeStartWith(e){var t;(t=this.list)==null||t.changeStartWith(e),this.data.meta.start=e}changeTabulatorByStyle(){switch(this.listStyle){case"ordered":this.list=new Hn({data:this.data,readOnly:this.readOnly,api:this.api,config:this.config,block:this.block},new De(this.readOnly,this.config));break;case"unordered":this.list=new Hn({data:this.data,readOnly:this.readOnly,api:this.api,config:this.config,block:this.block},new je(this.readOnly,this.config));break;case"checklist":this.list=new Hn({data:this.data,readOnly:this.readOnly,api:this.api,config:this.config,block:this.block},new ye(this.readOnly,this.config));break}}}(function(){try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode('.image-tool{--bg-color: #cdd1e0;--front-color: #388ae5;--border-color: #e8e8eb}.image-tool__image{border-radius:3px;overflow:hidden;margin-bottom:10px;padding-bottom:0}.image-tool__image-picture{max-width:100%;vertical-align:bottom;display:block}.image-tool__image-preloader{width:50px;height:50px;border-radius:50%;background-size:cover;margin:auto;position:relative;background-color:var(--bg-color);background-position:center center}.image-tool__image-preloader:after{content:"";position:absolute;z-index:3;width:60px;height:60px;border-radius:50%;border:2px solid var(--bg-color);border-top-color:var(--front-color);left:50%;top:50%;margin-top:-30px;margin-left:-30px;animation:image-preloader-spin 2s infinite linear;box-sizing:border-box}.image-tool__caption{visibility:hidden;position:absolute;bottom:0;left:0;margin-bottom:10px}.image-tool__caption[contentEditable=true][data-placeholder]:before{position:absolute!important;content:attr(data-placeholder);color:#707684;font-weight:400;display:none}.image-tool__caption[contentEditable=true][data-placeholder]:empty:before{display:block}.image-tool__caption[contentEditable=true][data-placeholder]:empty:focus:before{display:none}.image-tool--empty .image-tool__image,.image-tool--empty .image-tool__image-preloader{display:none}.image-tool--empty .image-tool__caption,.image-tool--uploading .image-tool__caption{visibility:hidden!important}.image-tool .cdx-button{display:flex;align-items:center;justify-content:center}.image-tool .cdx-button svg{height:auto;margin:0 6px 0 0}.image-tool--filled .cdx-button,.image-tool--filled .image-tool__image-preloader{display:none}.image-tool--uploading .image-tool__image{min-height:200px;display:flex;border:1px solid var(--border-color);background-color:#fff}.image-tool--uploading .image-tool__image-picture,.image-tool--uploading .cdx-button{display:none}.image-tool--withBorder .image-tool__image{border:1px solid var(--border-color)}.image-tool--withBackground .image-tool__image{padding:15px;background:var(--bg-color)}.image-tool--withBackground .image-tool__image-picture{max-width:60%;margin:0 auto}.image-tool--stretched .image-tool__image-picture{width:100%}.image-tool--caption .image-tool__caption{visibility:visible}.image-tool--caption{padding-bottom:50px}@keyframes image-preloader-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}')),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Hh='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19V19C9.13623 19 8.20435 19 7.46927 18.6955C6.48915 18.2895 5.71046 17.5108 5.30448 16.5307C5 15.7956 5 14.8638 5 13V12C5 9.19108 5 7.78661 5.67412 6.77772C5.96596 6.34096 6.34096 5.96596 6.77772 5.67412C7.78661 5 9.19108 5 12 5H13.5C14.8956 5 15.5933 5 16.1611 5.17224C17.4395 5.56004 18.44 6.56046 18.8278 7.83886C19 8.40666 19 9.10444 19 10.5V10.5"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 13V16M16 19V16M19 16H16M16 16H13"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.5 17.5L17.5 6.5"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.9919 10.5H19.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.9919 19H11.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13L13 5"/></svg>',$h='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.9919 9.5H19.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.5 5H14.5096"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M14.625 5H15C17.2091 5 19 6.79086 19 9V9.375"/><path stroke="currentColor" stroke-width="2" d="M9.375 5L9 5C6.79086 5 5 6.79086 5 9V9.375"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.3725 5H9.38207"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 9.5H5.00957"/><path stroke="currentColor" stroke-width="2" d="M9.375 19H9C6.79086 19 5 17.2091 5 15V14.625"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.3725 19H9.38207"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 14.55H5.00957"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 13V16M16 19V16M19 16H16M16 16H13"/></svg>',Zs='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.13968 15.32L8.69058 11.5661C9.02934 11.2036 9.48873 11 9.96774 11C10.4467 11 10.9061 11.2036 11.2449 11.5661L15.3871 16M13.5806 14.0664L15.0132 12.533C15.3519 12.1705 15.8113 11.9668 16.2903 11.9668C16.7693 11.9668 17.2287 12.1705 17.5675 12.533L18.841 13.9634"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.7778 9.33331H13.7867"/></svg>',Uh='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9L20 12L17 15"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 12H20"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 9L4 12L7 15"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12H10"/></svg>',Wh='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 9V7.2C8 7.08954 8.08954 7 8.2 7L12 7M16 9V7.2C16 7.08954 15.9105 7 15.8 7L12 7M12 7L12 17M12 17H10M12 17H14"/></svg>';function lt(r,e=null,t={}){const n=document.createElement(r);Array.isArray(e)?n.classList.add(...e):e!==null&&n.classList.add(e);for(const o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);return n}var Jt=(r=>(r.Empty="empty",r.Uploading="uploading",r.Filled="filled",r))(Jt||{});class qh{constructor({api:e,config:t,onSelectFile:n,readOnly:o}){this.api=e,this.config=t,this.onSelectFile=n,this.readOnly=o,this.nodes={wrapper:lt("div",[this.CSS.baseClass,this.CSS.wrapper]),imageContainer:lt("div",[this.CSS.imageContainer]),fileButton:this.createFileButton(),imageEl:void 0,imagePreloader:lt("div",this.CSS.imagePreloader),caption:lt("div",[this.CSS.input,this.CSS.caption],{contentEditable:!this.readOnly})},this.nodes.caption.dataset.placeholder=this.config.captionPlaceholder,this.nodes.imageContainer.appendChild(this.nodes.imagePreloader),this.nodes.wrapper.appendChild(this.nodes.imageContainer),this.nodes.wrapper.appendChild(this.nodes.caption),this.nodes.wrapper.appendChild(this.nodes.fileButton)}applyTune(e,t){this.nodes.wrapper.classList.toggle(`${this.CSS.wrapper}--${e}`,t)}render(){return this.toggleStatus("empty"),this.nodes.wrapper}showPreloader(e){this.nodes.imagePreloader.style.backgroundImage=`url(${e})`,this.toggleStatus("uploading")}hidePreloader(){this.nodes.imagePreloader.style.backgroundImage="",this.toggleStatus("empty")}fillImage(e){const t=/\.mp4$/.test(e)?"VIDEO":"IMG",n={src:e};let o="load";t==="VIDEO"&&(n.autoplay=!0,n.loop=!0,n.muted=!0,n.playsinline=!0,o="loadeddata"),this.nodes.imageEl=lt(t,this.CSS.imageEl,n),this.nodes.imageEl.addEventListener(o,()=>{this.toggleStatus("filled"),this.nodes.imagePreloader!==void 0&&(this.nodes.imagePreloader.style.backgroundImage="")}),this.nodes.imageContainer.appendChild(this.nodes.imageEl)}fillCaption(e){this.nodes.caption!==void 0&&(this.nodes.caption.innerHTML=e)}toggleStatus(e){for(const t in Jt)if(Object.prototype.hasOwnProperty.call(Jt,t)){const n=Jt[t];this.nodes.wrapper.classList.toggle(`${this.CSS.wrapper}--${n}`,n===e)}}get CSS(){return{baseClass:this.api.styles.block,loading:this.api.styles.loader,input:this.api.styles.input,button:this.api.styles.button,wrapper:"image-tool",imageContainer:"image-tool__image",imagePreloader:"image-tool__image-preloader",imageEl:"image-tool__image-picture",caption:"image-tool__caption"}}createFileButton(){const e=lt("div",[this.CSS.button]);return e.innerHTML=this.config.buttonContent??`${Zs} ${this.api.i18n.t("Select an Image")}`,e.addEventListener("click",()=>{this.onSelectFile()}),e}}function Zh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ks={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(window,function(){return function(t){var n={};function o(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=t,o.c=n,o.d=function(i,s,a){o.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:a})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,s){if(1&s&&(i=o(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var l in i)o.d(a,l,function(c){return i[c]}.bind(null,l));return a},o.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(s,"a",s),s},o.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},o.p="",o(o.s=3)}([function(t,n){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch{typeof window=="object"&&(o=window)}t.exports=o},function(t,n,o){(function(i){var s=o(2),a=setTimeout;function l(){}function c(m){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if(typeof m!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(m,this)}function f(m,b){for(;m._state===3;)m=m._value;m._state!==0?(m._handled=!0,c._immediateFn(function(){var k=m._state===1?b.onFulfilled:b.onRejected;if(k!==null){var E;try{E=k(m._value)}catch(S){return void y(b.promise,S)}h(b.promise,E)}else(m._state===1?h:y)(b.promise,m._value)})):m._deferreds.push(b)}function h(m,b){try{if(b===m)throw new TypeError("A promise cannot be resolved with itself.");if(b&&(typeof b=="object"||typeof b=="function")){var k=b.then;if(b instanceof c)return m._state=3,m._value=b,void p(m);if(typeof k=="function")return void d((E=k,S=b,function(){E.apply(S,arguments)}),m)}m._state=1,m._value=b,p(m)}catch(C){y(m,C)}var E,S}function y(m,b){m._state=2,m._value=b,p(m)}function p(m){m._state===2&&m._deferreds.length===0&&c._immediateFn(function(){m._handled||c._unhandledRejectionFn(m._value)});for(var b=0,k=m._deferreds.length;b<k;b++)f(m,m._deferreds[b]);m._deferreds=null}function v(m,b,k){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof b=="function"?b:null,this.promise=k}function d(m,b){var k=!1;try{m(function(E){k||(k=!0,h(b,E))},function(E){k||(k=!0,y(b,E))})}catch(E){if(k)return;k=!0,y(b,E)}}c.prototype.catch=function(m){return this.then(null,m)},c.prototype.then=function(m,b){var k=new this.constructor(l);return f(this,new v(m,b,k)),k},c.prototype.finally=s.a,c.all=function(m){return new c(function(b,k){if(!m||m.length===void 0)throw new TypeError("Promise.all accepts an array");var E=Array.prototype.slice.call(m);if(E.length===0)return b([]);var S=E.length;function C(N,O){try{if(O&&(typeof O=="object"||typeof O=="function")){var T=O.then;if(typeof T=="function")return void T.call(O,function(j){C(N,j)},k)}E[N]=O,--S==0&&b(E)}catch(j){k(j)}}for(var L=0;L<E.length;L++)C(L,E[L])})},c.resolve=function(m){return m&&typeof m=="object"&&m.constructor===c?m:new c(function(b){b(m)})},c.reject=function(m){return new c(function(b,k){k(m)})},c.race=function(m){return new c(function(b,k){for(var E=0,S=m.length;E<S;E++)m[E].then(b,k)})},c._immediateFn=typeof i=="function"&&function(m){i(m)}||function(m){a(m,0)},c._unhandledRejectionFn=function(m){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",m)},n.a=c}).call(this,o(5).setImmediate)},function(t,n,o){n.a=function(i){var s=this.constructor;return this.then(function(a){return s.resolve(i()).then(function(){return a})},function(a){return s.resolve(i()).then(function(){return s.reject(a)})})}},function(t,n,o){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(d)}o(4);var s,a,l,c,f,h,y,p=o(8),v=(a=function(d){return new Promise(function(m,b){d=c(d),(d=f(d)).beforeSend&&d.beforeSend();var k=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");k.open(d.method,d.url),k.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(d.headers).forEach(function(S){var C=d.headers[S];k.setRequestHeader(S,C)});var E=d.ratio;k.upload.addEventListener("progress",function(S){var C=Math.round(S.loaded/S.total*100),L=Math.ceil(C*E/100);d.progress(Math.min(L,100))},!1),k.addEventListener("progress",function(S){var C=Math.round(S.loaded/S.total*100),L=Math.ceil(C*(100-E)/100)+E;d.progress(Math.min(L,100))},!1),k.onreadystatechange=function(){if(k.readyState===4){var S=k.response;try{S=JSON.parse(S)}catch{}var C=p.parseHeaders(k.getAllResponseHeaders()),L={body:S,code:k.status,headers:C};y(k.status)?m(L):b(L)}},k.send(d.data)})},l=function(d){return d.method="POST",a(d)},c=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(d.url&&typeof d.url!="string")throw new Error("Url must be a string");if(d.url=d.url||"",d.method&&typeof d.method!="string")throw new Error("`method` must be a string or null");if(d.method=d.method?d.method.toUpperCase():"GET",d.headers&&i(d.headers)!=="object")throw new Error("`headers` must be an object or null");if(d.headers=d.headers||{},d.type&&(typeof d.type!="string"||!Object.values(s).includes(d.type)))throw new Error("`type` must be taken from module's «contentType» library");if(d.progress&&typeof d.progress!="function")throw new Error("`progress` must be a function or null");if(d.progress=d.progress||function(m){},d.beforeSend=d.beforeSend||function(m){},d.ratio&&typeof d.ratio!="number")throw new Error("`ratio` must be a number");if(d.ratio<0||d.ratio>100)throw new Error("`ratio` must be in a 0-100 interval");if(d.ratio=d.ratio||90,d.accept&&typeof d.accept!="string")throw new Error("`accept` must be a string with a list of allowed mime-types");if(d.accept=d.accept||"*/*",d.multiple&&typeof d.multiple!="boolean")throw new Error("`multiple` must be a true or false");if(d.multiple=d.multiple||!1,d.fieldName&&typeof d.fieldName!="string")throw new Error("`fieldName` must be a string");return d.fieldName=d.fieldName||"files",d},f=function(d){switch(d.method){case"GET":var m=h(d.data,s.URLENCODED);delete d.data,d.url=/\?/.test(d.url)?d.url+"&"+m:d.url+"?"+m;break;case"POST":case"PUT":case"DELETE":case"UPDATE":var b=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).type||s.JSON}(d);(p.isFormData(d.data)||p.isFormElement(d.data))&&(b=s.FORM),d.data=h(d.data,b),b!==v.contentType.FORM&&(d.headers["content-type"]=b)}return d},h=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};switch(arguments.length>1?arguments[1]:void 0){case s.URLENCODED:return p.urlEncode(d);case s.JSON:return p.jsonEncode(d);case s.FORM:return p.formEncode(d);default:return d}},y=function(d){return d>=200&&d<300},{contentType:s={URLENCODED:"application/x-www-form-urlencoded; charset=utf-8",FORM:"multipart/form-data",JSON:"application/json; charset=utf-8"},request:a,get:function(d){return d.method="GET",a(d)},post:l,transport:function(d){return d=c(d),p.selectFiles(d).then(function(m){for(var b=new FormData,k=0;k<m.length;k++)b.append(d.fieldName,m[k],m[k].name);p.isObject(d.data)&&Object.keys(d.data).forEach(function(S){var C=d.data[S];b.append(S,C)});var E=d.beforeSend;return d.beforeSend=function(){return E(m)},d.data=b,l(d)})},selectFiles:function(d){return delete(d=c(d)).beforeSend,p.selectFiles(d)}});t.exports=v},function(t,n,o){o.r(n);var i=o(1);window.Promise=window.Promise||i.a},function(t,n,o){(function(i){var s=i!==void 0&&i||typeof self<"u"&&self||window,a=Function.prototype.apply;function l(c,f){this._id=c,this._clearFn=f}n.setTimeout=function(){return new l(a.call(setTimeout,s,arguments),clearTimeout)},n.setInterval=function(){return new l(a.call(setInterval,s,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(c){c&&c.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(s,this._id)},n.enroll=function(c,f){clearTimeout(c._idleTimeoutId),c._idleTimeout=f},n.unenroll=function(c){clearTimeout(c._idleTimeoutId),c._idleTimeout=-1},n._unrefActive=n.active=function(c){clearTimeout(c._idleTimeoutId);var f=c._idleTimeout;f>=0&&(c._idleTimeoutId=setTimeout(function(){c._onTimeout&&c._onTimeout()},f))},o(6),n.setImmediate=typeof self<"u"&&self.setImmediate||i!==void 0&&i.setImmediate||this&&this.setImmediate,n.clearImmediate=typeof self<"u"&&self.clearImmediate||i!==void 0&&i.clearImmediate||this&&this.clearImmediate}).call(this,o(0))},function(t,n,o){(function(i,s){(function(a,l){if(!a.setImmediate){var c,f,h,y,p,v=1,d={},m=!1,b=a.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(a);k=k&&k.setTimeout?k:a,{}.toString.call(a.process)==="[object process]"?c=function(C){s.nextTick(function(){S(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,L=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=L,C}}()?(y="setImmediate$"+Math.random()+"$",p=function(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(y)===0&&S(+C.data.slice(y.length))},a.addEventListener?a.addEventListener("message",p,!1):a.attachEvent("onmessage",p),c=function(C){a.postMessage(y+C,"*")}):a.MessageChannel?((h=new MessageChannel).port1.onmessage=function(C){S(C.data)},c=function(C){h.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(f=b.documentElement,c=function(C){var L=b.createElement("script");L.onreadystatechange=function(){S(C),L.onreadystatechange=null,f.removeChild(L),L=null},f.appendChild(L)}):c=function(C){setTimeout(S,0,C)},k.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var L=new Array(arguments.length-1),N=0;N<L.length;N++)L[N]=arguments[N+1];var O={callback:C,args:L};return d[v]=O,c(v),v++},k.clearImmediate=E}function E(C){delete d[C]}function S(C){if(m)setTimeout(S,0,C);else{var L=d[C];if(L){m=!0;try{(function(N){var O=N.callback,T=N.args;switch(T.length){case 0:O();break;case 1:O(T[0]);break;case 2:O(T[0],T[1]);break;case 3:O(T[0],T[1],T[2]);break;default:O.apply(l,T)}})(L)}finally{E(C),m=!1}}}}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,o(0),o(7))},function(t,n){var o,i,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function c(k){if(o===setTimeout)return setTimeout(k,0);if((o===a||!o)&&setTimeout)return o=setTimeout,setTimeout(k,0);try{return o(k,0)}catch{try{return o.call(null,k,0)}catch{return o.call(this,k,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:a}catch{o=a}try{i=typeof clearTimeout=="function"?clearTimeout:l}catch{i=l}})();var f,h=[],y=!1,p=-1;function v(){y&&f&&(y=!1,f.length?h=f.concat(h):p=-1,h.length&&d())}function d(){if(!y){var k=c(v);y=!0;for(var E=h.length;E;){for(f=h,h=[];++p<E;)f&&f[p].run();p=-1,E=h.length}f=null,y=!1,function(S){if(i===clearTimeout)return clearTimeout(S);if((i===l||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(S);try{i(S)}catch{try{return i.call(null,S)}catch{return i.call(this,S)}}}(k)}}function m(k,E){this.fun=k,this.array=E}function b(){}s.nextTick=function(k){var E=new Array(arguments.length-1);if(arguments.length>1)for(var S=1;S<arguments.length;S++)E[S-1]=arguments[S];h.push(new m(k,E)),h.length!==1||y||c(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.prependListener=b,s.prependOnceListener=b,s.listeners=function(k){return[]},s.binding=function(k){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(k){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,n,o){function i(a,l){for(var c=0;c<l.length;c++){var f=l[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}var s=o(9);t.exports=function(){function a(){(function(h,y){if(!(h instanceof y))throw new TypeError("Cannot call a class as a function")})(this,a)}var l,c,f;return l=a,f=[{key:"urlEncode",value:function(h){return s(h)}},{key:"jsonEncode",value:function(h){return JSON.stringify(h)}},{key:"formEncode",value:function(h){if(this.isFormData(h))return h;if(this.isFormElement(h))return new FormData(h);if(this.isObject(h)){var y=new FormData;return Object.keys(h).forEach(function(p){var v=h[p];y.append(p,v)}),y}throw new Error("`data` must be an instance of Object, FormData or <FORM> HTMLElement")}},{key:"isObject",value:function(h){return Object.prototype.toString.call(h)==="[object Object]"}},{key:"isFormData",value:function(h){return h instanceof FormData}},{key:"isFormElement",value:function(h){return h instanceof HTMLFormElement}},{key:"selectFiles",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(y,p){var v=document.createElement("INPUT");v.type="file",h.multiple&&v.setAttribute("multiple","multiple"),h.accept&&v.setAttribute("accept",h.accept),v.style.display="none",document.body.appendChild(v),v.addEventListener("change",function(d){var m=d.target.files;y(m),document.body.removeChild(v)},!1),v.click()})}},{key:"parseHeaders",value:function(h){var y=h.trim().split(/[\r\n]+/),p={};return y.forEach(function(v){var d=v.split(": "),m=d.shift(),b=d.join(": ");m&&(p[m]=b)}),p}}],(c=null)&&i(l.prototype,c),f&&i(l,f),a}()},function(t,n){var o=function(s){return encodeURIComponent(s).replace(/[!'()*]/g,escape).replace(/%20/g,"+")},i=function(s,a,l,c){return a=a||null,l=l||"&",c=c||null,s?function(f){for(var h=new Array,y=0;y<f.length;y++)f[y]&&h.push(f[y]);return h}(Object.keys(s).map(function(f){var h,y,p=f;if(c&&(p=c+"["+p+"]"),typeof s[f]=="object"&&s[f]!==null)h=i(s[f],null,l,p);else{a&&(y=p,p=!isNaN(parseFloat(y))&&isFinite(y)?a+Number(p):p);var v=s[f];v=(v=(v=(v=v===!0?"1":v)===!1?"0":v)===0?"0":v)||"",h=o(p)+"="+o(v)}return h})).join(l).replace(/[!'()*]/g,""):""};t.exports=i}])})})(Ks);var Kh=Ks.exports;const ct=Zh(Kh);function $n(r){return r!==void 0&&typeof r.then=="function"}class Yh{constructor({config:e,onUpload:t,onError:n}){this.config=e,this.onUpload=t,this.onError=n}uploadSelectedFile({onPreview:e}){const t=function(o){const i=new FileReader;i.readAsDataURL(o),i.onload=s=>{e(s.target.result)}};let n;if(this.config.uploader&&typeof this.config.uploader.uploadByFile=="function"){const o=this.config.uploader.uploadByFile;n=ct.selectFiles({accept:this.config.types??"image/*"}).then(i=>{t(i[0]);const s=o(i[0]);return $n(s)||console.warn("Custom uploader method uploadByFile should return a Promise"),s})}else n=ct.transport({url:this.config.endpoints.byFile,data:this.config.additionalRequestData,accept:this.config.types??"image/*",headers:this.config.additionalRequestHeaders,beforeSend:o=>{t(o[0])},fieldName:this.config.field??"image"}).then(o=>o.body);n.then(o=>{this.onUpload(o)}).catch(o=>{this.onError(o)})}uploadByUrl(e){let t;this.config.uploader&&typeof this.config.uploader.uploadByUrl=="function"?(t=this.config.uploader.uploadByUrl(e),$n(t)||console.warn("Custom uploader method uploadByUrl should return a Promise")):t=ct.post({url:this.config.endpoints.byUrl,data:Object.assign({url:e},this.config.additionalRequestData),type:ct.contentType.JSON,headers:this.config.additionalRequestHeaders}).then(n=>n.body),t.then(n=>{this.onUpload(n)}).catch(n=>{this.onError(n)})}uploadByFile(e,{onPreview:t}){const n=new FileReader;n.readAsDataURL(e),n.onload=i=>{t(i.target.result)};let o;if(this.config.uploader&&typeof this.config.uploader.uploadByFile=="function")o=this.config.uploader.uploadByFile(e),$n(o)||console.warn("Custom uploader method uploadByFile should return a Promise");else{const i=new FormData;i.append(this.config.field??"image",e),this.config.additionalRequestData&&Object.keys(this.config.additionalRequestData).length&&Object.entries(this.config.additionalRequestData).forEach(([s,a])=>{i.append(s,a)}),o=ct.post({url:this.config.endpoints.byFile,data:i,type:ct.contentType.JSON,headers:this.config.additionalRequestHeaders}).then(s=>s.body)}o.then(i=>{this.onUpload(i)}).catch(i=>{this.onError(i)})}}/**
 * Image Tool for the Editor.js
 * @author CodeX <team@codex.so>
 * @license MIT
 * @see {@link https://github.com/editor-js/image}
 *
 * To developers.
 * To simplify Tool structure, we split it to 4 parts:
 *  1) index.ts — main Tool's interface, public API and methods for working with data
 *  2) uploader.ts — module that has methods for sending files via AJAX: from device, by URL or File pasting
 *  3) ui.ts — module for UI manipulations: render, showing preloader, etc
 *
 * For debug purposes there is a testing server
 * that can save uploaded files and return a Response {@link UploadResponseFormat}
 *
 *       $ node dev/server.js
 *
 * It will expose 8008 port, so you can pass http://localhost:8008 with the Tools config:
 *
 * image: {
 *   class: ImageTool,
 *   config: {
 *     endpoints: {
 *       byFile: 'http://localhost:8008/uploadFile',
 *       byUrl: 'http://localhost:8008/fetchUrl',
 *     }
 *   },
 * },
 */class dn{constructor({data:e,config:t,api:n,readOnly:o,block:i}){this.isCaptionEnabled=null,this.api=n,this.block=i,this.config={endpoints:t.endpoints,additionalRequestData:t.additionalRequestData,additionalRequestHeaders:t.additionalRequestHeaders,field:t.field,types:t.types,captionPlaceholder:this.api.i18n.t(t.captionPlaceholder??"Caption"),buttonContent:t.buttonContent,uploader:t.uploader,actions:t.actions,features:t.features||{}},this.uploader=new Yh({config:this.config,onUpload:s=>this.onUpload(s),onError:s=>this.uploadingFailed(s)}),this.ui=new qh({api:n,config:this.config,onSelectFile:()=>{this.uploader.uploadSelectedFile({onPreview:s=>{this.ui.showPreloader(s)}})},readOnly:o}),this._data={caption:"",withBorder:!1,withBackground:!1,stretched:!1,file:{url:""}},this.data=e}static get isReadOnlySupported(){return!0}static get toolbox(){return{icon:Zs,title:"Image"}}static get tunes(){return[{name:"withBorder",icon:$h,title:"With border",toggle:!0},{name:"stretched",icon:Uh,title:"Stretch image",toggle:!0},{name:"withBackground",icon:Hh,title:"With background",toggle:!0}]}render(){var e,t,n;return(((e=this.config.features)==null?void 0:e.caption)===!0||((t=this.config.features)==null?void 0:t.caption)===void 0||((n=this.config.features)==null?void 0:n.caption)==="optional"&&this.data.caption)&&(this.isCaptionEnabled=!0),this.ui.render()}validate(e){return!!e.file.url}save(){const e=this.ui.nodes.caption;return this._data.caption=e.innerHTML,this.data}renderSettings(){var e;const t=dn.tunes.concat(this.config.actions||[]),n={border:"withBorder",background:"withBackground",stretch:"stretched",caption:"caption"};((e=this.config.features)==null?void 0:e.caption)==="optional"&&t.push({name:"caption",icon:Wh,title:"With caption",toggle:!0});const o=t.filter(s=>{var a,l;const c=Object.keys(n).find(f=>n[f]===s.name);return c==="caption"?((a=this.config.features)==null?void 0:a.caption)!==!1:c==null||((l=this.config.features)==null?void 0:l[c])!==!1}),i=s=>{let a=this.data[s.name];return s.name==="caption"&&(a=this.isCaptionEnabled??a),a};return o.map(s=>({icon:s.icon,label:this.api.i18n.t(s.title),name:s.name,toggle:s.toggle,isActive:i(s),onActivate:()=>{if(typeof s.action=="function"){s.action(s.name);return}let a=!i(s);s.name==="caption"&&(this.isCaptionEnabled=!(this.isCaptionEnabled??!1),a=this.isCaptionEnabled),this.tuneToggled(s.name,a)}}))}appendCallback(){this.ui.nodes.fileButton.click()}static get pasteConfig(){return{tags:[{img:{src:!0}}],patterns:{image:/https?:\/\/\S+\.(gif|jpe?g|tiff|png|svg|webp)(\?[a-z0-9=]*)?$/i},files:{mimeTypes:["image/*"]}}}async onPaste(e){switch(e.type){case"tag":{const t=e.detail.data;if(/^blob:/.test(t.src)){const n=await(await fetch(t.src)).blob();this.uploadFile(n);break}this.uploadUrl(t.src);break}case"pattern":{const t=e.detail.data;this.uploadUrl(t);break}case"file":{const t=e.detail.file;this.uploadFile(t);break}}}set data(e){this.image=e.file,this._data.caption=e.caption||"",this.ui.fillCaption(this._data.caption),dn.tunes.forEach(({name:t})=>{const n=typeof e[t]<"u"?e[t]===!0||e[t]==="true":!1;this.setTune(t,n)}),e.caption&&this.setTune("caption",!0)}get data(){return this._data}set image(e){this._data.file=e||{url:""},e&&e.url&&this.ui.fillImage(e.url)}onUpload(e){e.success&&e.file?this.image=e.file:this.uploadingFailed("incorrect response: "+JSON.stringify(e))}uploadingFailed(e){console.log("Image Tool: uploading failed because of",e),this.api.notifier.show({message:this.api.i18n.t("Couldn’t upload image. Please try another."),style:"error"}),this.ui.hidePreloader()}tuneToggled(e,t){e==="caption"?(this.ui.applyTune(e,t),t==!1&&(this._data.caption="",this.ui.fillCaption(""))):this.setTune(e,t)}setTune(e,t){this._data[e]=t,this.ui.applyTune(e,t),e==="stretched"&&Promise.resolve().then(()=>{this.block.stretched=t}).catch(n=>{console.error(n)})}uploadFile(e){this.uploader.uploadByFile(e,{onPreview:t=>{this.ui.showPreloader(t)}})}uploadUrl(e){this.ui.showPreloader(e),this.uploader.uploadByUrl(e)}}class un{constructor(e){this.config=e}instance;async init(){this.config.initialData&&await this.preprocessData(this.config.initialData);const e=this.config.onImageUpload;return new Promise((t,n)=>{this.instance=new Kd({autofocus:!1,inlineToolbar:!1,hideToolbar:!0,holder:this.config.containerId,data:this.config.initialData,tools:{list:cn,image:{class:dn,config:{...e?{uploader:{uploadByFile:async o=>{const i=new Blob([o],{type:""}),s=await e(i);return{success:1,file:{url:URL.createObjectURL(i),key:s}}}}}:{}}}},onReady:async()=>{this.config.readOnly&&this.instance.readOnly.toggle(),this.instance.ui.nodes.wrapper.classList.remove("codex-editor--narrow"),t()}})})}async preprocessData(e){await Promise.all(e.blocks.map(async t=>{if(t.type==="image"&&t.data?.file?.key){const n=t.data.file.key,o=await this.config.onImageGet(n);t.data.file.url=URL.createObjectURL(o)}}))}async setData(e){e===null?await this.instance.blocks.clear():(await this.preprocessData(e),await this.instance.render(e))}async getData(){return await this.instance.save()}destroy(){this.instance.destroy()}}const Ys=document.createElement("template");Ys.innerHTML=`
  <div id="card-editor">
    <div id="card-editor-question" class="editor"></div>
    <div id="card-editor-answer" class="editor"></div>
  </div>
`;class Vh extends bt{questionEditor;answerEditor;async draw(){this.container.appendChild(Ys.content.cloneNode(!0)),this.questionEditor=new un({containerId:"card-editor-question",initialData:this.props.card?.question,onImageUpload:this.props.onImageUpload,onImageGet:this.props.onImageGet}),await this.questionEditor.init(),this.answerEditor=new un({containerId:"card-editor-answer",initialData:this.props.card?.answer,onImageUpload:this.props.onImageUpload,onImageGet:this.props.onImageGet}),await this.answerEditor.init(),document.querySelectorAll(".codex-editor__loader").forEach(e=>{e instanceof HTMLElement&&e.style.setProperty("height","250px","important")}),document.querySelectorAll(".codex-editor__redactor").forEach(e=>{e instanceof HTMLElement&&e.style.setProperty("padding-bottom","250px","important")})}async getCardData(){const e=await this.questionEditor.getData(),t=await this.answerEditor.getData();return{question:e,answer:t}}async setCardData(e){await this.questionEditor.setData(e===null?null:e.question),await this.answerEditor.setData(e===null?null:e.answer)}async clear(){this.questionEditor.destroy(),this.answerEditor.destroy(),this.container.innerHTML=""}}const Vs=document.createElement("template");Vs.innerHTML=`
  <div id="card-editor-modal">
    <div id="card-editor-modal-content">
      <header>
        <button id="card-editor-modal-close-btn" class="icon-button">
          <img src="icons/cancel.svg" />
        </button>
        <h2 id="card-editor-modal-title">Edit card</h2>
        <div>
          <button id="card-editor-modal-delete-btn" class="icon-button">
            <img src="icons/delete.svg" />
          </button>
          <button id="card-editor-modal-save-btn" class="icon-button">
            <img src="icons/save.svg" />
          </button>
        </div>
      </header>
      <section id="card-editor-container"></section>
      <footer>
        <div id="card-editor-modal-tag-container">
          <div id="card-editor-modal-tag-list"></div>
          <input type="text" id="card-editor-modal-tag-input" placeholder="Tags here" />
        </div>
      </footer>
    </div>
  </div>
`;class Gh extends bt{cardEditor=null;card=null;tags=[];cardEditorEl;titleEl;tagListEl;tagInputEl;saveBtnEl;deleteBtnEl;closeBtnEl;async open(e){this.card=e,this.tags=e?[...e.tags]:[],this.cardEditor=new Vh(this.cardEditorEl,{card:e,onImageGet:this.props.onImageGet,onImageUpload:this.props.onImageUpload}),await this.cardEditor.draw(),this.renderTags(),this.titleEl.textContent=e?"Edit Card":"Create Card",document.body.classList.add("card-editor-modal-visible")}renderTags(){this.tags.forEach(e=>{const t=document.createElement("span");t.classList.add("tag"),t.textContent=e,t.style.backgroundColor=se.stringToColor(e),this.tagListEl.appendChild(t)})}async close(){document.body.classList.remove("card-editor-modal-visible"),this.cardEditor?.clear(),this.cardEditor=null,this.cardEditorEl.innerHTML="",this.titleEl.textContent="",this.tagListEl.innerHTML="",this.tagInputEl.value="",this.tags=[],this.card=null}async draw(){this.container.appendChild(Vs.content.cloneNode(!0)),this.cardEditorEl=se.findElementByIdOrFail("card-editor-container"),this.titleEl=se.findElementByIdOrFail("card-editor-modal-title"),this.tagListEl=se.findElementByIdOrFail("card-editor-modal-tag-list"),this.tagInputEl=se.findElementByIdOrFail("card-editor-modal-tag-input"),this.saveBtnEl=se.findElementByIdOrFail("card-editor-modal-save-btn"),this.deleteBtnEl=se.findElementByIdOrFail("card-editor-modal-delete-btn"),this.closeBtnEl=se.findElementByIdOrFail("card-editor-modal-close-btn"),this.tagInputEl.addEventListener("keydown",e=>{if(e.key==="Enter"){const t=this.tagInputEl.value.trim();if(this.tagInputEl.value="",!t||Array.from(this.tagListEl.children).some(o=>o.textContent===t))return;const n=document.createElement("span");n.classList.add("tag"),n.textContent=t,n.style.backgroundColor=se.stringToColor(t),this.tagListEl.appendChild(n),this.tags.push(t)}else e.key==="Backspace"&&this.tagInputEl.value===""&&this.tagListEl.lastElementChild&&(this.tagListEl.lastElementChild.remove(),this.tags.pop())}),this.saveBtnEl.addEventListener("click",async()=>{if(!this.cardEditor)return;const e=await this.cardEditor.getCardData();if(e.question.blocks.length===0||e.answer.blocks.length===0)return;const t={...this.card,...e,tags:this.tags};t.id===void 0?(await this.props.onCardCreate(t),await this.cardEditor.setCardData(null)):(await this.props.onCardUpdate(t),this.close())}),this.deleteBtnEl.addEventListener("click",async()=>{this.card?.id!==void 0&&await this.props.onCardDelete(this.card.id),this.close()}),this.closeBtnEl.addEventListener("click",()=>{this.close()})}async clear(){this.cardEditor?.clear(),this.container.innerHTML=""}}const Gs=document.createElement("template");Gs.innerHTML=`
  <button class="card">
    <div class="card-content">
      <p class="card-question"></p>
      <p class="card-answer"></p>
    </div>
  </button>
`;class Xh extends bt{async draw(){if(this.props.cards.length===0){this.container.textContent="No cards found.";return}this.props.cards.forEach(e=>{const t=Gs.content.cloneNode(!0);t.querySelector(".card").addEventListener("click",()=>this.props.onSelect(e));const o=t.querySelector(".card-question");o.textContent=se.getSnippet(e.question);const i=t.querySelector(".card-answer");i.textContent=se.getSnippet(e.answer),this.container.appendChild(t)})}async clear(){this.container.innerHTML=""}async setData(e){this.props.cards=e,await this.clear(),await this.draw()}}class Xs extends bt{}const Js=document.createElement("template");Js.innerHTML=`
  <button class="tag"></button>
`;class Jh extends bt{async draw(){this.props.allTags.forEach(e=>{const n=Js.content.cloneNode(!0).querySelector(".tag");n.addEventListener("click",()=>this.props.onToggle(e)),n.textContent=this.props.selectedTags.includes(e)?`${e} ✔`:e,n.style.backgroundColor=se.stringToColor(e),this.container.appendChild(n)})}async setData(e,t){this.props.allTags=e,this.props.selectedTags=t,await this.clear(),await this.draw()}async clear(){this.container.innerHTML=""}}class hn{static STORAGE_KEY="learning-progress";state;constructor(){this.state=this.loadState()}loadState(){const e=localStorage.getItem(hn.STORAGE_KEY);if(e)try{return JSON.parse(e)}catch{}const t={allCardIds:[],queueCardIds:[]};return this.saveState(t),t}saveState(e){this.state=e,localStorage.setItem(hn.STORAGE_KEY,JSON.stringify(this.state))}get allCardIds(){return[...this.state.allCardIds]}get queueCardIds(){return[...this.state.queueCardIds]}addToQueue(e,t=!1){if(!this.state.queueCardIds.includes(e)){const n=t?[e,...this.state.queueCardIds]:[...this.state.queueCardIds,e];this.saveState({...this.state,queueCardIds:n})}}popNext(){const[e,...t]=this.state.queueCardIds;return this.saveState({...this.state,queueCardIds:t}),e}reset(e){this.saveState({allCardIds:e,queueCardIds:[...e]})}getStats(){const e=this.state.allCardIds.length,t=this.state.queueCardIds.length;return{total:e,remaining:t,done:e-t}}}const ft=new hn,Qs=document.createElement("template");Qs.innerHTML=`
  <div id="card-editor-modal-container"></div>
  <div id="main-page-container">
    <nav>
      <input type="file" id="import-input" accept=".zip" class="hidden" />
      <button id="import-btn" class="icon-button">
        <img src="icons/import.svg" />
      </button>
      <button id="export-btn" class="icon-button">
        <img src="icons/export.svg" />
      </button>
      <button id="add-card-btn" class="icon-button">
        <img src="icons/add.svg" />
      </button>
      <button id="learn-btn" class="icon-button">
        <img src="icons/learn.svg" />
      </button>
    </nav>
    <section id="tag-list"></section>
    <section id="card-list"></section>
  </div>
`;class Qh extends Xs{tagList;cardList;cardEditorModal;allTags=[];allCards=[];selectedTags=[];get filteredCards(){return this.allCards.filter(e=>this.selectedTags.every(t=>e.tags.includes(t)))}async draw(){this.container.appendChild(Qs.content.cloneNode(!0)),await this.loadData(),this.cardEditorModal=new Gh(se.findElementByIdOrFail("card-editor-modal-container"),{onImageGet:async s=>await this.props.database.images.get(s),onImageUpload:async s=>{const a=await this.props.database.images.add(s);return await this.reloadAndRefresh(),a},onCardCreate:async s=>{const a=await this.props.database.cards.add(s);return await this.reloadAndRefresh(),a},onCardUpdate:async s=>{const a=await this.props.database.cards.put(s);return await this.reloadAndRefresh(),a},onCardDelete:async s=>{await this.props.database.cards.delete(s),await this.reloadAndRefresh()}}),await this.cardEditorModal.draw(),this.tagList=new Jh(se.findElementByIdOrFail("tag-list"),{onToggle:async s=>await this.toggleTag(s),allTags:this.allTags,selectedTags:this.selectedTags}),await this.tagList.draw(),this.cardList=new Xh(se.findElementByIdOrFail("card-list"),{onSelect:async s=>await this.cardEditorModal.open(s),cards:this.allCards}),await this.cardList.draw();const e=se.findElementByIdOrFail("import-input"),t=se.findElementByIdOrFail("import-btn");e.addEventListener("change",async s=>{const l=s.target.files?.[0];l&&(await this.props.zip.importData(l),await this.reloadAndRefresh())}),t.addEventListener("click",()=>{e.click()}),se.findElementByIdOrFail("export-btn").addEventListener("click",async()=>{const s=await this.props.zip.exportData();se.downloadBlob(s,"sprtnik.zip")}),se.findElementByIdOrFail("add-card-btn").addEventListener("click",async()=>{await this.cardEditorModal.open(null)}),se.findElementByIdOrFail("learn-btn").addEventListener("click",async()=>{const a=(await this.props.database.cards.getAll()).filter(l=>this.selectedTags.every(c=>l.tags?.includes(c))).map(l=>l.id);ft.reset(a),await this.props.router.navigate("/learn")})}async toggleTag(e){const t=this.selectedTags.indexOf(e);t>=0?this.selectedTags.splice(t,1):this.selectedTags.push(e),await this.reloadAndRefresh()}async loadData(){this.allTags=await this.props.database.cards.getAllTags(),this.allCards=await this.props.database.cards.getAll()}async reloadAndRefresh(){await this.loadData(),await this.tagList.setData(this.allTags,this.selectedTags),await this.cardList.setData(this.filteredCards)}async clear(){this.cardEditorModal.clear(),this.tagList.clear(),this.cardList.clear(),this.container.innerHTML=""}}const ea=document.createElement("template");ea.innerHTML=`
  <div id="card-viewer">
    <div id="card-viewer-question"></div>
    <hr id="card-viewer-separator" class="hidden" />
    <div id="card-viewer-answer" class="hidden"></div>
  </div>
`;class ep extends bt{questionEditor;answerEditor;answerEditorEl;separatorEl;isFlipped=!1;async draw(){this.container.appendChild(ea.content.cloneNode(!0)),this.answerEditorEl=se.findElementByIdOrFail("card-viewer-answer"),this.separatorEl=se.findElementByIdOrFail("card-viewer-separator"),this.questionEditor=new un({containerId:"card-viewer-question",initialData:this.props.card.question,readOnly:!0,onImageGet:this.props.onImageGet}),await this.questionEditor.init(),this.answerEditor=new un({containerId:"card-viewer-answer",initialData:this.props.card.answer,readOnly:!0,onImageGet:this.props.onImageGet}),await this.answerEditor.init(),document.querySelectorAll(".codex-editor__loader").forEach(e=>{e instanceof HTMLElement&&e.style.setProperty("height","10px","important")}),document.querySelectorAll(".codex-editor__redactor").forEach(e=>{e instanceof HTMLElement&&e.style.setProperty("padding-bottom","10px","important")})}async setCardData(e){await this.questionEditor.setData(e.question),await this.answerEditor.setData(e.answer)}async clear(){this.questionEditor.destroy(),this.answerEditor.destroy(),this.container.innerHTML=""}async flip(){this.isFlipped=!this.isFlipped,this.answerEditorEl.classList.toggle("hidden"),this.separatorEl.classList.toggle("hidden")}}const ta=document.createElement("template");ta.innerHTML=`
  <div id="learn-page-container">
    <header>
      <button id="back-btn" class="icon-button">
        <img src="icons/back.svg" />
      </button>
      <div class="learning-progress-card-counter">
        <span id="learning-progress-done-count">0</span><span id="learning-progress-all-count">/0</span>
      </div>
      <div id="learning-progress-bar-container">
        <div id="learning-progress-bar"></div>
      </div>
    </header>
    <section id="card-viewer-container"></section>
    <footer>
      <button id="flip-btn" class="icon-button">
        <img src="icons/show.svg" />
      </button>
      <div id="learning-progress-response-buttons">
        <button id="again-btn" class="icon-button">
          <img src="icons/hard.svg" />
        </button>
        <button id="ok-btn" class="icon-button">
          <img src="icons/ok.svg" />
        </button>
        <button id="easy-btn" class="icon-button">
          <img src="icons/easy.svg" />
        </button>
      </div>
    </footer>
  </div>
`;class tp extends Xs{cardViewer;barEl;doneCountEl;allCountEl;async draw(){this.container.appendChild(ta.content.cloneNode(!0)),this.barEl=se.findElementByIdOrFail("learning-progress-bar"),this.doneCountEl=se.findElementByIdOrFail("learning-progress-done-count"),this.allCountEl=se.findElementByIdOrFail("learning-progress-all-count"),se.findElementByIdOrFail("flip-btn").addEventListener("click",async()=>{this.cardViewer?.flip()}),se.findElementByIdOrFail("again-btn").addEventListener("click",async()=>{await this.loadNextCard()}),se.findElementByIdOrFail("ok-btn").addEventListener("click",async()=>{const s=ft.popNext();ft.addToQueue(s),await this.loadNextCard()}),se.findElementByIdOrFail("easy-btn").addEventListener("click",async()=>{ft.popNext(),await this.loadNextCard()}),se.findElementByIdOrFail("back-btn").addEventListener("click",async()=>{await this.props.router.navigate("/")}),await this.loadNextCard()}updateStats(){const e=ft.getStats();let t=e.done/e.total*100;t===0&&(t=3),this.barEl.style.width=`${t}%`,this.doneCountEl.textContent=`${e.done}`,this.allCountEl.textContent=`/${e.total}`}async loadNextCard(){this.updateStats();const e=ft.queueCardIds;if(e.length===0){se.findElementByIdOrFail("card-viewer-container").classList.add("hidden"),this.container.querySelector("footer").classList.add("hidden");return}this.cardViewer&&this.cardViewer.isFlipped&&this.cardViewer.flip();const t=await this.props.database.cards.get(e[0]);this.cardViewer?this.cardViewer.setCardData(t):(this.cardViewer=new ep(se.findElementByIdOrFail("card-viewer-container"),{card:t,onImageGet:async n=>await this.props.database.images.get(n)}),await this.cardViewer.draw())}async clear(){await this.cardViewer?.clear(),this.container.innerHTML=""}}const np=[{name:"cards",options:{keyPath:"id",autoIncrement:!0}},{name:"images",options:{keyPath:"id",autoIncrement:!0}}];function dt(r){return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}class na{db;storeName;constructor(e,t){this.db=e,this.storeName=t}txn(e="readonly"){return this.db.transaction(this.storeName,e).objectStore(this.storeName)}add(e){const t=this.txn("readwrite");return dt(t.add(e))}put(e){const t=this.txn("readwrite");return dt(t.put(e))}get(e){const t=this.txn("readonly");return dt(t.get(e))}getAll(){const e=this.txn("readonly");return dt(e.getAll())}delete(e){const t=this.txn("readwrite");return dt(t.delete(e))}clear(){const e=this.txn("readwrite");return dt(e.clear())}}class rp extends na{constructor(e){super(e,"cards")}async getAllTags(){const e=await this.getAll(),t=new Set;return e.forEach(n=>{Array.isArray(n.tags)&&n.tags.forEach(o=>t.add(o))}),[...t].sort()}}class op extends na{constructor(e){super(e,"images")}}class ip{constructor(e="app-db",t=1){this.name=e,this.version=t}db;async open(){return this.db=await new Promise((e,t)=>{const n=indexedDB.open(this.name,this.version);n.onupgradeneeded=o=>{const i=o.target.result;np.forEach(s=>{i.objectStoreNames.contains(s.name)||i.createObjectStore(s.name,s.options)})},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)}),this}close(){this.db.close()}get cards(){return new rp(this.db)}get images(){return new op(this.db)}}var $t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ut(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Un={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var li;function ap(){return li||(li=1,function(r,e){(function(t){r.exports=t()})(function(){return function t(n,o,i){function s(c,f){if(!o[c]){if(!n[c]){var h=typeof Ut=="function"&&Ut;if(!f&&h)return h(c,!0);if(a)return a(c,!0);var y=new Error("Cannot find module '"+c+"'");throw y.code="MODULE_NOT_FOUND",y}var p=o[c]={exports:{}};n[c][0].call(p.exports,function(v){var d=n[c][1][v];return s(d||v)},p,p.exports,t,n,o,i)}return o[c].exports}for(var a=typeof Ut=="function"&&Ut,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(t,n,o){var i=t("./utils"),s=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var c,f,h,y,p,v,d,m=[],b=0,k=l.length,E=k,S=i.getTypeOf(l)!=="string";b<l.length;)E=k-b,h=S?(c=l[b++],f=b<k?l[b++]:0,b<k?l[b++]:0):(c=l.charCodeAt(b++),f=b<k?l.charCodeAt(b++):0,b<k?l.charCodeAt(b++):0),y=c>>2,p=(3&c)<<4|f>>4,v=1<E?(15&f)<<2|h>>6:64,d=2<E?63&h:64,m.push(a.charAt(y)+a.charAt(p)+a.charAt(v)+a.charAt(d));return m.join("")},o.decode=function(l){var c,f,h,y,p,v,d=0,m=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var k,E=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&E--,l.charAt(l.length-2)===a.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=s.uint8array?new Uint8Array(0|E):new Array(0|E);d<l.length;)c=a.indexOf(l.charAt(d++))<<2|(y=a.indexOf(l.charAt(d++)))>>4,f=(15&y)<<4|(p=a.indexOf(l.charAt(d++)))>>2,h=(3&p)<<6|(v=a.indexOf(l.charAt(d++))),k[m++]=c,p!==64&&(k[m++]=f),v!==64&&(k[m++]=h);return k}},{"./support":30,"./utils":32}],2:[function(t,n,o){var i=t("./external"),s=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(f,h,y,p,v){this.compressedSize=f,this.uncompressedSize=h,this.crc32=y,this.compression=p,this.compressedContent=v}c.prototype={getContentWorker:function(){var f=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return f.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(f,h,y){return f.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(y)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,o){var i=t("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,o){var i=t("./utils"),s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(c,f,h,y){var p=s,v=y+h;c^=-1;for(var d=y;d<v;d++)c=c>>>8^p[255&(c^f[d])];return-1^c}(0|l,a,a.length,0):function(c,f,h,y){var p=s,v=y+h;c^=-1;for(var d=y;d<v;d++)c=c>>>8^p[255&(c^f.charCodeAt(d))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(t,n,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(t,n,o){var i=null;i=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:i}},{lie:37}],7:[function(t,n,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),c=i?"uint8array":"array";function f(h,y){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=y,this.meta={}}o.magic="\b\0",a.inherits(f,l),f.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,h.data),!1)},f.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(y){h.push({data:y,meta:h.meta})}},o.compressWorker=function(h){return new f("Deflate",h)},o.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,o){function i(p,v){var d,m="";for(d=0;d<v;d++)m+=String.fromCharCode(255&p),p>>>=8;return m}function s(p,v,d,m,b,k){var E,S,C=p.file,L=p.compression,N=k!==c.utf8encode,O=a.transformTo("string",k(C.name)),T=a.transformTo("string",c.utf8encode(C.name)),j=C.comment,Z=a.transformTo("string",k(j)),_=a.transformTo("string",c.utf8encode(j)),A=T.length!==C.name.length,g=_.length!==j.length,P="",X="",U="",ne=C.dir,W=C.date,ee={crc32:0,compressedSize:0,uncompressedSize:0};v&&!d||(ee.crc32=p.crc32,ee.compressedSize=p.compressedSize,ee.uncompressedSize=p.uncompressedSize);var R=0;v&&(R|=8),N||!A&&!g||(R|=2048);var M=0,Q=0;ne&&(M|=16),b==="UNIX"?(Q=798,M|=function(Y,ge){var xe=Y;return Y||(xe=ge?16893:33204),(65535&xe)<<16}(C.unixPermissions,ne)):(Q=20,M|=function(Y){return 63&(Y||0)}(C.dosPermissions)),E=W.getUTCHours(),E<<=6,E|=W.getUTCMinutes(),E<<=5,E|=W.getUTCSeconds()/2,S=W.getUTCFullYear()-1980,S<<=4,S|=W.getUTCMonth()+1,S<<=5,S|=W.getUTCDate(),A&&(X=i(1,1)+i(f(O),4)+T,P+="up"+i(X.length,2)+X),g&&(U=i(1,1)+i(f(Z),4)+_,P+="uc"+i(U.length,2)+U);var V="";return V+=`
\0`,V+=i(R,2),V+=L.magic,V+=i(E,2),V+=i(S,2),V+=i(ee.crc32,4),V+=i(ee.compressedSize,4),V+=i(ee.uncompressedSize,4),V+=i(O.length,2),V+=i(P.length,2),{fileRecord:h.LOCAL_FILE_HEADER+V+O+P,dirRecord:h.CENTRAL_FILE_HEADER+i(Q,2)+V+i(Z.length,2)+"\0\0\0\0"+i(M,4)+i(m,4)+O+P+Z}}var a=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),f=t("../crc32"),h=t("../signature");function y(p,v,d,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=d,this.encodeFileName=m,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(y,l),y.prototype.push=function(p){var v=p.meta.percent||0,d=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,l.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:d?(v+100*(d-m-1))/d:100}}))},y.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var v=this.streamFiles&&!p.file.dir;if(v){var d=s(p,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(p){this.accumulate=!1;var v=this.streamFiles&&!p.file.dir,d=s(p,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),v)this.push({data:function(m){return h.DATA_DESCRIPTOR+i(m.crc32,4)+i(m.compressedSize,4)+i(m.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var p=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var d=this.bytesWritten-p,m=function(b,k,E,S,C){var L=a.transformTo("string",C(S));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(b,2)+i(b,2)+i(k,4)+i(E,4)+i(L.length,2)+L}(this.dirRecords.length,d,p,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(p){this._sources.push(p);var v=this;return p.on("data",function(d){v.processChunk(d)}),p.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),p.on("error",function(d){v.error(d)}),this},y.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(p){var v=this._sources;if(!l.prototype.error.call(this,p))return!1;for(var d=0;d<v.length;d++)try{v[d].error(p)}catch{}return!0},y.prototype.lock=function(){l.prototype.lock.call(this);for(var p=this._sources,v=0;v<p.length;v++)p[v].lock()},n.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,o){var i=t("../compressions"),s=t("./ZipFileWorker");o.generateWorker=function(a,l,c){var f=new s(l.streamFiles,c,l.platform,l.encodeFileName),h=0;try{a.forEach(function(y,p){h++;var v=function(k,E){var S=k||E,C=i[S];if(!C)throw new Error(S+" is not a valid compression method !");return C}(p.options.compression,l.compression),d=p.options.compressionOptions||l.compressionOptions||{},m=p.dir,b=p.date;p._compressWorker(v,d).withStreamInfo("file",{name:y,dir:m,date:b,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(f)}),f.entriesCount=h}catch(y){f.error(y)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,a){return new i().loadAsync(s,a)},i.external=t("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,o){var i=t("./utils"),s=t("./external"),a=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),f=t("./nodejsUtils");function h(y){return new s.Promise(function(p,v){var d=y.decompressed.getContentWorker().pipe(new c);d.on("error",function(m){v(m)}).on("end",function(){d.streamInfo.crc32!==y.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(y,p){var v=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),f.isNode&&f.isStream(y)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",y,!0,p.optimizedBinaryString,p.base64).then(function(d){var m=new l(p);return m.load(d),m}).then(function(d){var m=[s.Promise.resolve(d)],b=d.files;if(p.checkCRC32)for(var k=0;k<b.length;k++)m.push(h(b[k]));return s.Promise.all(m)}).then(function(d){for(var m=d.shift(),b=m.files,k=0;k<b.length;k++){var E=b[k],S=E.fileNameStr,C=i.resolve(E.fileNameStr);v.file(C,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:p.createFolders}),E.dir||(v.file(C).unsafeOriginalName=S)}return m.zipComment.length&&(v.comment=m.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,o){var i=t("../utils"),s=t("../stream/GenericWorker");function a(l,c){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(a,s),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(f){c.push({data:f,meta:{percent:0}})}).on("error",function(f){c.isPaused?this.generatedError=f:c.error(f)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,o){var i=t("readable-stream").Readable;function s(a,l,c){i.call(this,l),this._helper=a;var f=this;a.on("data",function(h,y){f.push(h)||f._helper.pause(),c&&c(y)}).on("error",function(h){f.emit("error",h)}).on("end",function(){f.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,n,o){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,n,o){function i(C,L,N){var O,T=a.getTypeOf(L),j=a.extend(N||{},f);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(C=b(C)),j.createFolders&&(O=m(C))&&k.call(this,O,!0);var Z=T==="string"&&j.binary===!1&&j.base64===!1;N&&N.binary!==void 0||(j.binary=!Z),(L instanceof h&&L.uncompressedSize===0||j.dir||!L||L.length===0)&&(j.base64=!1,j.binary=!0,L="",j.compression="STORE",T="string");var _=null;_=L instanceof h||L instanceof l?L:v.isNode&&v.isStream(L)?new d(C,L):a.prepareContent(C,L,j.binary,j.optimizedBinaryString,j.base64);var A=new y(C,_,j);this.files[C]=A}var s=t("./utf8"),a=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),f=t("./defaults"),h=t("./compressedObject"),y=t("./zipObject"),p=t("./generate"),v=t("./nodejsUtils"),d=t("./nodejs/NodejsStreamInputAdapter"),m=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var L=C.lastIndexOf("/");return 0<L?C.substring(0,L):""},b=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},k=function(C,L){return L=L!==void 0?L:f.createFolders,C=b(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:L}),this.files[C]};function E(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var L,N,O;for(L in this.files)O=this.files[L],(N=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&C(N,O)},filter:function(C){var L=[];return this.forEach(function(N,O){C(N,O)&&L.push(O)}),L},file:function(C,L,N){if(arguments.length!==1)return C=this.root+C,i.call(this,C,L,N),this;if(E(C)){var O=C;return this.filter(function(j,Z){return!Z.dir&&O.test(j)})}var T=this.files[this.root+C];return T&&!T.dir?T:null},folder:function(C){if(!C)return this;if(E(C))return this.filter(function(T,j){return j.dir&&C.test(T)});var L=this.root+C,N=k.call(this,L),O=this.clone();return O.root=N.name,O},remove:function(C){C=this.root+C;var L=this.files[C];if(L||(C.slice(-1)!=="/"&&(C+="/"),L=this.files[C]),L&&!L.dir)delete this.files[C];else for(var N=this.filter(function(T,j){return j.name.slice(0,C.length)===C}),O=0;O<N.length;O++)delete this.files[N[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var L,N={};try{if((N=a.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");a.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var O=N.comment||this.comment||"";L=p.generateWorker(this,N,O)}catch(T){(L=new l("error")).error(T)}return new c(L,N.type||"string",N.mimeType)},generateAsync:function(C,L){return this.generateInternalStream(C).accumulate(L)},generateNodeStream:function(C,L){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(L)}};n.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,o){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,o){var i=t("./DataReader");function s(a){i.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}t("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),f=a.charCodeAt(2),h=a.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===l&&this.data[y+1]===c&&this.data[y+2]===f&&this.data[y+3]===h)return y-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),f=a.charCodeAt(2),h=a.charCodeAt(3),y=this.readData(4);return l===y[0]&&c===y[1]&&f===y[2]&&h===y[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,n,o){var i=t("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=s},{"../utils":32}],19:[function(t,n,o){var i=t("./Uint8ArrayReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,o){var i=t("./DataReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,n,o){var i=t("./ArrayReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,o){var i=t("../utils"),s=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),f=t("./Uint8ArrayReader");n.exports=function(h){var y=i.getTypeOf(h);return i.checkSupport(y),y!=="string"||s.uint8array?y==="nodebuffer"?new c(h):s.uint8array?new f(i.transformTo("uint8array",h)):new a(i.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,o){var i=t("./GenericWorker"),s=t("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,o){var i=t("./GenericWorker"),s=t("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,i),a.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,o){var i=t("../utils"),s=t("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,s),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,o){var i=t("../utils"),s=t("./GenericWorker");function a(l){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(f){c.dataIsReady=!0,c.data=f,c.max=f&&f.length||0,c.type=i.getTypeOf(f),c.isPaused||c._tickAndRepeat()},function(f){c.error(f)})}i.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,o){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(t,n,o){var i=t("../utils"),s=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),c=t("../support"),f=t("../external"),h=null;if(c.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(v,d){return new f.Promise(function(m,b){var k=[],E=v._internalType,S=v._outputType,C=v._mimeType;v.on("data",function(L,N){k.push(L),d&&d(N)}).on("error",function(L){k=[],b(L)}).on("end",function(){try{var L=function(N,O,T){switch(N){case"blob":return i.newBlob(i.transformTo("arraybuffer",O),T);case"base64":return l.encode(O);default:return i.transformTo(N,O)}}(S,function(N,O){var T,j=0,Z=null,_=0;for(T=0;T<O.length;T++)_+=O[T].length;switch(N){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(Z=new Uint8Array(_),T=0;T<O.length;T++)Z.set(O[T],j),j+=O[T].length;return Z;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+N+"'")}}(E,k),C);m(L)}catch(N){b(N)}k=[]}).resume()})}function p(v,d,m){var b=d;switch(d){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=d,this._mimeType=m,i.checkSupport(b),this._worker=v.pipe(new s(b)),v.lock()}catch(k){this._worker=new a("error"),this._worker.error(k)}}p.prototype={accumulate:function(v){return y(this,v)},on:function(v,d){var m=this;return v==="data"?this._worker.on(v,function(b){d.call(m,b.data,b.meta)}):this._worker.on(v,function(){i.delay(d,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),o.blob=s.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!t("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,o){for(var i=t("./utils"),s=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;c[254]=c[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function y(){l.call(this,"utf-8 encode")}o.utf8encode=function(p){return s.nodebuffer?a.newBufferFrom(p,"utf-8"):function(v){var d,m,b,k,E,S=v.length,C=0;for(k=0;k<S;k++)(64512&(m=v.charCodeAt(k)))==55296&&k+1<S&&(64512&(b=v.charCodeAt(k+1)))==56320&&(m=65536+(m-55296<<10)+(b-56320),k++),C+=m<128?1:m<2048?2:m<65536?3:4;for(d=s.uint8array?new Uint8Array(C):new Array(C),k=E=0;E<C;k++)(64512&(m=v.charCodeAt(k)))==55296&&k+1<S&&(64512&(b=v.charCodeAt(k+1)))==56320&&(m=65536+(m-55296<<10)+(b-56320),k++),m<128?d[E++]=m:(m<2048?d[E++]=192|m>>>6:(m<65536?d[E++]=224|m>>>12:(d[E++]=240|m>>>18,d[E++]=128|m>>>12&63),d[E++]=128|m>>>6&63),d[E++]=128|63&m);return d}(p)},o.utf8decode=function(p){return s.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):function(v){var d,m,b,k,E=v.length,S=new Array(2*E);for(d=m=0;d<E;)if((b=v[d++])<128)S[m++]=b;else if(4<(k=c[b]))S[m++]=65533,d+=k-1;else{for(b&=k===2?31:k===3?15:7;1<k&&d<E;)b=b<<6|63&v[d++],k--;1<k?S[m++]=65533:b<65536?S[m++]=b:(b-=65536,S[m++]=55296|b>>10&1023,S[m++]=56320|1023&b)}return S.length!==m&&(S.subarray?S=S.subarray(0,m):S.length=m),i.applyFromCharCode(S)}(p=i.transformTo(s.uint8array?"uint8array":"array",p))},i.inherits(h,l),h.prototype.processChunk=function(p){var v=i.transformTo(s.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var d=v;(v=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),v.set(d,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var m=function(k,E){var S;for((E=E||k.length)>k.length&&(E=k.length),S=E-1;0<=S&&(192&k[S])==128;)S--;return S<0||S===0?E:S+c[k[S]]>E?S:E}(v),b=v;m!==v.length&&(s.uint8array?(b=v.subarray(0,m),this.leftOver=v.subarray(m,v.length)):(b=v.slice(0,m),this.leftOver=v.slice(m,v.length))),this.push({data:o.utf8decode(b),meta:p.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=h,i.inherits(y,l),y.prototype.processChunk=function(p){this.push({data:o.utf8encode(p.data),meta:p.meta})},o.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,o){var i=t("./support"),s=t("./base64"),a=t("./nodejsUtils"),l=t("./external");function c(d){return d}function f(d,m){for(var b=0;b<d.length;++b)m[b]=255&d.charCodeAt(b);return m}t("setimmediate"),o.newBlob=function(d,m){o.checkSupport("blob");try{return new Blob([d],{type:m})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(d),b.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(d,m,b){var k=[],E=0,S=d.length;if(S<=b)return String.fromCharCode.apply(null,d);for(;E<S;)m==="array"||m==="nodebuffer"?k.push(String.fromCharCode.apply(null,d.slice(E,Math.min(E+b,S)))):k.push(String.fromCharCode.apply(null,d.subarray(E,Math.min(E+b,S)))),E+=b;return k.join("")},stringifyByChar:function(d){for(var m="",b=0;b<d.length;b++)m+=String.fromCharCode(d[b]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function y(d){var m=65536,b=o.getTypeOf(d),k=!0;if(b==="uint8array"?k=h.applyCanBeUsed.uint8array:b==="nodebuffer"&&(k=h.applyCanBeUsed.nodebuffer),k)for(;1<m;)try{return h.stringifyByChunk(d,b,m)}catch{m=Math.floor(m/2)}return h.stringifyByChar(d)}function p(d,m){for(var b=0;b<d.length;b++)m[b]=d[b];return m}o.applyFromCharCode=y;var v={};v.string={string:c,array:function(d){return f(d,new Array(d.length))},arraybuffer:function(d){return v.string.uint8array(d).buffer},uint8array:function(d){return f(d,new Uint8Array(d.length))},nodebuffer:function(d){return f(d,a.allocBuffer(d.length))}},v.array={string:y,array:c,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(d)}},v.arraybuffer={string:function(d){return y(new Uint8Array(d))},array:function(d){return p(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:c,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(new Uint8Array(d))}},v.uint8array={string:y,array:function(d){return p(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:c,nodebuffer:function(d){return a.newBufferFrom(d)}},v.nodebuffer={string:y,array:function(d){return p(d,new Array(d.length))},arraybuffer:function(d){return v.nodebuffer.uint8array(d).buffer},uint8array:function(d){return p(d,new Uint8Array(d.length))},nodebuffer:c},o.transformTo=function(d,m){if(m=m||"",!d)return m;o.checkSupport(d);var b=o.getTypeOf(m);return v[b][d](m)},o.resolve=function(d){for(var m=d.split("/"),b=[],k=0;k<m.length;k++){var E=m[k];E==="."||E===""&&k!==0&&k!==m.length-1||(E===".."?b.pop():b.push(E))}return b.join("/")},o.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(d)?"nodebuffer":i.uint8array&&d instanceof Uint8Array?"uint8array":i.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(d){if(!i[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(d){var m,b,k="";for(b=0;b<(d||"").length;b++)k+="\\x"+((m=d.charCodeAt(b))<16?"0":"")+m.toString(16).toUpperCase();return k},o.delay=function(d,m,b){setImmediate(function(){d.apply(b||null,m||[])})},o.inherits=function(d,m){function b(){}b.prototype=m.prototype,d.prototype=new b},o.extend=function(){var d,m,b={};for(d=0;d<arguments.length;d++)for(m in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],m)&&b[m]===void 0&&(b[m]=arguments[d][m]);return b},o.prepareContent=function(d,m,b,k,E){return l.Promise.resolve(m).then(function(S){return i.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,L){var N=new FileReader;N.onload=function(O){C(O.target.result)},N.onerror=function(O){L(O.target.error)},N.readAsArrayBuffer(S)}):S}).then(function(S){var C=o.getTypeOf(S);return C?(C==="arraybuffer"?S=o.transformTo("uint8array",S):C==="string"&&(E?S=s.decode(S):b&&k!==!0&&(S=function(L){return f(L,i.uint8array?new Uint8Array(L.length):new Array(L.length))}(S))),S):l.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,o){var i=t("./reader/readerFor"),s=t("./utils"),a=t("./signature"),l=t("./zipEntry"),c=t("./support");function f(h){this.files=[],this.loadOptions=h}f.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(y)+", expected "+s.pretty(h)+")")}},isSignature:function(h,y){var p=this.reader.index;this.reader.setIndex(h);var v=this.reader.readString(4)===y;return this.reader.setIndex(p),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),y=c.uint8array?"uint8array":"array",p=s.transformTo(y,h);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,y,p,v=this.zip64EndOfCentralSize-44;0<v;)h=this.reader.readInt(2),y=this.reader.readInt(4),p=this.reader.readData(y),this.zip64ExtensibleData[h]={id:h,length:y,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,y;for(h=0;h<this.files.length;h++)y=this.files[h],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var y=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var v=y-p;if(0<v)this.isSignature(y,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,o){var i=t("./reader/readerFor"),s=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),f=t("./compressions"),h=t("./support");function y(p,v){this.options=p,this.loadOptions=v}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var v,d;if(p.skip(22),this.fileNameLength=p.readInt(2),d=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(m){for(var b in f)if(Object.prototype.hasOwnProperty.call(f,b)&&f[b].magic===m)return f[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var v=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(v),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var v,d,m,b=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<b;)v=p.readInt(2),d=p.readInt(2),m=p.readData(d),this.extraFields[v]={id:v,length:d,value:m};p.setIndex(b)},handleUTF8:function(){var p=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var d=s.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var b=s.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var v=i(p.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:c.utf8decode(v.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var v=i(p.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:c.utf8decode(v.readData(p.length-5))}return null}},n.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,o){function i(v,d,m){this.name=v,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=d,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),f=t("./stream/GenericWorker");i.prototype={internalStream:function(v){var d=null,m="string";try{if(!v)throw new Error("No output type specified.");var b=(m=v.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),d=this._decompressWorker();var k=!this._dataBinary;k&&!b&&(d=d.pipe(new l.Utf8EncodeWorker)),!k&&b&&(d=d.pipe(new l.Utf8DecodeWorker))}catch(E){(d=new f("error")).error(E)}return new s(d,m,"")},async:function(v,d){return this.internalStream(v).accumulate(d)},nodeStream:function(v,d){return this.internalStream(v||"nodebuffer").toNodejsStream(d)},_compressWorker:function(v,d){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(m,v,d)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof f?this._data:new a(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<h.length;p++)i.prototype[h[p]]=y;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,o){(function(i){var s,a,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,f=new l(v),h=i.document.createTextNode("");f.observe(h,{characterData:!0}),s=function(){h.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var d=i.document.createElement("script");d.onreadystatechange=function(){v(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},i.document.documentElement.appendChild(d)}:function(){setTimeout(v,0)};else{var y=new i.MessageChannel;y.port1.onmessage=v,s=function(){y.port2.postMessage(0)}}var p=[];function v(){var d,m;a=!0;for(var b=p.length;b;){for(m=p,p=[],d=-1;++d<b;)m[d]();b=p.length}a=!1}n.exports=function(d){p.push(d)!==1||a||s()}}).call(this,typeof $t<"u"?$t:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,o){var i=t("immediate");function s(){}var a={},l=["REJECTED"],c=["FULFILLED"],f=["PENDING"];function h(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,b!==s&&d(this,b)}function y(b,k,E){this.promise=b,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function p(b,k,E){i(function(){var S;try{S=k(E)}catch(C){return a.reject(b,C)}S===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,S)})}function v(b){var k=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof k=="function")return function(){k.apply(b,arguments)}}function d(b,k){var E=!1;function S(N){E||(E=!0,a.reject(b,N))}function C(N){E||(E=!0,a.resolve(b,N))}var L=m(function(){k(C,S)});L.status==="error"&&S(L.value)}function m(b,k){var E={};try{E.value=b(k),E.status="success"}catch(S){E.status="error",E.value=S}return E}(n.exports=h).prototype.finally=function(b){if(typeof b!="function")return this;var k=this.constructor;return this.then(function(E){return k.resolve(b()).then(function(){return E})},function(E){return k.resolve(b()).then(function(){throw E})})},h.prototype.catch=function(b){return this.then(null,b)},h.prototype.then=function(b,k){if(typeof b!="function"&&this.state===c||typeof k!="function"&&this.state===l)return this;var E=new this.constructor(s);return this.state!==f?p(E,this.state===c?b:k,this.outcome):this.queue.push(new y(E,b,k)),E},y.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},y.prototype.otherCallFulfilled=function(b){p(this.promise,this.onFulfilled,b)},y.prototype.callRejected=function(b){a.reject(this.promise,b)},y.prototype.otherCallRejected=function(b){p(this.promise,this.onRejected,b)},a.resolve=function(b,k){var E=m(v,k);if(E.status==="error")return a.reject(b,E.value);var S=E.value;if(S)d(b,S);else{b.state=c,b.outcome=k;for(var C=-1,L=b.queue.length;++C<L;)b.queue[C].callFulfilled(k)}return b},a.reject=function(b,k){b.state=l,b.outcome=k;for(var E=-1,S=b.queue.length;++E<S;)b.queue[E].callRejected(k);return b},h.resolve=function(b){return b instanceof this?b:a.resolve(new this(s),b)},h.reject=function(b){var k=new this(s);return a.reject(k,b)},h.all=function(b){var k=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=b.length,S=!1;if(!E)return this.resolve([]);for(var C=new Array(E),L=0,N=-1,O=new this(s);++N<E;)T(b[N],N);return O;function T(j,Z){k.resolve(j).then(function(_){C[Z]=_,++L!==E||S||(S=!0,a.resolve(O,C))},function(_){S||(S=!0,a.reject(O,_))})}},h.race=function(b){var k=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=b.length,S=!1;if(!E)return this.resolve([]);for(var C=-1,L=new this(s);++C<E;)N=b[C],k.resolve(N).then(function(O){S||(S=!0,a.resolve(L,O))},function(O){S||(S=!0,a.reject(L,O))});var N;return L}},{immediate:36}],38:[function(t,n,o){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,o){var i=t("./zlib/deflate"),s=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),f=Object.prototype.toString,h=0,y=-1,p=0,v=8;function d(b){if(!(this instanceof d))return new d(b);this.options=s.assign({level:y,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},b||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var E=i.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(E!==h)throw new Error(l[E]);if(k.header&&i.deflateSetHeader(this.strm,k.header),k.dictionary){var S;if(S=typeof k.dictionary=="string"?a.string2buf(k.dictionary):f.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(E=i.deflateSetDictionary(this.strm,S))!==h)throw new Error(l[E]);this._dict_set=!0}}function m(b,k){var E=new d(k);if(E.push(b,!0),E.err)throw E.msg||l[E.err];return E.result}d.prototype.push=function(b,k){var E,S,C=this.strm,L=this.options.chunkSize;if(this.ended)return!1;S=k===~~k?k:k===!0?4:0,typeof b=="string"?C.input=a.string2buf(b):f.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new s.Buf8(L),C.next_out=0,C.avail_out=L),(E=i.deflate(C,S))!==1&&E!==h)return this.onEnd(E),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(C.output,C.next_out))):this.onData(s.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&E!==1);return S===4?(E=i.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===h):S!==2||(this.onEnd(h),!(C.avail_out=0))},d.prototype.onData=function(b){this.chunks.push(b)},d.prototype.onEnd=function(b){b===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},o.Deflate=d,o.deflate=m,o.deflateRaw=function(b,k){return(k=k||{}).raw=!0,m(b,k)},o.gzip=function(b,k){return(k=k||{}).gzip=!0,m(b,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,o){var i=t("./zlib/inflate"),s=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),f=t("./zlib/zstream"),h=t("./zlib/gzheader"),y=Object.prototype.toString;function p(d){if(!(this instanceof p))return new p(d);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},d||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||d&&d.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var b=i.inflateInit2(this.strm,m.windowBits);if(b!==l.Z_OK)throw new Error(c[b]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function v(d,m){var b=new p(m);if(b.push(d,!0),b.err)throw b.msg||c[b.err];return b.result}p.prototype.push=function(d,m){var b,k,E,S,C,L,N=this.strm,O=this.options.chunkSize,T=this.options.dictionary,j=!1;if(this.ended)return!1;k=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof d=="string"?N.input=a.binstring2buf(d):y.call(d)==="[object ArrayBuffer]"?N.input=new Uint8Array(d):N.input=d,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new s.Buf8(O),N.next_out=0,N.avail_out=O),(b=i.inflate(N,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&T&&(L=typeof T=="string"?a.string2buf(T):y.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,b=i.inflateSetDictionary(this.strm,L)),b===l.Z_BUF_ERROR&&j===!0&&(b=l.Z_OK,j=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&b!==l.Z_STREAM_END&&(N.avail_in!==0||k!==l.Z_FINISH&&k!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=a.utf8border(N.output,N.next_out),S=N.next_out-E,C=a.buf2string(N.output,E),N.next_out=S,N.avail_out=O-S,S&&s.arraySet(N.output,N.output,E,S,0),this.onData(C)):this.onData(s.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(j=!0)}while((0<N.avail_in||N.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(k=l.Z_FINISH),k===l.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):k!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(N.avail_out=0))},p.prototype.onData=function(d){this.chunks.push(d)},p.prototype.onEnd=function(d){d===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},o.Inflate=p,o.inflate=v,o.inflateRaw=function(d,m){return(m=m||{}).raw=!0,v(d,m)},o.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var f=c.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var h in f)f.hasOwnProperty(h)&&(l[h]=f[h])}}return l},o.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var s={arraySet:function(l,c,f,h,y){if(c.subarray&&l.subarray)l.set(c.subarray(f,f+h),y);else for(var p=0;p<h;p++)l[y+p]=c[f+p]},flattenChunks:function(l){var c,f,h,y,p,v;for(c=h=0,f=l.length;c<f;c++)h+=l[c].length;for(v=new Uint8Array(h),c=y=0,f=l.length;c<f;c++)p=l[c],v.set(p,y),y+=p.length;return v}},a={arraySet:function(l,c,f,h,y){for(var p=0;p<h;p++)l[y+p]=c[f+p]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,s)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,a))},o.setTyped(i)},{}],42:[function(t,n,o){var i=t("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function f(h,y){if(y<65537&&(h.subarray&&a||!h.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(h,y));for(var p="",v=0;v<y;v++)p+=String.fromCharCode(h[v]);return p}l[254]=l[254]=1,o.string2buf=function(h){var y,p,v,d,m,b=h.length,k=0;for(d=0;d<b;d++)(64512&(p=h.charCodeAt(d)))==55296&&d+1<b&&(64512&(v=h.charCodeAt(d+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),d++),k+=p<128?1:p<2048?2:p<65536?3:4;for(y=new i.Buf8(k),d=m=0;m<k;d++)(64512&(p=h.charCodeAt(d)))==55296&&d+1<b&&(64512&(v=h.charCodeAt(d+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),d++),p<128?y[m++]=p:(p<2048?y[m++]=192|p>>>6:(p<65536?y[m++]=224|p>>>12:(y[m++]=240|p>>>18,y[m++]=128|p>>>12&63),y[m++]=128|p>>>6&63),y[m++]=128|63&p);return y},o.buf2binstring=function(h){return f(h,h.length)},o.binstring2buf=function(h){for(var y=new i.Buf8(h.length),p=0,v=y.length;p<v;p++)y[p]=h.charCodeAt(p);return y},o.buf2string=function(h,y){var p,v,d,m,b=y||h.length,k=new Array(2*b);for(p=v=0;p<b;)if((d=h[p++])<128)k[v++]=d;else if(4<(m=l[d]))k[v++]=65533,p+=m-1;else{for(d&=m===2?31:m===3?15:7;1<m&&p<b;)d=d<<6|63&h[p++],m--;1<m?k[v++]=65533:d<65536?k[v++]=d:(d-=65536,k[v++]=55296|d>>10&1023,k[v++]=56320|1023&d)}return f(k,v)},o.utf8border=function(h,y){var p;for((y=y||h.length)>h.length&&(y=h.length),p=y-1;0<=p&&(192&h[p])==128;)p--;return p<0||p===0?y:p+l[h[p]]>y?p:y}},{"./common":41}],43:[function(t,n,o){n.exports=function(i,s,a,l){for(var c=65535&i|0,f=i>>>16&65535|0,h=0;a!==0;){for(a-=h=2e3<a?2e3:a;f=f+(c=c+s[l++]|0)|0,--h;);c%=65521,f%=65521}return c|f<<16|0}},{}],44:[function(t,n,o){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,o){var i=function(){for(var s,a=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[l]=s}return a}();n.exports=function(s,a,l,c){var f=i,h=c+l;s^=-1;for(var y=c;y<h;y++)s=s>>>8^f[255&(s^a[y])];return-1^s}},{}],46:[function(t,n,o){var i,s=t("../utils/common"),a=t("./trees"),l=t("./adler32"),c=t("./crc32"),f=t("./messages"),h=0,y=4,p=0,v=-2,d=-1,m=4,b=2,k=8,E=9,S=286,C=30,L=19,N=2*S+1,O=15,T=3,j=258,Z=j+T+1,_=42,A=113,g=1,P=2,X=3,U=4;function ne(u,z){return u.msg=f[z],z}function W(u){return(u<<1)-(4<u?9:0)}function ee(u){for(var z=u.length;0<=--z;)u[z]=0}function R(u){var z=u.state,D=z.pending;D>u.avail_out&&(D=u.avail_out),D!==0&&(s.arraySet(u.output,z.pending_buf,z.pending_out,D,u.next_out),u.next_out+=D,z.pending_out+=D,u.total_out+=D,u.avail_out-=D,z.pending-=D,z.pending===0&&(z.pending_out=0))}function M(u,z){a._tr_flush_block(u,0<=u.block_start?u.block_start:-1,u.strstart-u.block_start,z),u.block_start=u.strstart,R(u.strm)}function Q(u,z){u.pending_buf[u.pending++]=z}function V(u,z){u.pending_buf[u.pending++]=z>>>8&255,u.pending_buf[u.pending++]=255&z}function Y(u,z){var D,x,w=u.max_chain_length,B=u.strstart,H=u.prev_length,$=u.nice_match,I=u.strstart>u.w_size-Z?u.strstart-(u.w_size-Z):0,q=u.window,G=u.w_mask,K=u.prev,J=u.strstart+j,de=q[B+H-1],ie=q[B+H];u.prev_length>=u.good_match&&(w>>=2),$>u.lookahead&&($=u.lookahead);do if(q[(D=z)+H]===ie&&q[D+H-1]===de&&q[D]===q[B]&&q[++D]===q[B+1]){B+=2,D++;do;while(q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&q[++B]===q[++D]&&B<J);if(x=j-(J-B),B=J-j,H<x){if(u.match_start=z,$<=(H=x))break;de=q[B+H-1],ie=q[B+H]}}while((z=K[z&G])>I&&--w!=0);return H<=u.lookahead?H:u.lookahead}function ge(u){var z,D,x,w,B,H,$,I,q,G,K=u.w_size;do{if(w=u.window_size-u.lookahead-u.strstart,u.strstart>=K+(K-Z)){for(s.arraySet(u.window,u.window,K,K,0),u.match_start-=K,u.strstart-=K,u.block_start-=K,z=D=u.hash_size;x=u.head[--z],u.head[z]=K<=x?x-K:0,--D;);for(z=D=K;x=u.prev[--z],u.prev[z]=K<=x?x-K:0,--D;);w+=K}if(u.strm.avail_in===0)break;if(H=u.strm,$=u.window,I=u.strstart+u.lookahead,q=w,G=void 0,G=H.avail_in,q<G&&(G=q),D=G===0?0:(H.avail_in-=G,s.arraySet($,H.input,H.next_in,G,I),H.state.wrap===1?H.adler=l(H.adler,$,G,I):H.state.wrap===2&&(H.adler=c(H.adler,$,G,I)),H.next_in+=G,H.total_in+=G,G),u.lookahead+=D,u.lookahead+u.insert>=T)for(B=u.strstart-u.insert,u.ins_h=u.window[B],u.ins_h=(u.ins_h<<u.hash_shift^u.window[B+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[B+T-1])&u.hash_mask,u.prev[B&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=B,B++,u.insert--,!(u.lookahead+u.insert<T)););}while(u.lookahead<Z&&u.strm.avail_in!==0)}function xe(u,z){for(var D,x;;){if(u.lookahead<Z){if(ge(u),u.lookahead<Z&&z===h)return g;if(u.lookahead===0)break}if(D=0,u.lookahead>=T&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+T-1])&u.hash_mask,D=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),D!==0&&u.strstart-D<=u.w_size-Z&&(u.match_length=Y(u,D)),u.match_length>=T)if(x=a._tr_tally(u,u.strstart-u.match_start,u.match_length-T),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=T){for(u.match_length--;u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+T-1])&u.hash_mask,D=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart,--u.match_length!=0;);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else x=a._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(x&&(M(u,!1),u.strm.avail_out===0))return g}return u.insert=u.strstart<T-1?u.strstart:T-1,z===y?(M(u,!0),u.strm.avail_out===0?X:U):u.last_lit&&(M(u,!1),u.strm.avail_out===0)?g:P}function oe(u,z){for(var D,x,w;;){if(u.lookahead<Z){if(ge(u),u.lookahead<Z&&z===h)return g;if(u.lookahead===0)break}if(D=0,u.lookahead>=T&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+T-1])&u.hash_mask,D=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=T-1,D!==0&&u.prev_length<u.max_lazy_match&&u.strstart-D<=u.w_size-Z&&(u.match_length=Y(u,D),u.match_length<=5&&(u.strategy===1||u.match_length===T&&4096<u.strstart-u.match_start)&&(u.match_length=T-1)),u.prev_length>=T&&u.match_length<=u.prev_length){for(w=u.strstart+u.lookahead-T,x=a._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-T),u.lookahead-=u.prev_length-1,u.prev_length-=2;++u.strstart<=w&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+T-1])&u.hash_mask,D=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),--u.prev_length!=0;);if(u.match_available=0,u.match_length=T-1,u.strstart++,x&&(M(u,!1),u.strm.avail_out===0))return g}else if(u.match_available){if((x=a._tr_tally(u,0,u.window[u.strstart-1]))&&M(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return g}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(x=a._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<T-1?u.strstart:T-1,z===y?(M(u,!0),u.strm.avail_out===0?X:U):u.last_lit&&(M(u,!1),u.strm.avail_out===0)?g:P}function le(u,z,D,x,w){this.good_length=u,this.max_lazy=z,this.nice_length=D,this.max_chain=x,this.func=w}function ke(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*N),this.dyn_dtree=new s.Buf16(2*(2*C+1)),this.bl_tree=new s.Buf16(2*(2*L+1)),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(O+1),this.heap=new s.Buf16(2*S+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*S+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(u){var z;return u&&u.state?(u.total_in=u.total_out=0,u.data_type=b,(z=u.state).pending=0,z.pending_out=0,z.wrap<0&&(z.wrap=-z.wrap),z.status=z.wrap?_:A,u.adler=z.wrap===2?0:1,z.last_flush=h,a._tr_init(z),p):ne(u,v)}function Pe(u){var z=me(u);return z===p&&function(D){D.window_size=2*D.w_size,ee(D.head),D.max_lazy_match=i[D.level].max_lazy,D.good_match=i[D.level].good_length,D.nice_match=i[D.level].nice_length,D.max_chain_length=i[D.level].max_chain,D.strstart=0,D.block_start=0,D.lookahead=0,D.insert=0,D.match_length=D.prev_length=T-1,D.match_available=0,D.ins_h=0}(u.state),z}function Me(u,z,D,x,w,B){if(!u)return v;var H=1;if(z===d&&(z=6),x<0?(H=0,x=-x):15<x&&(H=2,x-=16),w<1||E<w||D!==k||x<8||15<x||z<0||9<z||B<0||m<B)return ne(u,v);x===8&&(x=9);var $=new ke;return(u.state=$).strm=u,$.wrap=H,$.gzhead=null,$.w_bits=x,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=w+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+T-1)/T),$.window=new s.Buf8(2*$.w_size),$.head=new s.Buf16($.hash_size),$.prev=new s.Buf16($.w_size),$.lit_bufsize=1<<w+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new s.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=z,$.strategy=B,$.method=D,Pe(u)}i=[new le(0,0,0,0,function(u,z){var D=65535;for(D>u.pending_buf_size-5&&(D=u.pending_buf_size-5);;){if(u.lookahead<=1){if(ge(u),u.lookahead===0&&z===h)return g;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var x=u.block_start+D;if((u.strstart===0||u.strstart>=x)&&(u.lookahead=u.strstart-x,u.strstart=x,M(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-Z&&(M(u,!1),u.strm.avail_out===0))return g}return u.insert=0,z===y?(M(u,!0),u.strm.avail_out===0?X:U):(u.strstart>u.block_start&&(M(u,!1),u.strm.avail_out),g)}),new le(4,4,8,4,xe),new le(4,5,16,8,xe),new le(4,6,32,32,xe),new le(4,4,16,16,oe),new le(8,16,32,32,oe),new le(8,16,128,128,oe),new le(8,32,128,256,oe),new le(32,128,258,1024,oe),new le(32,258,258,4096,oe)],o.deflateInit=function(u,z){return Me(u,z,k,15,8,0)},o.deflateInit2=Me,o.deflateReset=Pe,o.deflateResetKeep=me,o.deflateSetHeader=function(u,z){return u&&u.state?u.state.wrap!==2?v:(u.state.gzhead=z,p):v},o.deflate=function(u,z){var D,x,w,B;if(!u||!u.state||5<z||z<0)return u?ne(u,v):v;if(x=u.state,!u.output||!u.input&&u.avail_in!==0||x.status===666&&z!==y)return ne(u,u.avail_out===0?-5:v);if(x.strm=u,D=x.last_flush,x.last_flush=z,x.status===_)if(x.wrap===2)u.adler=0,Q(x,31),Q(x,139),Q(x,8),x.gzhead?(Q(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),Q(x,255&x.gzhead.time),Q(x,x.gzhead.time>>8&255),Q(x,x.gzhead.time>>16&255),Q(x,x.gzhead.time>>24&255),Q(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),Q(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(Q(x,255&x.gzhead.extra.length),Q(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(u.adler=c(u.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(Q(x,0),Q(x,0),Q(x,0),Q(x,0),Q(x,0),Q(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),Q(x,3),x.status=A);else{var H=k+(x.w_bits-8<<4)<<8;H|=(2<=x.strategy||x.level<2?0:x.level<6?1:x.level===6?2:3)<<6,x.strstart!==0&&(H|=32),H+=31-H%31,x.status=A,V(x,H),x.strstart!==0&&(V(x,u.adler>>>16),V(x,65535&u.adler)),u.adler=1}if(x.status===69)if(x.gzhead.extra){for(w=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),R(u),w=x.pending,x.pending!==x.pending_buf_size));)Q(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(x.status===73)if(x.gzhead.name){w=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),R(u),w=x.pending,x.pending===x.pending_buf_size)){B=1;break}B=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,Q(x,B)}while(B!==0);x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),B===0&&(x.gzindex=0,x.status=91)}else x.status=91;if(x.status===91)if(x.gzhead.comment){w=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),R(u),w=x.pending,x.pending===x.pending_buf_size)){B=1;break}B=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,Q(x,B)}while(B!==0);x.gzhead.hcrc&&x.pending>w&&(u.adler=c(u.adler,x.pending_buf,x.pending-w,w)),B===0&&(x.status=103)}else x.status=103;if(x.status===103&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&R(u),x.pending+2<=x.pending_buf_size&&(Q(x,255&u.adler),Q(x,u.adler>>8&255),u.adler=0,x.status=A)):x.status=A),x.pending!==0){if(R(u),u.avail_out===0)return x.last_flush=-1,p}else if(u.avail_in===0&&W(z)<=W(D)&&z!==y)return ne(u,-5);if(x.status===666&&u.avail_in!==0)return ne(u,-5);if(u.avail_in!==0||x.lookahead!==0||z!==h&&x.status!==666){var $=x.strategy===2?function(I,q){for(var G;;){if(I.lookahead===0&&(ge(I),I.lookahead===0)){if(q===h)return g;break}if(I.match_length=0,G=a._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,G&&(M(I,!1),I.strm.avail_out===0))return g}return I.insert=0,q===y?(M(I,!0),I.strm.avail_out===0?X:U):I.last_lit&&(M(I,!1),I.strm.avail_out===0)?g:P}(x,z):x.strategy===3?function(I,q){for(var G,K,J,de,ie=I.window;;){if(I.lookahead<=j){if(ge(I),I.lookahead<=j&&q===h)return g;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=T&&0<I.strstart&&(K=ie[J=I.strstart-1])===ie[++J]&&K===ie[++J]&&K===ie[++J]){de=I.strstart+j;do;while(K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&K===ie[++J]&&J<de);I.match_length=j-(de-J),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=T?(G=a._tr_tally(I,1,I.match_length-T),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(G=a._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),G&&(M(I,!1),I.strm.avail_out===0))return g}return I.insert=0,q===y?(M(I,!0),I.strm.avail_out===0?X:U):I.last_lit&&(M(I,!1),I.strm.avail_out===0)?g:P}(x,z):i[x.level].func(x,z);if($!==X&&$!==U||(x.status=666),$===g||$===X)return u.avail_out===0&&(x.last_flush=-1),p;if($===P&&(z===1?a._tr_align(x):z!==5&&(a._tr_stored_block(x,0,0,!1),z===3&&(ee(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),R(u),u.avail_out===0))return x.last_flush=-1,p}return z!==y?p:x.wrap<=0?1:(x.wrap===2?(Q(x,255&u.adler),Q(x,u.adler>>8&255),Q(x,u.adler>>16&255),Q(x,u.adler>>24&255),Q(x,255&u.total_in),Q(x,u.total_in>>8&255),Q(x,u.total_in>>16&255),Q(x,u.total_in>>24&255)):(V(x,u.adler>>>16),V(x,65535&u.adler)),R(u),0<x.wrap&&(x.wrap=-x.wrap),x.pending!==0?p:1)},o.deflateEnd=function(u){var z;return u&&u.state?(z=u.state.status)!==_&&z!==69&&z!==73&&z!==91&&z!==103&&z!==A&&z!==666?ne(u,v):(u.state=null,z===A?ne(u,-3):p):v},o.deflateSetDictionary=function(u,z){var D,x,w,B,H,$,I,q,G=z.length;if(!u||!u.state||(B=(D=u.state).wrap)===2||B===1&&D.status!==_||D.lookahead)return v;for(B===1&&(u.adler=l(u.adler,z,G,0)),D.wrap=0,G>=D.w_size&&(B===0&&(ee(D.head),D.strstart=0,D.block_start=0,D.insert=0),q=new s.Buf8(D.w_size),s.arraySet(q,z,G-D.w_size,D.w_size,0),z=q,G=D.w_size),H=u.avail_in,$=u.next_in,I=u.input,u.avail_in=G,u.next_in=0,u.input=z,ge(D);D.lookahead>=T;){for(x=D.strstart,w=D.lookahead-(T-1);D.ins_h=(D.ins_h<<D.hash_shift^D.window[x+T-1])&D.hash_mask,D.prev[x&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=x,x++,--w;);D.strstart=x,D.lookahead=T-1,ge(D)}return D.strstart+=D.lookahead,D.block_start=D.strstart,D.insert=D.lookahead,D.lookahead=0,D.match_length=D.prev_length=T-1,D.match_available=0,u.next_in=$,u.input=I,u.avail_in=H,D.wrap=B,p},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,o){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,o){n.exports=function(i,s){var a,l,c,f,h,y,p,v,d,m,b,k,E,S,C,L,N,O,T,j,Z,_,A,g,P;a=i.state,l=i.next_in,g=i.input,c=l+(i.avail_in-5),f=i.next_out,P=i.output,h=f-(s-i.avail_out),y=f+(i.avail_out-257),p=a.dmax,v=a.wsize,d=a.whave,m=a.wnext,b=a.window,k=a.hold,E=a.bits,S=a.lencode,C=a.distcode,L=(1<<a.lenbits)-1,N=(1<<a.distbits)-1;e:do{E<15&&(k+=g[l++]<<E,E+=8,k+=g[l++]<<E,E+=8),O=S[k&L];t:for(;;){if(k>>>=T=O>>>24,E-=T,(T=O>>>16&255)===0)P[f++]=65535&O;else{if(!(16&T)){if((64&T)==0){O=S[(65535&O)+(k&(1<<T)-1)];continue t}if(32&T){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}j=65535&O,(T&=15)&&(E<T&&(k+=g[l++]<<E,E+=8),j+=k&(1<<T)-1,k>>>=T,E-=T),E<15&&(k+=g[l++]<<E,E+=8,k+=g[l++]<<E,E+=8),O=C[k&N];n:for(;;){if(k>>>=T=O>>>24,E-=T,!(16&(T=O>>>16&255))){if((64&T)==0){O=C[(65535&O)+(k&(1<<T)-1)];continue n}i.msg="invalid distance code",a.mode=30;break e}if(Z=65535&O,E<(T&=15)&&(k+=g[l++]<<E,(E+=8)<T&&(k+=g[l++]<<E,E+=8)),p<(Z+=k&(1<<T)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(k>>>=T,E-=T,(T=f-h)<Z){if(d<(T=Z-T)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(A=b,(_=0)===m){if(_+=v-T,T<j){for(j-=T;P[f++]=b[_++],--T;);_=f-Z,A=P}}else if(m<T){if(_+=v+m-T,(T-=m)<j){for(j-=T;P[f++]=b[_++],--T;);if(_=0,m<j){for(j-=T=m;P[f++]=b[_++],--T;);_=f-Z,A=P}}}else if(_+=m-T,T<j){for(j-=T;P[f++]=b[_++],--T;);_=f-Z,A=P}for(;2<j;)P[f++]=A[_++],P[f++]=A[_++],P[f++]=A[_++],j-=3;j&&(P[f++]=A[_++],1<j&&(P[f++]=A[_++]))}else{for(_=f-Z;P[f++]=P[_++],P[f++]=P[_++],P[f++]=P[_++],2<(j-=3););j&&(P[f++]=P[_++],1<j&&(P[f++]=P[_++]))}break}}break}}while(l<c&&f<y);l-=j=E>>3,k&=(1<<(E-=j<<3))-1,i.next_in=l,i.next_out=f,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=f<y?y-f+257:257-(f-y),a.hold=k,a.bits=E}},{}],49:[function(t,n,o){var i=t("../utils/common"),s=t("./adler32"),a=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),f=1,h=2,y=0,p=-2,v=1,d=852,m=592;function b(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(_){var A;return _&&_.state?(A=_.state,_.total_in=_.total_out=A.total=0,_.msg="",A.wrap&&(_.adler=1&A.wrap),A.mode=v,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new i.Buf32(d),A.distcode=A.distdyn=new i.Buf32(m),A.sane=1,A.back=-1,y):p}function S(_){var A;return _&&_.state?((A=_.state).wsize=0,A.whave=0,A.wnext=0,E(_)):p}function C(_,A){var g,P;return _&&_.state?(P=_.state,A<0?(g=0,A=-A):(g=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?p:(P.window!==null&&P.wbits!==A&&(P.window=null),P.wrap=g,P.wbits=A,S(_))):p}function L(_,A){var g,P;return _?(P=new k,(_.state=P).window=null,(g=C(_,A))!==y&&(_.state=null),g):p}var N,O,T=!0;function j(_){if(T){var A;for(N=new i.Buf32(512),O=new i.Buf32(32),A=0;A<144;)_.lens[A++]=8;for(;A<256;)_.lens[A++]=9;for(;A<280;)_.lens[A++]=7;for(;A<288;)_.lens[A++]=8;for(c(f,_.lens,0,288,N,0,_.work,{bits:9}),A=0;A<32;)_.lens[A++]=5;c(h,_.lens,0,32,O,0,_.work,{bits:5}),T=!1}_.lencode=N,_.lenbits=9,_.distcode=O,_.distbits=5}function Z(_,A,g,P){var X,U=_.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new i.Buf8(U.wsize)),P>=U.wsize?(i.arraySet(U.window,A,g-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(P<(X=U.wsize-U.wnext)&&(X=P),i.arraySet(U.window,A,g-P,X,U.wnext),(P-=X)?(i.arraySet(U.window,A,g-P,P,0),U.wnext=P,U.whave=U.wsize):(U.wnext+=X,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=X))),0}o.inflateReset=S,o.inflateReset2=C,o.inflateResetKeep=E,o.inflateInit=function(_){return L(_,15)},o.inflateInit2=L,o.inflate=function(_,A){var g,P,X,U,ne,W,ee,R,M,Q,V,Y,ge,xe,oe,le,ke,me,Pe,Me,u,z,D,x,w=0,B=new i.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return p;(g=_.state).mode===12&&(g.mode=13),ne=_.next_out,X=_.output,ee=_.avail_out,U=_.next_in,P=_.input,W=_.avail_in,R=g.hold,M=g.bits,Q=W,V=ee,z=y;e:for(;;)switch(g.mode){case v:if(g.wrap===0){g.mode=13;break}for(;M<16;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(2&g.wrap&&R===35615){B[g.check=0]=255&R,B[1]=R>>>8&255,g.check=a(g.check,B,2,0),M=R=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&R)<<8)+(R>>8))%31){_.msg="incorrect header check",g.mode=30;break}if((15&R)!=8){_.msg="unknown compression method",g.mode=30;break}if(M-=4,u=8+(15&(R>>>=4)),g.wbits===0)g.wbits=u;else if(u>g.wbits){_.msg="invalid window size",g.mode=30;break}g.dmax=1<<u,_.adler=g.check=1,g.mode=512&R?10:12,M=R=0;break;case 2:for(;M<16;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(g.flags=R,(255&g.flags)!=8){_.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){_.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=R>>8&1),512&g.flags&&(B[0]=255&R,B[1]=R>>>8&255,g.check=a(g.check,B,2,0)),M=R=0,g.mode=3;case 3:for(;M<32;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.head&&(g.head.time=R),512&g.flags&&(B[0]=255&R,B[1]=R>>>8&255,B[2]=R>>>16&255,B[3]=R>>>24&255,g.check=a(g.check,B,4,0)),M=R=0,g.mode=4;case 4:for(;M<16;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.head&&(g.head.xflags=255&R,g.head.os=R>>8),512&g.flags&&(B[0]=255&R,B[1]=R>>>8&255,g.check=a(g.check,B,2,0)),M=R=0,g.mode=5;case 5:if(1024&g.flags){for(;M<16;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.length=R,g.head&&(g.head.extra_len=R),512&g.flags&&(B[0]=255&R,B[1]=R>>>8&255,g.check=a(g.check,B,2,0)),M=R=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(W<(Y=g.length)&&(Y=W),Y&&(g.head&&(u=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),i.arraySet(g.head.extra,P,U,Y,u)),512&g.flags&&(g.check=a(g.check,P,Y,U)),W-=Y,U+=Y,g.length-=Y),g.length))break e;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(W===0)break e;for(Y=0;u=P[U+Y++],g.head&&u&&g.length<65536&&(g.head.name+=String.fromCharCode(u)),u&&Y<W;);if(512&g.flags&&(g.check=a(g.check,P,Y,U)),W-=Y,U+=Y,u)break e}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(W===0)break e;for(Y=0;u=P[U+Y++],g.head&&u&&g.length<65536&&(g.head.comment+=String.fromCharCode(u)),u&&Y<W;);if(512&g.flags&&(g.check=a(g.check,P,Y,U)),W-=Y,U+=Y,u)break e}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;M<16;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(R!==(65535&g.check)){_.msg="header crc mismatch",g.mode=30;break}M=R=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),_.adler=g.check=0,g.mode=12;break;case 10:for(;M<32;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}_.adler=g.check=b(R),M=R=0,g.mode=11;case 11:if(g.havedict===0)return _.next_out=ne,_.avail_out=ee,_.next_in=U,_.avail_in=W,g.hold=R,g.bits=M,2;_.adler=g.check=1,g.mode=12;case 12:if(A===5||A===6)break e;case 13:if(g.last){R>>>=7&M,M-=7&M,g.mode=27;break}for(;M<3;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}switch(g.last=1&R,M-=1,3&(R>>>=1)){case 0:g.mode=14;break;case 1:if(j(g),g.mode=20,A!==6)break;R>>>=2,M-=2;break e;case 2:g.mode=17;break;case 3:_.msg="invalid block type",g.mode=30}R>>>=2,M-=2;break;case 14:for(R>>>=7&M,M-=7&M;M<32;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if((65535&R)!=(R>>>16^65535)){_.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&R,M=R=0,g.mode=15,A===6)break e;case 15:g.mode=16;case 16:if(Y=g.length){if(W<Y&&(Y=W),ee<Y&&(Y=ee),Y===0)break e;i.arraySet(X,P,U,Y,ne),W-=Y,U+=Y,ee-=Y,ne+=Y,g.length-=Y;break}g.mode=12;break;case 17:for(;M<14;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(g.nlen=257+(31&R),R>>>=5,M-=5,g.ndist=1+(31&R),R>>>=5,M-=5,g.ncode=4+(15&R),R>>>=4,M-=4,286<g.nlen||30<g.ndist){_.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;M<3;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.lens[H[g.have++]]=7&R,R>>>=3,M-=3}for(;g.have<19;)g.lens[H[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,D={bits:g.lenbits},z=c(0,g.lens,0,19,g.lencode,0,g.work,D),g.lenbits=D.bits,z){_.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;le=(w=g.lencode[R&(1<<g.lenbits)-1])>>>16&255,ke=65535&w,!((oe=w>>>24)<=M);){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(ke<16)R>>>=oe,M-=oe,g.lens[g.have++]=ke;else{if(ke===16){for(x=oe+2;M<x;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(R>>>=oe,M-=oe,g.have===0){_.msg="invalid bit length repeat",g.mode=30;break}u=g.lens[g.have-1],Y=3+(3&R),R>>>=2,M-=2}else if(ke===17){for(x=oe+3;M<x;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}M-=oe,u=0,Y=3+(7&(R>>>=oe)),R>>>=3,M-=3}else{for(x=oe+7;M<x;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}M-=oe,u=0,Y=11+(127&(R>>>=oe)),R>>>=7,M-=7}if(g.have+Y>g.nlen+g.ndist){_.msg="invalid bit length repeat",g.mode=30;break}for(;Y--;)g.lens[g.have++]=u}}if(g.mode===30)break;if(g.lens[256]===0){_.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,D={bits:g.lenbits},z=c(f,g.lens,0,g.nlen,g.lencode,0,g.work,D),g.lenbits=D.bits,z){_.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,D={bits:g.distbits},z=c(h,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,D),g.distbits=D.bits,z){_.msg="invalid distances set",g.mode=30;break}if(g.mode=20,A===6)break e;case 20:g.mode=21;case 21:if(6<=W&&258<=ee){_.next_out=ne,_.avail_out=ee,_.next_in=U,_.avail_in=W,g.hold=R,g.bits=M,l(_,V),ne=_.next_out,X=_.output,ee=_.avail_out,U=_.next_in,P=_.input,W=_.avail_in,R=g.hold,M=g.bits,g.mode===12&&(g.back=-1);break}for(g.back=0;le=(w=g.lencode[R&(1<<g.lenbits)-1])>>>16&255,ke=65535&w,!((oe=w>>>24)<=M);){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(le&&(240&le)==0){for(me=oe,Pe=le,Me=ke;le=(w=g.lencode[Me+((R&(1<<me+Pe)-1)>>me)])>>>16&255,ke=65535&w,!(me+(oe=w>>>24)<=M);){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}R>>>=me,M-=me,g.back+=me}if(R>>>=oe,M-=oe,g.back+=oe,g.length=ke,le===0){g.mode=26;break}if(32&le){g.back=-1,g.mode=12;break}if(64&le){_.msg="invalid literal/length code",g.mode=30;break}g.extra=15&le,g.mode=22;case 22:if(g.extra){for(x=g.extra;M<x;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.length+=R&(1<<g.extra)-1,R>>>=g.extra,M-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;le=(w=g.distcode[R&(1<<g.distbits)-1])>>>16&255,ke=65535&w,!((oe=w>>>24)<=M);){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if((240&le)==0){for(me=oe,Pe=le,Me=ke;le=(w=g.distcode[Me+((R&(1<<me+Pe)-1)>>me)])>>>16&255,ke=65535&w,!(me+(oe=w>>>24)<=M);){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}R>>>=me,M-=me,g.back+=me}if(R>>>=oe,M-=oe,g.back+=oe,64&le){_.msg="invalid distance code",g.mode=30;break}g.offset=ke,g.extra=15&le,g.mode=24;case 24:if(g.extra){for(x=g.extra;M<x;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}g.offset+=R&(1<<g.extra)-1,R>>>=g.extra,M-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){_.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(ee===0)break e;if(Y=V-ee,g.offset>Y){if((Y=g.offset-Y)>g.whave&&g.sane){_.msg="invalid distance too far back",g.mode=30;break}ge=Y>g.wnext?(Y-=g.wnext,g.wsize-Y):g.wnext-Y,Y>g.length&&(Y=g.length),xe=g.window}else xe=X,ge=ne-g.offset,Y=g.length;for(ee<Y&&(Y=ee),ee-=Y,g.length-=Y;X[ne++]=xe[ge++],--Y;);g.length===0&&(g.mode=21);break;case 26:if(ee===0)break e;X[ne++]=g.length,ee--,g.mode=21;break;case 27:if(g.wrap){for(;M<32;){if(W===0)break e;W--,R|=P[U++]<<M,M+=8}if(V-=ee,_.total_out+=V,g.total+=V,V&&(_.adler=g.check=g.flags?a(g.check,X,V,ne-V):s(g.check,X,V,ne-V)),V=ee,(g.flags?R:b(R))!==g.check){_.msg="incorrect data check",g.mode=30;break}M=R=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;M<32;){if(W===0)break e;W--,R+=P[U++]<<M,M+=8}if(R!==(4294967295&g.total)){_.msg="incorrect length check",g.mode=30;break}M=R=0}g.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;case 32:default:return p}return _.next_out=ne,_.avail_out=ee,_.next_in=U,_.avail_in=W,g.hold=R,g.bits=M,(g.wsize||V!==_.avail_out&&g.mode<30&&(g.mode<27||A!==4))&&Z(_,_.output,_.next_out,V-_.avail_out)?(g.mode=31,-4):(Q-=_.avail_in,V-=_.avail_out,_.total_in+=Q,_.total_out+=V,g.total+=V,g.wrap&&V&&(_.adler=g.check=g.flags?a(g.check,X,V,_.next_out-V):s(g.check,X,V,_.next_out-V)),_.data_type=g.bits+(g.last?64:0)+(g.mode===12?128:0)+(g.mode===20||g.mode===15?256:0),(Q==0&&V===0||A===4)&&z===y&&(z=-5),z)},o.inflateEnd=function(_){if(!_||!_.state)return p;var A=_.state;return A.window&&(A.window=null),_.state=null,y},o.inflateGetHeader=function(_,A){var g;return _&&_.state?(2&(g=_.state).wrap)==0?p:((g.head=A).done=!1,y):p},o.inflateSetDictionary=function(_,A){var g,P=A.length;return _&&_.state?(g=_.state).wrap!==0&&g.mode!==11?p:g.mode===11&&s(1,A,P,0)!==g.check?-3:Z(_,A,P,P)?(g.mode=31,-4):(g.havedict=1,y):p},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,o){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(f,h,y,p,v,d,m,b){var k,E,S,C,L,N,O,T,j,Z=b.bits,_=0,A=0,g=0,P=0,X=0,U=0,ne=0,W=0,ee=0,R=0,M=null,Q=0,V=new i.Buf16(16),Y=new i.Buf16(16),ge=null,xe=0;for(_=0;_<=15;_++)V[_]=0;for(A=0;A<p;A++)V[h[y+A]]++;for(X=Z,P=15;1<=P&&V[P]===0;P--);if(P<X&&(X=P),P===0)return v[d++]=20971520,v[d++]=20971520,b.bits=1,0;for(g=1;g<P&&V[g]===0;g++);for(X<g&&(X=g),_=W=1;_<=15;_++)if(W<<=1,(W-=V[_])<0)return-1;if(0<W&&(f===0||P!==1))return-1;for(Y[1]=0,_=1;_<15;_++)Y[_+1]=Y[_]+V[_];for(A=0;A<p;A++)h[y+A]!==0&&(m[Y[h[y+A]]++]=A);if(N=f===0?(M=ge=m,19):f===1?(M=s,Q-=257,ge=a,xe-=257,256):(M=l,ge=c,-1),_=g,L=d,ne=A=R=0,S=-1,C=(ee=1<<(U=X))-1,f===1&&852<ee||f===2&&592<ee)return 1;for(;;){for(O=_-ne,j=m[A]<N?(T=0,m[A]):m[A]>N?(T=ge[xe+m[A]],M[Q+m[A]]):(T=96,0),k=1<<_-ne,g=E=1<<U;v[L+(R>>ne)+(E-=k)]=O<<24|T<<16|j|0,E!==0;);for(k=1<<_-1;R&k;)k>>=1;if(k!==0?(R&=k-1,R+=k):R=0,A++,--V[_]==0){if(_===P)break;_=h[y+m[A]]}if(X<_&&(R&C)!==S){for(ne===0&&(ne=X),L+=g,W=1<<(U=_-ne);U+ne<P&&!((W-=V[U+ne])<=0);)U++,W<<=1;if(ee+=1<<U,f===1&&852<ee||f===2&&592<ee)return 1;v[S=R&C]=X<<24|U<<16|L-d|0}}return R!==0&&(v[L+R]=_-ne<<24|64<<16|0),b.bits=X,0}},{"../utils/common":41}],51:[function(t,n,o){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,o){var i=t("../utils/common"),s=0,a=1;function l(w){for(var B=w.length;0<=--B;)w[B]=0}var c=0,f=29,h=256,y=h+1+f,p=30,v=19,d=2*y+1,m=15,b=16,k=7,E=256,S=16,C=17,L=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=new Array(2*(y+2));l(Z);var _=new Array(2*p);l(_);var A=new Array(512);l(A);var g=new Array(256);l(g);var P=new Array(f);l(P);var X,U,ne,W=new Array(p);function ee(w,B,H,$,I){this.static_tree=w,this.extra_bits=B,this.extra_base=H,this.elems=$,this.max_length=I,this.has_stree=w&&w.length}function R(w,B){this.dyn_tree=w,this.max_code=0,this.stat_desc=B}function M(w){return w<256?A[w]:A[256+(w>>>7)]}function Q(w,B){w.pending_buf[w.pending++]=255&B,w.pending_buf[w.pending++]=B>>>8&255}function V(w,B,H){w.bi_valid>b-H?(w.bi_buf|=B<<w.bi_valid&65535,Q(w,w.bi_buf),w.bi_buf=B>>b-w.bi_valid,w.bi_valid+=H-b):(w.bi_buf|=B<<w.bi_valid&65535,w.bi_valid+=H)}function Y(w,B,H){V(w,H[2*B],H[2*B+1])}function ge(w,B){for(var H=0;H|=1&w,w>>>=1,H<<=1,0<--B;);return H>>>1}function xe(w,B,H){var $,I,q=new Array(m+1),G=0;for($=1;$<=m;$++)q[$]=G=G+H[$-1]<<1;for(I=0;I<=B;I++){var K=w[2*I+1];K!==0&&(w[2*I]=ge(q[K]++,K))}}function oe(w){var B;for(B=0;B<y;B++)w.dyn_ltree[2*B]=0;for(B=0;B<p;B++)w.dyn_dtree[2*B]=0;for(B=0;B<v;B++)w.bl_tree[2*B]=0;w.dyn_ltree[2*E]=1,w.opt_len=w.static_len=0,w.last_lit=w.matches=0}function le(w){8<w.bi_valid?Q(w,w.bi_buf):0<w.bi_valid&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0}function ke(w,B,H,$){var I=2*B,q=2*H;return w[I]<w[q]||w[I]===w[q]&&$[B]<=$[H]}function me(w,B,H){for(var $=w.heap[H],I=H<<1;I<=w.heap_len&&(I<w.heap_len&&ke(B,w.heap[I+1],w.heap[I],w.depth)&&I++,!ke(B,$,w.heap[I],w.depth));)w.heap[H]=w.heap[I],H=I,I<<=1;w.heap[H]=$}function Pe(w,B,H){var $,I,q,G,K=0;if(w.last_lit!==0)for(;$=w.pending_buf[w.d_buf+2*K]<<8|w.pending_buf[w.d_buf+2*K+1],I=w.pending_buf[w.l_buf+K],K++,$===0?Y(w,I,B):(Y(w,(q=g[I])+h+1,B),(G=N[q])!==0&&V(w,I-=P[q],G),Y(w,q=M(--$),H),(G=O[q])!==0&&V(w,$-=W[q],G)),K<w.last_lit;);Y(w,E,B)}function Me(w,B){var H,$,I,q=B.dyn_tree,G=B.stat_desc.static_tree,K=B.stat_desc.has_stree,J=B.stat_desc.elems,de=-1;for(w.heap_len=0,w.heap_max=d,H=0;H<J;H++)q[2*H]!==0?(w.heap[++w.heap_len]=de=H,w.depth[H]=0):q[2*H+1]=0;for(;w.heap_len<2;)q[2*(I=w.heap[++w.heap_len]=de<2?++de:0)]=1,w.depth[I]=0,w.opt_len--,K&&(w.static_len-=G[2*I+1]);for(B.max_code=de,H=w.heap_len>>1;1<=H;H--)me(w,q,H);for(I=J;H=w.heap[1],w.heap[1]=w.heap[w.heap_len--],me(w,q,1),$=w.heap[1],w.heap[--w.heap_max]=H,w.heap[--w.heap_max]=$,q[2*I]=q[2*H]+q[2*$],w.depth[I]=(w.depth[H]>=w.depth[$]?w.depth[H]:w.depth[$])+1,q[2*H+1]=q[2*$+1]=I,w.heap[1]=I++,me(w,q,1),2<=w.heap_len;);w.heap[--w.heap_max]=w.heap[1],function(ie,Oe){var kt,Ne,wt,be,Rt,In,He=Oe.dyn_tree,Ho=Oe.max_code,ra=Oe.stat_desc.static_tree,oa=Oe.stat_desc.has_stree,ia=Oe.stat_desc.extra_bits,$o=Oe.stat_desc.extra_base,xt=Oe.stat_desc.max_length,Dt=0;for(be=0;be<=m;be++)ie.bl_count[be]=0;for(He[2*ie.heap[ie.heap_max]+1]=0,kt=ie.heap_max+1;kt<d;kt++)xt<(be=He[2*He[2*(Ne=ie.heap[kt])+1]+1]+1)&&(be=xt,Dt++),He[2*Ne+1]=be,Ho<Ne||(ie.bl_count[be]++,Rt=0,$o<=Ne&&(Rt=ia[Ne-$o]),In=He[2*Ne],ie.opt_len+=In*(be+Rt),oa&&(ie.static_len+=In*(ra[2*Ne+1]+Rt)));if(Dt!==0){do{for(be=xt-1;ie.bl_count[be]===0;)be--;ie.bl_count[be]--,ie.bl_count[be+1]+=2,ie.bl_count[xt]--,Dt-=2}while(0<Dt);for(be=xt;be!==0;be--)for(Ne=ie.bl_count[be];Ne!==0;)Ho<(wt=ie.heap[--kt])||(He[2*wt+1]!==be&&(ie.opt_len+=(be-He[2*wt+1])*He[2*wt],He[2*wt+1]=be),Ne--)}}(w,B),xe(q,de,w.bl_count)}function u(w,B,H){var $,I,q=-1,G=B[1],K=0,J=7,de=4;for(G===0&&(J=138,de=3),B[2*(H+1)+1]=65535,$=0;$<=H;$++)I=G,G=B[2*($+1)+1],++K<J&&I===G||(K<de?w.bl_tree[2*I]+=K:I!==0?(I!==q&&w.bl_tree[2*I]++,w.bl_tree[2*S]++):K<=10?w.bl_tree[2*C]++:w.bl_tree[2*L]++,q=I,de=(K=0)===G?(J=138,3):I===G?(J=6,3):(J=7,4))}function z(w,B,H){var $,I,q=-1,G=B[1],K=0,J=7,de=4;for(G===0&&(J=138,de=3),$=0;$<=H;$++)if(I=G,G=B[2*($+1)+1],!(++K<J&&I===G)){if(K<de)for(;Y(w,I,w.bl_tree),--K!=0;);else I!==0?(I!==q&&(Y(w,I,w.bl_tree),K--),Y(w,S,w.bl_tree),V(w,K-3,2)):K<=10?(Y(w,C,w.bl_tree),V(w,K-3,3)):(Y(w,L,w.bl_tree),V(w,K-11,7));q=I,de=(K=0)===G?(J=138,3):I===G?(J=6,3):(J=7,4)}}l(W);var D=!1;function x(w,B,H,$){V(w,(c<<1)+($?1:0),3),function(I,q,G,K){le(I),Q(I,G),Q(I,~G),i.arraySet(I.pending_buf,I.window,q,G,I.pending),I.pending+=G}(w,B,H)}o._tr_init=function(w){D||(function(){var B,H,$,I,q,G=new Array(m+1);for(I=$=0;I<f-1;I++)for(P[I]=$,B=0;B<1<<N[I];B++)g[$++]=I;for(g[$-1]=I,I=q=0;I<16;I++)for(W[I]=q,B=0;B<1<<O[I];B++)A[q++]=I;for(q>>=7;I<p;I++)for(W[I]=q<<7,B=0;B<1<<O[I]-7;B++)A[256+q++]=I;for(H=0;H<=m;H++)G[H]=0;for(B=0;B<=143;)Z[2*B+1]=8,B++,G[8]++;for(;B<=255;)Z[2*B+1]=9,B++,G[9]++;for(;B<=279;)Z[2*B+1]=7,B++,G[7]++;for(;B<=287;)Z[2*B+1]=8,B++,G[8]++;for(xe(Z,y+1,G),B=0;B<p;B++)_[2*B+1]=5,_[2*B]=ge(B,5);X=new ee(Z,N,h+1,y,m),U=new ee(_,O,0,p,m),ne=new ee(new Array(0),T,0,v,k)}(),D=!0),w.l_desc=new R(w.dyn_ltree,X),w.d_desc=new R(w.dyn_dtree,U),w.bl_desc=new R(w.bl_tree,ne),w.bi_buf=0,w.bi_valid=0,oe(w)},o._tr_stored_block=x,o._tr_flush_block=function(w,B,H,$){var I,q,G=0;0<w.level?(w.strm.data_type===2&&(w.strm.data_type=function(K){var J,de=4093624447;for(J=0;J<=31;J++,de>>>=1)if(1&de&&K.dyn_ltree[2*J]!==0)return s;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return a;for(J=32;J<h;J++)if(K.dyn_ltree[2*J]!==0)return a;return s}(w)),Me(w,w.l_desc),Me(w,w.d_desc),G=function(K){var J;for(u(K,K.dyn_ltree,K.l_desc.max_code),u(K,K.dyn_dtree,K.d_desc.max_code),Me(K,K.bl_desc),J=v-1;3<=J&&K.bl_tree[2*j[J]+1]===0;J--);return K.opt_len+=3*(J+1)+5+5+4,J}(w),I=w.opt_len+3+7>>>3,(q=w.static_len+3+7>>>3)<=I&&(I=q)):I=q=H+5,H+4<=I&&B!==-1?x(w,B,H,$):w.strategy===4||q===I?(V(w,2+($?1:0),3),Pe(w,Z,_)):(V(w,4+($?1:0),3),function(K,J,de,ie){var Oe;for(V(K,J-257,5),V(K,de-1,5),V(K,ie-4,4),Oe=0;Oe<ie;Oe++)V(K,K.bl_tree[2*j[Oe]+1],3);z(K,K.dyn_ltree,J-1),z(K,K.dyn_dtree,de-1)}(w,w.l_desc.max_code+1,w.d_desc.max_code+1,G+1),Pe(w,w.dyn_ltree,w.dyn_dtree)),oe(w),$&&le(w)},o._tr_tally=function(w,B,H){return w.pending_buf[w.d_buf+2*w.last_lit]=B>>>8&255,w.pending_buf[w.d_buf+2*w.last_lit+1]=255&B,w.pending_buf[w.l_buf+w.last_lit]=255&H,w.last_lit++,B===0?w.dyn_ltree[2*H]++:(w.matches++,B--,w.dyn_ltree[2*(g[H]+h+1)]++,w.dyn_dtree[2*M(B)]++),w.last_lit===w.lit_bufsize-1},o._tr_align=function(w){V(w,2,3),Y(w,E,Z),function(B){B.bi_valid===16?(Q(B,B.bi_buf),B.bi_buf=0,B.bi_valid=0):8<=B.bi_valid&&(B.pending_buf[B.pending++]=255&B.bi_buf,B.bi_buf>>=8,B.bi_valid-=8)}(w)}},{"../utils/common":41}],53:[function(t,n,o){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,o){(function(i){(function(s,a){if(!s.setImmediate){var l,c,f,h,y=1,p={},v=!1,d=s.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(s);m=m&&m.setTimeout?m:s,l={}.toString.call(s.process)==="[object process]"?function(S){process.nextTick(function(){k(S)})}:function(){if(s.postMessage&&!s.importScripts){var S=!0,C=s.onmessage;return s.onmessage=function(){S=!1},s.postMessage("","*"),s.onmessage=C,S}}()?(h="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",E,!1):s.attachEvent("onmessage",E),function(S){s.postMessage(h+S,"*")}):s.MessageChannel?((f=new MessageChannel).port1.onmessage=function(S){k(S.data)},function(S){f.port2.postMessage(S)}):d&&"onreadystatechange"in d.createElement("script")?(c=d.documentElement,function(S){var C=d.createElement("script");C.onreadystatechange=function(){k(S),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(S){setTimeout(k,0,S)},m.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var C=new Array(arguments.length-1),L=0;L<C.length;L++)C[L]=arguments[L+1];var N={callback:S,args:C};return p[y]=N,l(y),y++},m.clearImmediate=b}function b(S){delete p[S]}function k(S){if(v)setTimeout(k,0,S);else{var C=p[S];if(C){v=!0;try{(function(L){var N=L.callback,O=L.args;switch(O.length){case 0:N();break;case 1:N(O[0]);break;case 2:N(O[0],O[1]);break;case 3:N(O[0],O[1],O[2]);break;default:N.apply(a,O)}})(C)}finally{b(S),v=!1}}}}function E(S){S.source===s&&typeof S.data=="string"&&S.data.indexOf(h)===0&&k(+S.data.slice(h.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof $t<"u"?$t:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Un)),Un.exports}var lp=ap();const ci=sp(lp);class cp{constructor(e){this.database=e}async importData(e){const t=await e.arrayBuffer(),n=await ci.loadAsync(t),i=await n.file("cards.json").async("string"),s=JSON.parse(i),a=n.folder("images"),l=[];a.forEach((f,h)=>{l.push([f,h])});const c={};for(const[f,h]of l){const y=await h.async("blob"),p=f,v=await this.database.images.add(y);c[p]=v}for(const f of s)[...f.question.blocks,...f.answer.blocks].forEach(h=>{if(h.type==="image"&&h.data?.file?.key){const y=h.data.file.key;h.data.file.key=c[y]}}),delete f.id,await this.database.cards.add(f)}async exportData(){const e=new ci,t=await this.database.cards.getAll();if(t.length===0)throw new Error("No cards to export");e.file("cards.json",JSON.stringify(t,null,2));const n=e.folder("images"),o=await this.database.images.getAll();for(const i of o)n.file(i.id.toString(),i);return await e.generateAsync({type:"blob"})}}class dp{routes={};currentPage=null;constructor(){window.addEventListener("hashchange",()=>this.handleLocation())}register(e,t){return this.routes[e]=t,this}async init(){window.location.hash||(window.location.hash="#/"),await this.handleLocation()}async handleLocation(){const e=window.location.hash,n=(e.startsWith("#")?e.slice(1):e)||"/";let o=this.routes[n];o||(window.location.hash="#/",o=this.routes["/"]),this.currentPage&&await this.currentPage.clear(),this.currentPage=o(),await this.currentPage.draw()}async navigate(e){const t=e.startsWith("#")?e:`#${e}`;window.location.hash=t}}async function up(){const r=se.findElementByIdOrFail("app"),e=await new ip().open(),t=new cp(e),n=new dp,o={router:n,database:e,zip:t};n.register("/",()=>new Qh(r,o)).register("/learn",()=>new tp(r,o)),await n.init()}await up();
